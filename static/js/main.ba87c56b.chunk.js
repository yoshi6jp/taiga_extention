(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{133:function(e,t,a){e.exports={gold:"UserTasks_gold__1MP40",silver:"UserTasks_silver__GpK9Y",bronze:"UserTasks_bronze__1aHZc",custom_input_td:"UserTasks_custom_input_td__1JWmj"}},136:function(e,t,a){e.exports={fresh:"Tomato_fresh__2s5Ye",stale:"Tomato_stale__3bjHh"}},140:function(e,t,a){e.exports={top:"Pomodoro_top__2KPBC",button_group:"Pomodoro_button_group__25QhE"}},201:function(e,t,a){e.exports={header:"Controller_header__33lvE"}},214:function(e,t,a){e.exports=a.p+"static/media/tomato.c392a271.png"},244:function(e,t,a){e.exports=a(463)},249:function(e,t,a){},255:function(e,t,a){},463:function(e,t,a){"use strict";a.r(t);var n,r,c=a(1),s=a.n(c),o=a(36),l=a.n(o),u=(a(249),a(250),a(251),a(252),a(253),a(254),a(255),a(56)),i=a(16),m=a(8),_=a.n(m),d=a(2),E=a.n(d);!function(e){e.SET_URL="SET_URL",e.SIGN_IN="SIGN_IN",e.SET_AUTH_TOKEN="SET_AUTH_TOKEN",e.SET_AUTH_ERROR="SET_AUTH_ERROR",e.SIGN_OUT="SIGN_OUT",e.FETCH_PROJECTS="FETCH_PROJECTS",e.SET_PROJECTS="SET_PROJECTS",e.SET_PID="SET_PID",e.FETCH_PROJECT="FETCH_PROJECT",e.SET_PROJECT="SET_PROJECT",e.FETCH_MILESTONES="FETCH_MILESTONES",e.SET_MID="SET_MID",e.SET_MILESTONES="SET_MILESTONES",e.SET_MILESTONE="SET_MILESTONE",e.SET_CUSTOM_EID="SET_CUSTOM_EID",e.SET_CUSTOM_RID="SET_CUSTOM_RID",e.FETCH_CUSTOM_ATTRS="FETCH_CUSTOM_ATTRS",e.SET_CUSTOM_ATTRS="SET_CUSTOM_ATTRS",e.SET_CUSTOM_ATTR_E="SET_CUSTOM_ATTR_E",e.SET_CUSTOM_ATTR_R="SET_CUSTOM_ATTR_R",e.SET_BIZ_DAYS="SET_BIZ_DAYS",e.ADD_BIZ_DAY="ADD_BIZ_DAY",e.REMOVE_BIZ_DAY="REMOVE_BIZ_DAY",e.FETCH_TASKS="FETCH_TASKS",e.SET_TASKS="SET_TASKS",e.SET_USER_TASKS="SET_USER_TASKS",e.PATCH_TASK="PATCH_TASK",e.FETCH_TASK_STATUSES="FETCH_TASK_STATUSES",e.SET_TASK_STATUSES="SET_TASK_STATUSES",e.SET_ACTIVE_TASK_STATUSES="SET_ACTIVE_TASK_STATUSES",e.FETCH_CUSTOM_VALUE_MAP="FETCH_CUSTOM_VALUE_MAP",e.SET_CUSTOM_VALUE_MAP="SET_CUSTOM_VALUE_MAP",e.PATCH_CUSTOM_VALUE="PATCH_CUSTOM_VALUE",e.FETCH_USER="FETCH_USER",e.SET_USER="SET_USER",e.RESET_USER="RESET_USER",e.SET_REJECT_TASK_STATUS_IDS="SET_REJECT_TASK_STATUS_IDS",e.ADD_REJECT_TASK_STATUS_ID="ADD_REJECT_TASK_STATUS_ID",e.REMOVE_REJECT_TASK_STATUS_ID="REMOVE_REJECT_TASK_STATUS_ID",e.OPEN_CONTROLLER="OPEN_CONTROLLER",e.CLOSE_CONTROLLER="CLOSE_CONTROLLER",e.UPDATE_DATA="UPDATE_DATA",e.ADD_POMODORO="ADD_POMODORO",e.USE_POMODORO="USE_POMODORO",e.RESET_POMODORO="RESET_POMODORO",e.RESTORE_POMODORO="RESTORE_POMODORO",e.LOADED="LOADED",e.ALLOW_NOTIFICATION="ALLOW_NOTIFICATION"}(n||(n={})),function(e){e.URL="taiga_url",e.PID="taiga_pid",e.MID="taiga_mid",e.CUSTOM_EID="taiga_custom_eid",e.CUSTOM_RID="taiga_custom_rid",e.BIZ_DAYS="taiga_biz_days",e.REJECT_TASK_STATUS_IDS="reject_task_status_ids",e.USERNAME="taiga_username",e.PASSWORD="taiga_password",e.POMODORO_DATE="taiga_pomodoro_date",e.POMODORO_NUMBER="taiga_pomodoro_number",e.POMODORO_USED_NUMBER="taiga_pomodoro_used_number"}(r||(r={}));var p=function(e){return localStorage.getItem(e)||""},f=function(e){return p(e)},O=function(e,t){return t?p("".concat(t,"/").concat(e)):""},S=function(e,t){localStorage.setItem(e,t)},T=function(e,t,a){return t?S("".concat(t,"/").concat(e),a):null},b={url:"",auth_token:"",auth_error:!1,username:"",password:"",user:null,projects:[],pid:"",project:{},mid:"",custom_eid:"",custom_rid:"",custom_attrs:[],custom_attr_e:{},custom_attr_r:{},biz_days:[],milestones:[],milestone:{},tasks:[],user_tasks:[],task_statuses:[],active_task_statuses:[],custom_value_map:new WeakMap,reject_task_status_ids:[],updated_time:0,isOpen:!1,pomodoro_date:"",pomodoro_number:0,pomodoro_used_number:0,loaded:!1,isNotifable:!1},v=a(52),y=a(13),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.SET_URL:var a=t.payload.url;return Object(y.a)({},e,{url:a});case n.SET_PROJECTS:var r=t.payload.projects;return Object(y.a)({},e,{projects:r});case n.SET_PID:var c=t.payload.pid;return Object(y.a)({},e,{pid:c,project:{},mid:"",biz_days:[],custom_attrs:[],milestones:[],custom_value_map:new WeakMap});case n.SET_PROJECT:var s=t.payload.project;return Object(y.a)({},e,{project:s});case n.SET_MID:var o=t.payload.mid;return Object(y.a)({},e,{mid:o,milestone:{},tasks:[]});case n.SET_MILESTONES:var l=t.payload.milestones;return Object(y.a)({},e,{milestones:l});case n.SET_MILESTONE:var u=t.payload.milestone;return Object(y.a)({},e,{milestone:u});case n.SET_CUSTOM_EID:var i=t.payload.custom_eid;return Object(y.a)({},e,{custom_eid:i});case n.SET_CUSTOM_ATTRS:var m=t.payload.custom_attrs;return Object(y.a)({},e,{custom_attrs:m});case n.SET_CUSTOM_ATTR_E:var d=t.payload.custom_attr_e;return Object(y.a)({},e,{custom_attr_e:d});case n.SET_CUSTOM_ATTR_R:var E=t.payload.custom_attr_r;return Object(y.a)({},e,{custom_attr_r:E});case n.SET_CUSTOM_RID:var p=t.payload.custom_rid;return Object(y.a)({},e,{custom_rid:p});case n.SET_BIZ_DAYS:var f=t.payload.biz_days;return Object(y.a)({},e,{biz_days:f});case n.ADD_BIZ_DAY:var O=t.payload.biz_day,S=_.a.chain([].concat(Object(v.a)(e.biz_days),[O])).uniq().sort().value();return Object(y.a)({},e,{biz_days:S});case n.REMOVE_BIZ_DAY:var T=t.payload.biz_day,h=_.a.reject(Object(v.a)(e.biz_days),function(e){return e===T});return Object(y.a)({},e,{biz_days:h});case n.SET_TASKS:var k=t.payload.tasks;return Object(y.a)({},e,{tasks:k});case n.SET_USER_TASKS:var j=t.payload.user_tasks;return Object(y.a)({},e,{user_tasks:j});case n.SET_TASK_STATUSES:var C=t.payload.task_statuses;return Object(y.a)({},e,{task_statuses:C});case n.SET_ACTIVE_TASK_STATUSES:var g=t.payload.active_task_statuses;return Object(y.a)({},e,{active_task_statuses:g});case n.SET_CUSTOM_VALUE_MAP:var A=t.payload.custom_value_map;return Object(y.a)({},e,{custom_value_map:A});case n.SET_USER:var R=t.payload.user;return Object(y.a)({},e,{user:R});case n.RESET_USER:return Object(y.a)({},e,{user:null,user_tasks:[]});case n.SET_REJECT_TASK_STATUS_IDS:var N=t.payload.reject_task_status_ids;return Object(y.a)({},e,{reject_task_status_ids:N});case n.ADD_REJECT_TASK_STATUS_ID:var D=t.payload.reject_task_status_id,U=_.a.chain([].concat(Object(v.a)(e.reject_task_status_ids),[D])).compact().uniq().value();return Object(y.a)({},e,{reject_task_status_ids:U});case n.REMOVE_REJECT_TASK_STATUS_ID:var M=t.payload.reject_task_status_id,x=_.a.reject(Object(v.a)(e.reject_task_status_ids),function(e){return e===M});return Object(y.a)({},e,{reject_task_status_ids:x});case n.OPEN_CONTROLLER:return Object(y.a)({},e,{isOpen:!0});case n.CLOSE_CONTROLLER:return Object(y.a)({},e,{isOpen:!1});case n.UPDATE_DATA:return Object(y.a)({},e,{updated_time:Date.now()});case n.SIGN_IN:var I=t.payload,P=I.username,w=I.password;return Object(y.a)({},e,{username:P,password:w,auth_error:!1});case n.SET_AUTH_TOKEN:var F=t.payload.auth_token;return Object(y.a)({},e,{auth_token:F});case n.SET_AUTH_ERROR:return Object(y.a)({},e,{auth_error:!0});case n.SIGN_OUT:return Object(y.a)({},e,{auth_token:"",username:"",password:""});case n.ADD_POMODORO:var L=e.pomodoro_number+1;return Object(y.a)({},e,{pomodoro_number:L});case n.USE_POMODORO:var H=t.payload.used_number,K=Math.max(0,e.pomodoro_used_number+H);return Object(y.a)({},e,{pomodoro_used_number:K});case n.RESET_POMODORO:var Y=t.payload.pomodoro_date;return Object(y.a)({},e,{pomodoro_number:0,pomodoro_used_number:0,pomodoro_date:Y});case n.RESTORE_POMODORO:var B=t.payload,z=B.pomodoro_date,J=B.pomodoro_number,G=B.pomodoro_used_number;return Object(y.a)({},e,{pomodoro_date:z,pomodoro_number:J,pomodoro_used_number:G});case n.LOADED:return Object(y.a)({},e,{loaded:!0});case n.ALLOW_NOTIFICATION:return Object(y.a)({},e,{isNotifable:!0});default:return e}},k=function(e,t,a,n){return function(r){t(r),a(r,n,e)}},j=a(17),C=a.n(j),g=a(19),A=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c=r(),!(s=c.url)){e.next=8;break}return e.next=5,V(s,"projects");case 5:o=e.sent,l=o.data,a({type:n.SET_PROJECTS,payload:{projects:l}});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),q(e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t,a,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l,u;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_PROJECT){e.next=15;break}if(e.prev=1,c=r(),s=c.url,o=t.payload.pid,!s||!o){e.next=10;break}return e.next=7,V(s,"projects/".concat(o));case 7:l=e.sent,u=l.data,a({type:n.SET_PROJECT,payload:{project:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l,u;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_MILESTONES){e.next=15;break}if(e.prev=1,c=r(),s=c.url,o=t.payload.project,!s||!o){e.next=10;break}return e.next=7,V(s,"milestones",{params:{project:o}});case 7:l=e.sent,u=l.data,a({type:n.SET_MILESTONES,payload:{milestones:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),D=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l,u,i,m;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_TASKS){e.next=16;break}if(e.prev=1,c=r(),s=c.url,o=c.reject_task_status_ids,l=t.payload.milestone,!s||!l){e.next=11;break}return e.next=7,V(s,"tasks",{headers:{"x-disable-pagination":!0},params:{milestone:l}});case 7:u=e.sent,i=u.data,m=i.filter(function(e){return!_.a.includes(o,String(e.status))}),a({type:n.SET_TASKS,payload:{tasks:m}});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),q(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t,a,n){return e.apply(this,arguments)}}(),U=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l,u;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_TASK_STATUSES){e.next=15;break}if(e.prev=1,c=r(),s=c.url,o=t.payload.project,!s||!o){e.next=10;break}return e.next=7,V(s,"task-statuses",{params:{project:o}});case 7:l=e.sent,u=l.data,a({type:n.SET_TASK_STATUSES,payload:{task_statuses:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),M=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l,u;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_CUSTOM_ATTRS){e.next=15;break}if(e.prev=1,c=r(),s=c.url,o=t.payload.project,!s||!o){e.next=10;break}return e.next=7,V(s,"task-custom-attributes",{params:{project:o}});case 7:l=e.sent,u=l.data,a({type:n.SET_CUSTOM_ATTRS,payload:{custom_attrs:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),x=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l,u,i;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_CUSTOM_VALUE_MAP){e.next=16;break}if(e.prev=1,c=r(),s=c.url,o=c.custom_eid,l=c.custom_rid,u=t.payload.tasks,!(s&&u.length&&o&&l)){e.next=11;break}return e.t0=WeakMap,e.next=8,Promise.all(u.map(function(){var e=Object(g.a)(C.a.mark(function e(t){var a,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(s,"tasks/custom-attributes-values/".concat(t.id));case 2:return a=e.sent,n=a.data,e.abrupt("return",[t,n]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 8:e.t1=e.sent,i=new e.t0(e.t1),a({type:n.SET_CUSTOM_VALUE_MAP,payload:{custom_value_map:i}});case 11:e.next=16;break;case 13:e.prev=13,e.t2=e.catch(1),q(e.t2);case 16:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t,a,n){return e.apply(this,arguments)}}(),I=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l,u;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_USER){e.next=15;break}if(e.prev=1,c=r(),s=c.url,o=t.payload.uid,!s||!o){e.next=10;break}return e.next=7,V(s,"users/".concat(o));case 7:l=e.sent,u=l.data,a({type:n.SET_USER,payload:{user:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),P=a(26),w=a(12),F=a(9),L=function(e){var t=e.icon,a=e.message;return s.a.createElement("div",{className:"d-flex"},s.a.createElement("h2",{className:"mr-2"},s.a.createElement(w.a,{icon:t})),s.a.createElement("div",null,a))},H=function(e){u.b.success(s.a.createElement(L,{icon:F.b,message:e}))},K=function(e){u.b.error(s.a.createElement(L,{icon:F.c,message:e}))},Y=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l,u,i,m,_,d,E,p,f,O;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.PATCH_CUSTOM_VALUE){e.next=19;break}if(e.prev=1,c=r(),s=c.url,o=c.custom_value_map,l=c.tasks,u=t.payload,i=u.id,m=u.key,_=u.value,d=u.version,E=l.find(function(e){return e.id===i}),!(s&&i&&m&&E&&o.has(E))){e.next=14;break}if(!(p=o.get(E))){e.next=14;break}return f=p.attributes_values,e.next=11,W(s,"tasks/custom-attributes-values/".concat(i),{attributes_values:Object(y.a)({},f,Object(P.a)({},m,String(_))),version:d});case 11:t.meta&&t.meta.use_pomodoro&&(O=t.meta.use_pomodoro.used_number,a({type:n.USE_POMODORO,payload:{used_number:O}})),a({type:n.UPDATE_DATA}),H("Custom value updated. [".concat(_,"]"));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),q(e.t0);case 19:case"end":return e.stop()}},e,null,[[1,16]])}));return function(t,a,n){return e.apply(this,arguments)}}(),B=function(){var e=Object(g.a)(C.a.mark(function e(t,a,r){var c,s,o,l,u,i,m,_,d;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.PATCH_TASK){e.next=15;break}if(e.prev=1,c=r(),s=c.url,o=c.tasks,l=t.payload,u=l.id,i=l.key,m=l.value,_=o.find(function(e){return e.id===u}),!(s&&u&&i&&_)){e.next=10;break}return e.next=8,W(s,"tasks/".concat(u),(d={},Object(P.a)(d,i,m),Object(P.a)(d,"version",_.version),d));case 8:a({type:n.UPDATE_DATA}),H("Task updated. [".concat(i,"=").concat(m,"]"));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),z=function(){var e=Object(g.a)(C.a.mark(function e(t,a,c){var s,o,l,u,i,m,_;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.SIGN_IN){e.next=20;break}if(e.prev=1,s=c(),o=s.url,l=t.payload,u=l.username,i=l.password,!(o&&u&&i)){e.next=13;break}return e.next=7,Z(o,"auth",{username:u,password:i,type:"normal"});case 7:m=e.sent,_=m.data.auth_token,a({type:n.SET_AUTH_TOKEN,payload:{auth_token:_}}),S(r.USERNAME,u),S(r.PASSWORD,i),H("".concat(u," signed in."));case 13:e.next=20;break;case 15:e.prev=15,e.t0=e.catch(1),a({type:n.SET_AUTH_ERROR}),a({type:n.SIGN_OUT}),q(e.t0);case 20:case"end":return e.stop()}},e,null,[[1,15]])}));return function(t,a,n){return e.apply(this,arguments)}}(),J=a(43),G=a.n(J),V=function(e,t,a){return G.a.get("".concat(X(e),"/").concat(t),a)},Z=function(e,t,a,n){return G.a.post("".concat(X(e),"/").concat(t),a,n)},W=function(e,t,a,n){return G.a.patch("".concat(X(e),"/").concat(t),a,n)},q=function(e){var t;try{t=e.response?e.response.data._error_message:"error"}catch(a){t=a.message||a}K(t)},Q=function(e,t,a){switch(e.type){case n.FETCH_PROJECTS:return void A(e,t,a);case n.FETCH_PROJECT:return void R(e,t,a);case n.FETCH_MILESTONES:return void N(e,t,a);case n.FETCH_TASKS:return void D(e,t,a);case n.FETCH_TASK_STATUSES:return void U(e,t,a);case n.FETCH_CUSTOM_ATTRS:return void M(e,t,a);case n.FETCH_CUSTOM_VALUE_MAP:return void x(e,t,a);case n.FETCH_USER:return void I(e,t,a);case n.PATCH_CUSTOM_VALUE:return void Y(e,t,a);case n.SIGN_IN:return void z(e,t,a);case n.PATCH_TASK:return void B(e,t,a);case n.SIGN_OUT:return localStorage.removeItem(r.USERNAME),localStorage.removeItem(r.PASSWORD),void(G.a.defaults.headers.common.Authorization&&delete G.a.defaults.headers.common.Authorization);case n.SET_AUTH_TOKEN:return void function(e,t,a){if(e.type===n.SET_AUTH_TOKEN){var r=e.payload.auth_token;G.a.defaults.headers.common.Authorization="Bearer ".concat(r)}}(e);case n.SET_URL:return void function(e,t,a){if(e.type===n.SET_URL){var c=e.payload.url;S(r.URL,c)}}(e);case n.SET_PID:!function(e,t,a){if(e.type===n.SET_PID){var c=e.payload.pid;S(r.PID,c),localStorage.removeItem(r.MID);var s=O(r.CUSTOM_EID,c),o=O(r.CUSTOM_RID,c);t({type:n.SET_CUSTOM_EID,payload:{custom_eid:s}}),t({type:n.SET_CUSTOM_RID,payload:{custom_rid:o}})}}(e,t);break;case n.SET_MID:!function(e,t,a){if(e.type===n.SET_MID){var c=e.payload.mid;S(r.MID,c);var s=_.a.compact(O(r.BIZ_DAYS,c).split(",")).sort();t({type:n.SET_BIZ_DAYS,payload:{biz_days:s}})}}(e,t);break;case n.SET_CUSTOM_EID:!function(e,t,a){if(e.type===n.SET_CUSTOM_EID){var c=e.payload.custom_eid,s=f(r.PID);T(r.CUSTOM_EID,s,c)}}(e);break;case n.SET_CUSTOM_RID:!function(e,t,a){if(e.type===n.SET_CUSTOM_RID){var c=e.payload.custom_rid,s=f(r.PID);T(r.CUSTOM_RID,s,c)}}(e);break;case n.SET_BIZ_DAYS:case n.ADD_BIZ_DAY:case n.REMOVE_BIZ_DAY:!function(e,t,a){_.a.defer(function(){var e=a(),t=e.mid,n=e.biz_days;T(r.BIZ_DAYS,t,n.join(","))})}(0,0,a);break;case n.ADD_REJECT_TASK_STATUS_ID:case n.REMOVE_REJECT_TASK_STATUS_ID:!function(e,t,a){_.a.defer(function(){var e=a(),t=e.pid,n=e.reject_task_status_ids;T(r.REJECT_TASK_STATUS_IDS,t,n.join(","))})}(0,0,a);break;case n.ADD_POMODORO:case n.USE_POMODORO:case n.RESET_POMODORO:!function(e,t,a){_.a.defer(function(){var e=a(),t=e.pomodoro_date,n=e.pomodoro_number,c=e.pomodoro_used_number;S(r.POMODORO_DATE,t),S(r.POMODORO_NUMBER,String(n)),S(r.POMODORO_USED_NUMBER,String(c))})}(0,0,a)}},$=function(e){!function(e){var t=f(r.URL),a=f(r.PID),c=f(r.MID),s=O(r.CUSTOM_EID,a),o=O(r.CUSTOM_RID,a),l=_.a.compact(O(r.BIZ_DAYS,c).split(",")).sort(),u=_.a.compact(O(r.REJECT_TASK_STATUS_IDS,a).split(",")),i=!(t&&a&&c&&s&&o),m=f(r.POMODORO_DATE),d=Number(f(r.POMODORO_NUMBER)||"0"),E=Number(f(r.POMODORO_USED_NUMBER)||"0");t&&e({type:n.SET_URL,payload:{url:t}}),a&&e({type:n.SET_PID,payload:{pid:a}}),c&&e({type:n.SET_MID,payload:{mid:c}}),s&&e({type:n.SET_CUSTOM_EID,payload:{custom_eid:s}}),o&&e({type:n.SET_CUSTOM_RID,payload:{custom_rid:o}}),l.length&&e({type:n.SET_BIZ_DAYS,payload:{biz_days:l}}),u.length&&e({type:n.SET_REJECT_TASK_STATUS_IDS,payload:{reject_task_status_ids:u}}),i&&e({type:n.OPEN_CONTROLLER}),m&&e({type:n.RESTORE_POMODORO,payload:{pomodoro_date:m,pomodoro_number:d,pomodoro_used_number:E}}),e({type:n.LOADED})}(e),_.a.defer(function(){!function(e){var t=f(r.USERNAME),a=f(r.PASSWORD);e({type:n.SIGN_IN,payload:{username:t,password:a}})}(e)})},X=function(e){return"".concat(e.replace(/[\xa5\/]$/,""),"/api/v1")},ee=function(e,t){return _.a.find(e,{id:t})},te=Object(c.createContext)({state:b,dispatch:function(e){}}),ae=function(e){var t=e.children,a=function(e,t){var a=Object(i.a)(e,2),n=a[0],r=a[1],s=null,o=Object(c.useCallback)(function(e){s&&s(e)},[s]),l=Object(c.useMemo)(function(){return function(){var e;return{getter:function(){return e},setter:function(t){e=t}}}()},[]);return l.setter(n),[n,s=Object(c.useCallback)(k(l.getter,r,t,o),[])]}(Object(c.useReducer)(h,b),Q),r=Object(i.a)(a,2),o=r[0],l=r[1],u={state:o,dispatch:l};return Object(c.useEffect)(function(){o.url&&l({type:n.FETCH_PROJECTS})},[l,o.url]),Object(c.useEffect)(function(){o.url&&o.pid&&(l({type:n.FETCH_MILESTONES,payload:{project:o.pid}}),l({type:n.FETCH_CUSTOM_ATTRS,payload:{project:o.pid}}),l({type:n.FETCH_TASK_STATUSES,payload:{project:o.pid}}),l({type:n.FETCH_PROJECT,payload:{pid:o.pid}}))},[o.url,o.pid,l]),Object(c.useEffect)(function(){o.url&&o.mid&&l({type:n.FETCH_TASKS,payload:{milestone:o.mid,reject_task_status_ids:o.reject_task_status_ids}})},[o.url,o.mid,o.updated_time,o.reject_task_status_ids,l]),Object(c.useEffect)(function(){l({type:n.FETCH_CUSTOM_VALUE_MAP,payload:{tasks:o.tasks}})},[l,o.tasks,o.custom_eid,o.custom_rid]),Object(c.useEffect)(function(){var e=_.a.chain(o.task_statuses).reject(function(e){return _.a.includes(o.reject_task_status_ids,String(e.id))}).orderBy(function(e){return e.order}).value();l({type:n.SET_ACTIVE_TASK_STATUSES,payload:{active_task_statuses:e}})},[o.task_statuses,o.reject_task_status_ids,l]),Object(c.useEffect)(function(){var e=ee(o.custom_attrs,Number(o.custom_eid));e&&l({type:n.SET_CUSTOM_ATTR_E,payload:{custom_attr_e:e}})},[l,o.custom_attrs,o.custom_eid]),Object(c.useEffect)(function(){var e=ee(o.custom_attrs,Number(o.custom_rid));e&&l({type:n.SET_CUSTOM_ATTR_R,payload:{custom_attr_r:e}})},[l,o.custom_attrs,o.custom_rid]),Object(c.useEffect)(function(){var e,t,a=(e=o.milestones,t=o.mid,e.find(function(e){return String(e.id)===t}));a&&l({type:n.SET_MILESTONE,payload:{milestone:a}})},[l,o.mid,o.milestones]),Object(c.useEffect)(function(){if(o.tasks.length>0&&o.user){var e=(t=o.tasks,a=o.user.id,_.a.chain(t).filter({assigned_to:a}).sortBy("user_story").value());l({type:n.SET_USER_TASKS,payload:{user_tasks:e}})}var t,a},[l,o.tasks,o.user]),Object(c.useEffect)(function(){$(l)},[l]),s.a.createElement(te.Provider,{value:u},t)},ne=a(471),re=a(472),ce=a(475),se=a(476),oe=a(477),le=a(466),ue=a(467),ie=a(468),me=a(202),_e=function(e){e.preventDefault()},de=function(e){e.stopPropagation()},Ee=function(){var e=Object(c.useContext)(te),t=e.state,a=t.pid,r=t.projects,o=e.dispatch,l=Object(c.useCallback)(function(e){var t=e.target.value;t&&o({type:n.SET_PID,payload:{pid:t}})},[o]);return s.a.createElement(le.a,{className:"col"},s.a.createElement(ue.a,{addonType:"prepend"},"Project"),s.a.createElement(ie.a,{value:a,type:"select",onChange:l},s.a.createElement("option",{value:""}," --- "),r.map(function(e){return s.a.createElement("option",{key:e.id,value:e.id},e.name)})))},pe=function(){var e=Object(c.useContext)(te),t=e.state,a=t.milestones,r=t.mid,o=e.dispatch,l=Object(c.useCallback)(function(e){var t=e.target.value;t&&o({type:n.SET_MID,payload:{mid:t}})},[o]);return s.a.createElement(le.a,{className:"col"},s.a.createElement(ue.a,{addonType:"prepend"},"Sprint"),s.a.createElement(ie.a,{type:"select",value:r,onChange:l},s.a.createElement("option",{value:""}," --- "),a.map(function(e){return s.a.createElement("option",{key:e.id,value:e.id},e.name)})))},fe=function(){var e=Object(c.useContext)(te),t=e.state,a=t.custom_attrs,r=t.custom_eid,o=t.custom_rid,l=e.dispatch,u=Object(c.useCallback)(function(e){var t=e.target.value;if(t)switch(e.target.name){case"eid":l({type:n.SET_CUSTOM_EID,payload:{custom_eid:t}});break;case"rid":l({type:n.SET_CUSTOM_RID,payload:{custom_rid:t}})}},[l]);return s.a.createElement("div",{className:"row"},s.a.createElement(le.a,{className:"col"},s.a.createElement(ue.a,{addonType:"prepend"},"Estimate"),s.a.createElement(ie.a,{value:r,name:"eid",type:"select",onChange:u},s.a.createElement("option",{value:""}," --- "),a.map(function(e){return s.a.createElement("option",{key:e.id,value:e.id},e.name)}))),s.a.createElement(le.a,{className:"col"},s.a.createElement(ue.a,{addonType:"prepend"},"Result"),s.a.createElement(ie.a,{value:o,name:"rid",type:"select",onChange:u},s.a.createElement("option",null," --- "),a.map(function(e){return s.a.createElement("option",{key:e.id,value:e.id},e.name)}))))},Oe=a(469),Se=a(470),Te=a(494),be=a(473),ve=a(22),ye=a.n(ve),he=a(101),ke=a.n(he),je=function(e,t){return-1===t?"":0===t?"Planning":"Day ".concat(t)},Ce=function(e){return{"text-danger":0===e,"text-info":6===e}},ge=function(e){var t=e.item,a=e.idx,r=Object(c.useContext)(te),o=r.state.biz_days,l=r.dispatch,u=Object(c.useCallback)(function(e){var t=e.target.value;e.target.checked?l({type:n.ADD_BIZ_DAY,payload:{biz_day:t}}):l({type:n.REMOVE_BIZ_DAY,payload:{biz_day:t}})},[l]);if(!t)return s.a.createElement("td",null,s.a.createElement("br",null));var i=t.format("YYYY-MM-DD"),m=i===o[0],d="biz-day-".concat(i),p=_.a.includes(o,i);return s.a.createElement(s.a.Fragment,null,s.a.createElement("td",{className:E()(Ce(a),{"table-info":m}),id:d},ke.a.isWeekDay(t)?s.a.createElement(Oe.a,{check:!0,inline:!0},s.a.createElement(Se.a,{check:!0},s.a.createElement(ie.a,{onChange:u,disabled:ke.a.isWeekendDay(t),value:i,type:"checkbox",checked:p,className:"form-check-input"}),i)):s.a.createElement("span",null,i)),p?s.a.createElement(Te.a,{target:d},function(e,t){var a=t.indexOf(e);return je(0,a)}(i,o)):null)},Ae=function(){var e=Object(c.useContext)(te),t=e.state,a=t.biz_days,r=t.milestone,o=e.dispatch,l=Object(c.useState)([]),u=Object(i.a)(l,2),m=u[0],d=u[1];if(Object(c.useEffect)(function(){if(r){var e=function(e){var t=ye()(e.estimated_start).local(),a=ye()(e.estimated_finish).local().diff(t,"days");return _.a.times(a).map(function(e){return t.clone().add(e,"days")})}(r);d(e),a.length<=1&&o({type:n.SET_BIZ_DAYS,payload:{biz_days:(t=e,t.filter(function(e){return ke.a.isWeekDay(e)}).map(function(e){return e.format("YYYY-MM-DD")}))}})}var t},[r,a,o]),0===m.length)return null;var p=_.a.chunk([].concat(Object(v.a)(_.a.times(m[0].day(),function(){return null})),Object(v.a)(m)),7);return s.a.createElement(ne.a,null,s.a.createElement(re.a,null,"Business Days"),s.a.createElement(be.a,{bordered:!0},s.a.createElement("thead",null,s.a.createElement("tr",null,ye.a.weekdays().map(function(e,t){return s.a.createElement("th",{key:t,className:E()("text-center",Ce(t))},e)}))),s.a.createElement("tbody",null,p.map(function(e,t){return s.a.createElement("tr",{key:t},e.map(function(e,t){return s.a.createElement(ge,{idx:t,key:t,item:e})}))}))))},Re=a(474),Ne=function(e){var t=e.item,a=Object(c.useContext)(te),r=a.state.reject_task_status_ids,o=a.dispatch,l=Object(c.useCallback)(function(e){var t=e.target.value;e.target.checked?o({type:n.REMOVE_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}}):o({type:n.ADD_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}})},[o]);return s.a.createElement(Oe.a,{check:!0,inline:!0},s.a.createElement(Se.a,{check:!0},s.a.createElement(ie.a,{onChange:l,type:"checkbox",value:t.id,defaultChecked:!_.a.includes(r,String(t.id))}),t.name))},De=function(){var e=Object(c.useContext)(te).state.task_statuses;return 0===e.length?null:s.a.createElement(ne.a,null,s.a.createElement(re.a,null,"Task status"),s.a.createElement(Re.a,null,e.map(function(e){return s.a.createElement(Ne,{key:e.id,item:e})})))},Ue=a(201),Me=a.n(Ue),xe=function(e){var t=e.isOpen?90:void 0;return s.a.createElement(w.a,{className:"text-muted mr-2",rotation:t,icon:F.d})},Ie=function(){var e=Object(c.useContext)(te),t=e.state,a=t.url,r=t.isOpen,o=t.biz_days,l=t.milestone,u=e.dispatch,m=Object(c.useState)(""),d=Object(i.a)(m,2),p=d[0],f=d[1],O=Object(c.useCallback)(function(e){f(e.target.value)},[f]),S=Object(c.useCallback)(function(e){p&&u({type:n.SET_URL,payload:{url:p}}),e.preventDefault()},[p,u]),T=Object(c.useCallback)(function(){u(r?{type:n.CLOSE_CONTROLLER}:{type:n.OPEN_CONTROLLER})},[u,r]),b=Object(c.useMemo)(function(){return function(e,t){return e&&t.project_extra_info?"".concat(e,"/project/").concat(t.project_extra_info.slug,"/taskboard/").concat(t.slug):""}(a,l)},[l,a]),v=l.name,y=Object(c.useMemo)(function(){return function(e){return e.length>1?"[".concat(_.a.head(e)," - ").concat(_.a.last(e),"]"):""}(o)},[o]);return s.a.createElement(ne.a,null,s.a.createElement(re.a,{className:E()(Me.a.header),onClick:T},s.a.createElement(xe,{isOpen:r}),v&&s.a.createElement(ce.a,{color:"primary",pill:!0,className:"p-1 m-1"},s.a.createElement("span",null,v)),y&&s.a.createElement(ce.a,{className:"p-1 m-1"},s.a.createElement("span",null,y)),b?s.a.createElement("a",{target:"_blank",onClick:de,className:"float-right",href:b,rel:"noopener noreferrer"},s.a.createElement(w.a,{className:"mr-1",icon:F.m}),"Taskboard"):null),s.a.createElement(se.a,{isOpen:r},s.a.createElement(oe.a,{onSubmit:S},s.a.createElement(le.a,null,s.a.createElement(ue.a,{addonType:"prepend"},"URL"),s.a.createElement(ie.a,{defaultValue:a,onChange:O,placeholder:"http://hostname:port"}),s.a.createElement(ue.a,{addonType:"append"},s.a.createElement(me.a,null,"Set")))),s.a.createElement("div",{className:"row"},s.a.createElement(Ee,null),s.a.createElement(pe,null)),s.a.createElement(fe,null),s.a.createElement(Ae,null),s.a.createElement(De,null)))},Pe=a(64),we=a(48),Fe=a(219),Le=a(479),He=a(480),Ke=a(198),Ye=function(){var e=Object(c.useContext)(te).dispatch,t=Object(c.useCallback)(function(){e({type:n.UPDATE_DATA})},[e]);return s.a.createElement(me.a,{onClick:t},s.a.createElement(w.a,{icon:F.C}))},Be=a(133),ze=a.n(Be),Je=a(478),Ge=function(){var e=Object(c.useContext)(te),t=e.state,a=t.auth_token,r=t.auth_error,o=t.username,l=e.dispatch,u=Object(c.useState)(""),m=Object(i.a)(u,2),_=m[0],d=m[1],E=Object(c.useState)(""),p=Object(i.a)(E,2),f=p[0],O=p[1],S=Object(c.useState)(!1),T=Object(i.a)(S,2),b=T[0],v=T[1],y=Object(c.useCallback)(function(e){_&&f&&(v(!0),l({type:n.SIGN_IN,payload:{username:_,password:f}})),e.preventDefault()},[f,_,l,v]),h=Object(c.useCallback)(function(e){d(e.target.value)},[d]),k=Object(c.useCallback)(function(e){O(e.target.value)},[O]),j=Object(c.useCallback)(function(){l({type:n.SIGN_OUT})},[l]);return Object(c.useEffect)(function(){(r||a)&&v(!1)},[r,a,v]),s.a.createElement(s.a.Fragment,null,a?s.a.createElement(oe.a,{inline:!0,onSubmit:_e,className:"mr-1"},s.a.createElement(le.a,null,s.a.createElement(ue.a,{addonType:"prepend"},s.a.createElement(Ke.a,null,s.a.createElement(w.a,{icon:F.E}))),s.a.createElement(ue.a,{addonType:"prepend",className:"border border-success"},s.a.createElement(Ke.a,null,o)),s.a.createElement(ue.a,{addonType:"append"},s.a.createElement(me.a,{title:"Sign out",onClick:j,color:"danger"},s.a.createElement(w.a,{icon:F.A}))))):s.a.createElement(oe.a,{inline:!0,onSubmit:y,className:"mr-1"},s.a.createElement(le.a,null,s.a.createElement(ue.a,{addonType:"prepend"},s.a.createElement(Ke.a,null,s.a.createElement(w.a,{icon:F.E}))),s.a.createElement(ie.a,{disabled:b,onInput:h,onChange:h,name:"username",placeholder:"username",invalid:r})),s.a.createElement(le.a,null,s.a.createElement(ue.a,{addonType:"prepend"},s.a.createElement(Ke.a,null,s.a.createElement(w.a,{icon:F.s}))),s.a.createElement(ie.a,{disabled:b,onInput:k,onChange:k,name:"password",placeholder:"password",type:"password",invalid:r})),s.a.createElement(me.a,{color:"info"},b?s.a.createElement(Je.a,{size:"sm",type:"grow"}):s.a.createElement(w.a,{icon:F.z}))))},Ve=["success","warning","info","danger"],Ze=function(e){return _.a.groupBy(e,"assigned_to")},We=function(e){var t=e.src||"http://i.pravatar.cc/80?u=".concat(Math.random());return s.a.createElement(Fe.a,Object.assign({},e,{src:t,square:!0,className:"mr-1"}))},qe=function(e,t,a){return e.has(t)?(n=_.a.get(e.get(t),"attributes_values.".concat(a),"0"),_.a.chain(n).replace(/[^0-9.+,]/g,"").replace(/[+]/g,",").split(",").compact().map(Number).sum().value()):0;var n},Qe=function(e,t,a){return _.a.chain(t).map(function(t){return qe(e,t,a)}).sum().value()},$e=function(e,t){return e.has(t)?_.a.get(e.get(t),"version"):void 0},Xe=function(e,t,a){return a&&t===e},et=function(e,t){return t>e},tt=function(e){var t=e.username,a=e.val,n=e.total,r=e.imgSrc,o=Object(c.useMemo)(function(){var e=n>0?(a-n)/n:0;return e<-.1?[F.o,""]:e<=.1?[F.o,"table-success"]:e<=.2?[F.p,"table-warning"]:[F.h,"table-danger"]},[n,a]),l=Object(i.a)(o,2),u=l[0],m=l[1];return a?s.a.createElement(s.a.Fragment,null,s.a.createElement("td",{className:m},s.a.createElement(We,{src:r})," ",t,s.a.createElement(w.a,{className:"mx-1",icon:u})),s.a.createElement("td",{className:E()(m,"text-right")},a)):s.a.createElement(s.a.Fragment,null,s.a.createElement("td",null,s.a.createElement(We,{src:r})," ",t),s.a.createElement("td",null))},at=function(e){var t=e.e,a=e.r,n=Object(c.useMemo)(function(){return function(e,t){if(_.a.isNumber(e)&&_.a.isNumber(t)&&e>0){var a=Math.abs(e-t)/e;if(a<=.05)return["gold",3];if(a<=.1)return["silver",2];if(a<.2)return["bronze",1]}return[null,0]}(t,a)},[t,a]),r=Object(i.a)(n,2),o=r[0],l=r[1];return o?s.a.createElement(s.a.Fragment,null,_.a.times(l).map(function(e){return s.a.createElement(w.a,{key:e,className:ze.a[o],icon:F.t})})):null},nt=function(e){var t=e.tasks,a=Object(c.useContext)(te).state,n=a.active_task_statuses,r=a.custom_eid,o=a.custom_value_map,l=Number(r),u=Object(c.useMemo)(function(){return _.a.chain(n).filter({is_closed:!0}).reverse().map(function(e,a){return{status:e.id,total:Qe(o,_.a.filter(t,{status:e.id}),l),style:Ve[a],label:e.name}}).value()},[n,o,l,t]),i=Object(c.useMemo)(function(){return Qe(o,t,l)},[o,l,t]);return s.a.createElement(Le.a,{multi:!0},u.map(function(e){return s.a.createElement(Le.a,{key:e.label,bar:!0,max:i,value:e.total,color:e.style},e.label)}))},rt=function(e){var t=e.item,a=e.sums,n=e.isPast,r=e.total,o=e.hpd,l=e.tasks,u=Object(c.useState)(0),m=Object(i.a)(u,2),d=m[0],E=m[1],p=Object(c.useCallback)(function(e){E(Number(e.target.value)||0)},[E]),f=_.a.get(a,t.id),O=_.a.get(f,"e"),S=_.a.get(f,"r"),T=d||r,b=String(T);return s.a.createElement("tr",{key:t.id},r>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(tt,{username:t.username,val:O,total:T,imgSrc:t.photo}),s.a.createElement("td",{className:"text-right"},r),s.a.createElement("td",{className:ze.a.custom_input_td},s.a.createElement(ie.a,{bsSize:"sm",type:"number",className:"text-right",value:b,step:o,onChange:p}))):s.a.createElement(s.a.Fragment,null,s.a.createElement("td",null,s.a.createElement(We,{src:t.photo}),s.a.createElement(Pe.b,{to:"/".concat(t.id)},t.username)),s.a.createElement("td",{className:"text-right"},O),s.a.createElement("td",{className:"text-right"},S),s.a.createElement("td",null,_.a.isNumber(O)&&s.a.createElement(nt,{tasks:l}))),n?s.a.createElement("td",null,s.a.createElement(at,{e:O,r:S})):null)},ct=function(){var e=Object(c.useContext)(te).state,t=e.tasks,a=e.custom_value_map,n=e.custom_eid,r=e.custom_rid,o=e.biz_days,l=e.custom_attr_e,u=e.custom_attr_r,m=e.project.members,d=Object(c.useState)(0),E=Object(i.a)(d,2),p=E[0],f=E[1],O=o.length-1,S=Object(c.useCallback)(function(e){f(Number(e.target.value)||0)},[f]),T=p*O,b=Object(c.useMemo)(function(){return function(e,t,a,n){var r=Number(a),c=Number(n);return _.a.mapValues(Ze(e),function(e){return _.a.chain(e).map(function(e){return{e:qe(t,e,r),r:qe(t,e,c)}}).reduce(function(e,t){return{e:e.e+t.e,r:e.r+t.r}},{e:0,r:0}).value()})}(t,a,n,r)},[n,r,a,t]),v=_.a.get(b,"null.e",0),y=T>0,h=Object(c.useMemo)(function(){return!y&&ye()().diff(ye()(_.a.last(o)).local().endOf("days"))>0},[o,y]),k=Object(c.useMemo)(function(){return Ze(t.filter(function(e){return e.is_closed}))},[t]);return!l.id||!u.id||o.length<=1?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(He.a,{color:"light",light:!0},s.a.createElement(oe.a,{inline:!0,className:"mr-auto",onSubmit:_e},s.a.createElement(le.a,null,s.a.createElement(ie.a,{type:"number",step:"0.5",placeholder:"hours / day",className:"text-right",onChange:S}),s.a.createElement(ue.a,{addonType:"append"},s.a.createElement(Ke.a,null,s.a.createElement(w.a,{className:"mx-2",icon:F.D}),O," [days]",s.a.createElement(w.a,{className:"mx-2",icon:F.j})),T>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(Ke.a,{className:"bg-white"},s.a.createElement("strong",null,T)),s.a.createElement(Ke.a,null,"hours / sprint")):null))),s.a.createElement(Ge,null),s.a.createElement(Ye,null)),s.a.createElement(be.a,{bordered:!0},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"Name"),s.a.createElement("th",null,l.name),y?s.a.createElement(s.a.Fragment,null,s.a.createElement("th",null,"Total")," ",s.a.createElement("th",null,"Custom")):s.a.createElement(s.a.Fragment,null,s.a.createElement("th",null,u.name),s.a.createElement("th",null,"Progress")),h?s.a.createElement("th",null,"Grade"):null)),s.a.createElement("tbody",null,(m||[]).map(function(e){return s.a.createElement(rt,{key:e.id,isPast:h,item:e,sums:b,total:T,hpd:p,tasks:k[e.id]||[]})}),s.a.createElement("tr",{key:"null"},s.a.createElement("td",{className:"text-danger"},s.a.createElement(w.a,{icon:F.n,className:"ml-1 mr-2 fa-lg"}),"Not assigned"),s.a.createElement("td",{className:"text-right text-danger"},v),s.a.createElement("td",null),s.a.createElement("td",null),h?s.a.createElement("td",null):null))))},st=a(481),ot=a(482),lt=a(483),ut=a(484),it=a(485),mt=a(486),_t=a(487),dt=a(488),Et=a(489),pt=a(490),ft=function(){return s.a.createElement(ue.a,{addonType:"append"},s.a.createElement(Ke.a,null,s.a.createElement(w.a,{icon:F.B,className:"fa-pulse"})))};function Ot(){return(Ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function St(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Tt,bt=s.a.createElement("g",null,s.a.createElement("path",{fill:"currentColor",className:"leaf",d:"M115.343,123.839c0.814,1.256,3.343,2.605,7.23,4.014c7.586-1.069,14.943-1.586,21.885-1.586 c15.579,0,30.166,2.469,42.438,7.145c17.87-5.567,43.412-11.694,69.108-11.694c25.694,0,51.228,6.126,69.108,11.694 c12.262-4.676,26.848-7.145,42.42-7.145c7.001,0,14.418,0.518,22.063,1.604c3.471-1.341,6.296-2.699,8.325-4.031 c42.2-28.139,53.036-81.183,47.41-69.931c-4.218,8.418-60.309,35.581-100.004,52.222c14.68-17.769,31.677-44.134,43.438-80.309 c0,0-60.978,52.382-98.867,74.887c-11.974-20.816-33.892-86.589-33.892-86.589s-18.567,49.515-20.358,81.412 c-30.21-16.929-63.354-51.474-72.485-74.538c-10.752-27.189-13.78,53.545,15.436,89.396c-1.095,0.162-2.206,0.315-3.344,0.476 c-39.111-16.072-100.454-47.91-104.926-54.86C64.708,47.255,73.143,101.954,115.343,123.839z M290.531,107.181l0.747,0.857 l-3.098-0.746L290.531,107.181z"}),s.a.createElement("path",{fill:"currentColor",className:"tomato",d:"M485.83,198.564c-38.169-57.253-117.544-70.584-160.338-52.195c-18.27-5.906-43.872-12.27-69.49-12.27 c-25.619,0-51.228,6.364-69.499,12.27c-42.794-18.388-122.168-5.058-160.338,52.195c-64.136,96.203-18.711,299.318,229.836,299.318 C504.541,497.882,549.974,294.767,485.83,198.564z M101.172,262.929c-17.099,0-30.947-13.857-30.947-30.948 c0-17.09,13.848-30.947,30.947-30.947c17.082,0,30.947,13.857,30.947,30.947C132.119,249.071,118.253,262.929,101.172,262.929z"})),vt=function(e){var t=e.svgRef,a=St(e,["svgRef"]);return s.a.createElement("svg",Ot({id:"_x32_",x:"0px",y:"0px",viewBox:"0 0 512 512",xmlSpace:"preserve",ref:t},a),bt)},yt=s.a.forwardRef(function(e,t){return s.a.createElement(vt,Ot({svgRef:t},e))}),ht=(a.p,a(136)),kt=a.n(ht);!function(e){e.FRESH="fresh",e.STALE="stale"}(Tt||(Tt={}));var jt,Ct,gt,At=function(e){var t,a=e.state;return s.a.createElement(yt,{className:E()("fa-fw","svg-inline--fa",(t={},Object(P.a)(t,kt.a.fresh,a===Tt.FRESH),Object(P.a)(t,kt.a.stale,a===Tt.STALE),t))})},Rt=a(104),Nt=a.n(Rt),Dt=a(103),Ut=a.n(Dt),Mt=a(70),xt=a.n(Mt),It=a(217),Pt=a(102),wt=a.n(Pt),Ft=function(e){return _.a.chain(e).groupBy("user_story").map(function(e,t){return{user_story:Number(t),user_story_extra_info:e[0].user_story_extra_info,project_extra_info:e[0].project_extra_info,tasks:e,is_closed:e.every(function(e){return e.is_closed})}}).value()},Lt=function(e){return e?"Need sign in!":""},Ht=function(e){var t=e.user_story_extra_info,a=e.project_extra_info,n=Object(c.useContext)(te).state.url,r=a.slug,o=t?"#".concat(t.ref," ").concat(t.subject):void 0,l=t?"".concat(n,"/project/").concat(r,"/us/").concat(t.ref):"#";return o?s.a.createElement("a",{href:l,target:"_blank",rel:"noopener noreferrer",title:o},s.a.createElement(w.a,{icon:F.m})," ",o):s.a.createElement(s.a.Fragment,null,"(Unassigned tasks)")},Kt=function(e){var t=e.item,a=Object(c.useContext)(te).state.url,n="#".concat(t.ref," ").concat(t.subject),r="".concat(a,"/project/").concat(t.project_extra_info.slug,"/task/").concat(t.ref);return s.a.createElement("a",{href:r,target:"_blank",rel:"noopener noreferrer",title:n},s.a.createElement(w.a,{icon:F.m})," ",n)},Yt=function(e){var t=e.label,a=e.value,n=e.onSubmit,r=e.onEditable,o=e.onValueChange,l=e.valid,u=e.invalid,m=e.disabled,_=e.loading,d=e.id,E=e.submitting,p=Object(c.useState)(!1),f=Object(i.a)(p,2),O=f[0],S=f[1],T=Object(c.useState)(""),b=Object(i.a)(T,2),v=b[0],y=b[1],h=Object(c.useState)(!1),k=Object(i.a)(h,2),j=k[0],C=k[1],g=Object(c.useCallback)(function(e){S(e.currentTarget.checked)},[S]),A=Object(c.useCallback)(function(e){var t=e.target.value;y(t),o&&o(Number(t))},[o]),R=Object(c.useCallback)(function(e){var t=Number(v);O&&""!==v&&t>=0&&n&&(n(t),S(!1),C(!0)),e.preventDefault()},[O,v,n,S]);Object(c.useEffect)(function(){m&&S(!1)},[S,m]),Object(c.useEffect)(function(){C(!1)},[a]),Object(c.useEffect)(function(){r&&r(O)},[O,r]),Object(c.useEffect)(function(){E&&(S(!1),C(!0))},[E]);var N=Lt(m);return s.a.createElement(oe.a,{inline:!0,onSubmit:R},s.a.createElement(le.a,{className:xt.a.toggle_input},s.a.createElement(ue.a,{addonType:"prepend"},t),_?s.a.createElement(ft,null):s.a.createElement(s.a.Fragment,null,O?s.a.createElement(s.a.Fragment,null,s.a.createElement(ue.a,{addonType:"prepend"},s.a.createElement(wt.a,null,a)),s.a.createElement(ue.a,{addonType:"prepend"},s.a.createElement(wt.a,null,s.a.createElement(w.a,{className:"text-info",icon:F.q}))),s.a.createElement(ie.a,{onInput:A,onChange:A,defaultValue:String(a),type:"number",step:"0.5",min:"0",id:d}),s.a.createElement(ue.a,{addonType:"append"},s.a.createElement(me.a,{color:"info"},s.a.createElement(w.a,{icon:F.e})))):s.a.createElement(s.a.Fragment,null,j?s.a.createElement(ft,null):s.a.createElement(ie.a,{valid:l,invalid:u,readOnly:!0,value:a})),s.a.createElement(ue.a,{addonType:"append",title:N},s.a.createElement(It.a,{disabled:m,checked:O,onChange:g},s.a.createElement(w.a,{className:"text-info",icon:F.i}))))))},Bt=function(e){var t=e.e,a=e.r;return s.a.createElement(le.a,{className:xt.a.display_medal},s.a.createElement(ue.a,{addonType:"prepend"},"Grade"),s.a.createElement(wt.a,{className:xt.a.medal},s.a.createElement(at,{e:t,r:a})))},zt=function(e){var t=e.item,a=e.task,r=e.onSelect,o=Object(c.useContext)(te).dispatch,l=Object(c.useCallback)(function(){o({type:n.PATCH_TASK,payload:{key:"status",value:t.id,id:a.id}}),r&&r(t.id)},[o,t.id,a.id,r]);return s.a.createElement(st.a,{onClick:l},t.name)},Jt=function(e){var t=e.task,a=e.disabled,n=Object(c.useState)(!1),r=Object(i.a)(n,2),o=r[0],l=r[1],u=Object(c.useContext)(te).state.active_task_statuses,m=Object(c.useCallback)(function(){l(!0)},[l]);return Object(c.useEffect)(function(){l(!1)},[t.version,l]),s.a.createElement(s.a.Fragment,null,o?s.a.createElement(Je.a,{type:"grow",color:"info"}):s.a.createElement(ot.a,null,s.a.createElement(lt.a,{title:Lt(a),disabled:a,caret:!a},t.status_extra_info.name),s.a.createElement(ut.a,null,u.map(function(e){return s.a.createElement(zt,{item:e,key:e.id,task:t,onSelect:m})}))))},Gt=function(e){var t=e.item,a=e.onSelect,n=Object(c.useCallback)(function(){a&&a(t.id)},[t.id,a]);return s.a.createElement(st.a,{onClick:n},s.a.createElement(We,{src:t.photo}),t.username)},Vt=function(e){var t=e.task,a=e.disabled,r=Object(c.useState)(!1),o=Object(i.a)(r,2),l=o[0],u=o[1],m=Object(c.useContext)(te),_=m.state.project.members,d=m.dispatch,E=Object(c.useCallback)(function(e){u(!0),d({type:n.PATCH_TASK,payload:{key:"assigned_to",value:e,id:t.id}})},[d,t.id]);return Object(c.useEffect)(function(){u(!1)},[t.version,u]),s.a.createElement(s.a.Fragment,null,l?s.a.createElement(Je.a,{type:"grow",color:"info"}):s.a.createElement(ot.a,null,s.a.createElement(lt.a,{title:Lt(a),size:"sm",disabled:a,caret:!a},"Assign To"),s.a.createElement(ut.a,null,(_||[]).map(function(e){return s.a.createElement(Gt,{item:e,onSelect:E,key:e.id})}))))},Zt=function(e){var t=e.task,a=Object(c.useState)(!1),r=Object(i.a)(a,2),o=r[0],l=r[1],u=Object(c.useContext)(te).dispatch,m=Object(c.useCallback)(function(){l(!0),u({type:n.PATCH_TASK,payload:{key:"assigned_to",value:null,id:t.id}})},[u,t.id]);return Object(c.useEffect)(function(){l(!1)},[t.version,l]),s.a.createElement(s.a.Fragment,null,o?s.a.createElement(Je.a,{type:"grow",color:"danger"}):s.a.createElement(me.a,{className:"mr-2",title:"Not assigned",color:"danger",onClick:m},s.a.createElement(w.a,{icon:F.F})))},Wt=function(e){var t=e.item,a=Object(c.useContext)(te),r=a.state,o=r.custom_eid,l=r.custom_value_map,u=r.auth_token,i=r.custom_attr_e,m=a.dispatch,_=$e(l,t),d=Object(c.useCallback)(function(e){_&&m({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:o,value:e,version:_}})},[m,t.id,o,_]),E=Object(c.useMemo)(function(){return qe(l,t,i.id)},[i.id,l,t]);if(!i.id)return null;var p=!E,f=""===u,O=!_;return s.a.createElement(Yt,{onSubmit:d,label:i.name,value:E,invalid:p,disabled:f,loading:O})},qt=function(e){var t=e.item,a=Object(c.useState)(!1),r=Object(i.a)(a,2),o=r[0],l=r[1],u=Object(c.useState)(0),m=Object(i.a)(u,2),d=m[0],p=m[1],f=Object(c.useState)(!1),O=Object(i.a)(f,2),S=O[0],T=O[1],b=Object(c.useState)(!1),v=Object(i.a)(b,2),y=v[0],h=v[1],k=Object(c.useContext)(te),j=k.state,C=j.custom_rid,g=j.custom_value_map,A=j.custom_attr_e,R=j.custom_attr_r,N=j.auth_token,D=j.pomodoro_number,U=j.pomodoro_used_number,M=k.dispatch,x=$e(g,t),I=Object(c.useCallback)(function(){l(!o)},[o]),P=Object(c.useCallback)(function(e,a){x&&(M({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:C,value:e,version:x},meta:a?{use_pomodoro:{used_number:a}}:void 0}),h(!0))},[C,M,t.id,x]),L=Object(c.useCallback)(function(){p(d+1)},[d]),H=Object(c.useCallback)(function(){p(d-1)},[d]),K=Object(c.useCallback)(function(){p(0)},[]),Y=Object(c.useCallback)(function(e){T(e)},[]),B=Object(c.useMemo)(function(){return qe(g,t,A.id)},[A.id,g,t]),z=Object(c.useMemo)(function(){return qe(g,t,R.id)},[R.id,g,t]),J=Object(c.useCallback)(function(e){T(z===e)},[z]),G=Object(c.useCallback)(function(){P(z+d/2,d),l(!1),p(0)},[P,z,d]),V=Object(c.useMemo)(function(){return Xe(B,z,t.is_closed)},[B,t.is_closed,z]),Z=Object(c.useMemo)(function(){return et(B,z)},[B,z]);if(Object(c.useEffect)(function(){x||h(!1)},[x]),!R.id)return null;var W=""===N,q=!x,Q="rusult-input-".concat(t.id),$=D-U,X=d>0,ee=d===$;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Yt,{onSubmit:P,onEditable:Y,onValueChange:J,label:R.name,value:z,valid:V,invalid:Z,disabled:W,loading:q,id:Q,submitting:y}),S&&$>0&&s.a.createElement(it.a,{className:E()("popover-wide"),target:Q,placement:"top",isOpen:o,toggle:I,trigger:"click hover"},s.a.createElement(mt.a,null,"Pomodoro"),s.a.createElement(_t.a,null,s.a.createElement(dt.a,null,s.a.createElement(me.a,{disabled:ee,onClick:L},s.a.createElement(w.a,{icon:F.x})),s.a.createElement(me.a,{disabled:!X,onClick:H},s.a.createElement(w.a,{icon:F.u})),s.a.createElement(me.a,{disabled:!0,className:"bg-light"},_.a.times($).map(function(e){return s.a.createElement(At,{key:e,state:e>=d?Tt.FRESH:Tt.STALE})})),s.a.createElement(me.a,{disabled:!X,onClick:G},s.a.createElement(w.a,{icon:F.e})),s.a.createElement(me.a,{disabled:!X,onClick:K},s.a.createElement(w.a,{icon:F.k}))))))},Qt=function(e){var t=e.item,a=Object(c.useContext)(te).state,n=a.custom_value_map,r=a.custom_attr_e,o=a.custom_attr_r,l=a.auth_token,u=Object(c.useMemo)(function(){return $e(n,t)},[n,t]),i=Object(c.useMemo)(function(){return qe(n,t,r.id)},[r.id,n,t]),m=Object(c.useMemo)(function(){return qe(n,t,o.id)},[o.id,n,t]);if(!r.id||!o.id)return null;var _=""===l,d=!u,p=0===m&&!t.is_closed&&!_&&!d;return s.a.createElement(Ut.a,{className:E()(Object(P.a)({},xt.a.is_closed,t.is_closed))},s.a.createElement("div",{className:"d-flex mb-1"},s.a.createElement("div",{className:"mr-auto text-truncate"},s.a.createElement(Kt,{item:t})),p&&s.a.createElement(Zt,{task:t}),s.a.createElement(Jt,{task:t,disabled:_})),s.a.createElement(Et.a,null,s.a.createElement(pt.a,null,s.a.createElement(Wt,{item:t})),s.a.createElement(pt.a,null,s.a.createElement(qt,{item:t})),s.a.createElement(pt.a,null,s.a.createElement(Bt,{e:i,r:m}))))},$t=function(e){var t=e.item;return s.a.createElement(ne.a,null,s.a.createElement(re.a,{className:"text-truncate"},s.a.createElement(Ht,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),s.a.createElement(Nt.a,null,t.tasks.map(function(e){return s.a.createElement(Ut.a,{key:e.id,className:"text-truncate"},s.a.createElement("div",{className:"d-flex"},s.a.createElement("div",{className:"mr-auto text-truncate"},s.a.createElement(Kt,{item:e})),s.a.createElement(Wt,{item:e})))})))},Xt=function(e){var t=e.item,a=""===Object(c.useContext)(te).state.auth_token;return s.a.createElement(ne.a,null,s.a.createElement(re.a,{className:"text-truncate"},s.a.createElement(Ht,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),s.a.createElement(se.a,{isOpen:!0},s.a.createElement(Nt.a,null,t.tasks.map(function(e){return s.a.createElement(Ut.a,{key:e.id},s.a.createElement("div",{className:"d-flex"},s.a.createElement("div",{className:"mr-auto text-truncate"},s.a.createElement(Kt,{item:e})),s.a.createElement(Vt,{task:e,disabled:a})))}))))},ea=function(e){var t=e.item,a=Object(c.useState)(!1),n=Object(i.a)(a,2),r=n[0],o=n[1],l=Object(c.useCallback)(function(){o(!r)},[r,o]);return Object(c.useEffect)(function(){o(!t.is_closed)},[t.is_closed,o]),s.a.createElement(ne.a,null,s.a.createElement(re.a,{className:E()(xt.a.header,"text-truncate",{"alert-primary":t.is_closed}),onClick:l},s.a.createElement(xe,{isOpen:r}),s.a.createElement(Ht,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),s.a.createElement(se.a,{isOpen:r},s.a.createElement(Nt.a,null,t.tasks.map(function(e){return s.a.createElement(Qt,{item:e,key:e.id})}))))},ta=function(){var e=Object(c.useContext)(te).state,t=e.tasks,a=e.custom_value_map,n=e.custom_eid,r=Object(c.useMemo)(function(){return Number(n)},[n]),o=Object(c.useMemo)(function(){return r?t.filter(function(e){return $e(a,e)&&0===qe(a,e,r)}):[]},[a,r,t]),l=Object(c.useMemo)(function(){return Ft(o)},[o]);return 0===o.length?null:s.a.createElement(ne.a,null,s.a.createElement(re.a,{className:"alert-danger"},"Un estimated tasks"),s.a.createElement(Re.a,null,l.map(function(e){return s.a.createElement($t,{item:e,key:e.user_story})})))},aa=function(){var e=Object(c.useContext)(te).state.tasks,t=Object(c.useMemo)(function(){return _.a.filter(e,{assigned_to:null})},[e]),a=Object(c.useMemo)(function(){return Ft(t)},[t]);return 0===t.length?null:s.a.createElement(ne.a,null,s.a.createElement(re.a,{className:"alert-danger"},"Not assigned tasks"),s.a.createElement(Re.a,null,a.map(function(e){return s.a.createElement(Xt,{item:e,key:e.user_story})})))},na=a(45),ra=function(e,t){return e.filter(function(e){return ye()(t).endOf("days").diff(ye()(e.created_date))>0})},ca=function(e,t,a){return _.a.chain(t).map(function(t){return qe(e,t,Number(a))}).sum().value()},sa=function(e){var t=e.tasks,a=Object(c.useState)([]),n=Object(i.a)(a,2),r=n[0],o=n[1],l=Object(c.useContext)(te).state,u=l.biz_days,m=l.custom_value_map,_=l.custom_eid,d=l.custom_attr_e,E=l.custom_attr_r;Object(c.useEffect)(function(){var e=u.length;if(e>0&&t.length>0&&_){var a=ca(m,ra(t,u[0]),_),n=u.map(function(n,r){var c=je(0,r),s=a-a*r/(e-1);if(ye()().local().endOf("days").diff(ye()(n))>0){var o=0===r?0:ca(m,function(e,t){return e.filter(function(e){return ye()(t).local().format("YYYY-MM-DD")===ye()(e.created_date).local().format("YYYY-MM-DD")})}(t,n),_);return{label:c,estimate:s,result:ca(m,ra(t,n),_)-o-ca(m,function(e,t){return e.filter(function(e){return!!e.finished_date&&ye()(t).local().endOf("days").diff(ye()(e.finished_date))>0})}(t,n),_),add:o}}return{label:c,estimate:s}});o(n)}else o([])},[t,u,_,m,o]);var p=Object(c.useCallback)(function(e){switch(e){case"estimate":return d.name||e;case"result":return E.name||e;default:return e}},[d.name,E.name]),f=Object(c.useCallback)(function(e,t){return[Number(e).toFixed(1),p(t)]},[p]);return 0===r.length?null:s.a.createElement(ne.a,{className:"mb-2"},s.a.createElement(re.a,null,"Burn down chart"),s.a.createElement(na.b,{data:r,width:800,height:400},s.a.createElement(na.g,null),s.a.createElement(na.f,{dataKey:"label"}),s.a.createElement(na.e,{formatter:f}),s.a.createElement(na.c,{formatter:p}),s.a.createElement(na.a,{dataKey:"result",fill:"#8884d8",stackId:"a"}),s.a.createElement(na.a,{dataKey:"add",fill:"#82ca9d",stackId:"a"}),s.a.createElement(na.d,{dataKey:"estimate"})))},oa=function(){var e=Object(c.useContext)(te).state.tasks;return s.a.createElement(s.a.Fragment,null,s.a.createElement(ct,null),s.a.createElement(aa,null),s.a.createElement("br",null),s.a.createElement(ta,null),s.a.createElement("br",null),s.a.createElement(sa,{tasks:e}))},la=a(492),ua=a(491),ia=function(){var e=Object(c.useContext)(te).state,t=e.custom_value_map,a=e.biz_days,n=e.user_tasks,r=e.custom_attr_e,o=e.custom_attr_r,l=Object(c.useMemo)(function(){return Ft(n)},[n]),u=Object(c.useMemo)(function(){return n.reduce(function(e,a){return[e[0]+qe(t,a,r.id),e[1]+qe(t,a,o.id)]},[0,0])},[r.id,o.id,t,n]),m=Object(i.a)(u,2),_=m[0],d=m[1],p=Object(c.useMemo)(function(){return Xe(_,d,l.every(function(e){return e.is_closed}))},[_,d,l]),f=Object(c.useMemo)(function(){return et(_,d)},[_,d]),O=Object(c.useMemo)(function(){return n.some(function(e){return!$e(t,e)})},[t,n]);return!r.id||!o.id||a.length<=1?null:s.a.createElement(s.a.Fragment,null,l.map(function(e){return s.a.createElement(ea,{item:e,key:e.user_story})}),s.a.createElement(ne.a,null,s.a.createElement(re.a,{className:E()("alert-info")},"Total"),s.a.createElement(Re.a,null,s.a.createElement(Et.a,null,s.a.createElement(pt.a,null,s.a.createElement(le.a,null,s.a.createElement(ue.a,{addonType:"prepend"},r.name),O?s.a.createElement(ft,null):s.a.createElement(ie.a,{readOnly:!0,value:_}))),s.a.createElement(pt.a,null,s.a.createElement(le.a,null,s.a.createElement(ue.a,{addonType:"prepend"},o.name),O?s.a.createElement(ft,null):s.a.createElement(ie.a,{readOnly:!0,value:d,invalid:f,valid:p}))),s.a.createElement(pt.a,null,s.a.createElement(Bt,{e:_,r:d})))),s.a.createElement(ua.a,null,s.a.createElement(nt,{tasks:n}))))},ma=function(){var e=Object(c.useContext)(te).state.user;return s.a.createElement(ne.a,null,e&&s.a.createElement(re.a,null,s.a.createElement(We,{src:e.photo,size:"xlarge"}),e.username," 's task"))},_a=a(213),da=a.n(_a),Ea=function(){var e=Object(c.useContext)(te),t=e.state,a=t.user,r=t.user_tasks,o=t.url,l=e.dispatch,u=da()().match.params.uid;return Object(c.useEffect)(function(){return u&&o&&l({type:n.FETCH_USER,payload:{uid:u}}),function(){l({type:n.RESET_USER})}},[l,u,o]),s.a.createElement(s.a.Fragment,null,s.a.createElement(He.a,{color:"light",light:!0},s.a.createElement(me.a,{tag:Pe.b,to:"/",className:"mr-auto"},s.a.createElement(w.a,{icon:F.a})," Go back"),s.a.createElement(Ge,null),s.a.createElement(Ye,null)),a?s.a.createElement(s.a.Fragment,null,s.a.createElement(ma,null),s.a.createElement("br",null),s.a.createElement(ia,null),s.a.createElement("br",null),s.a.createElement(sa,{tasks:r})):s.a.createElement(la.a,{color:"danger"},"This user does not exist."))},pa=a(493),fa=a(140),Oa=a.n(fa),Sa=a(214),Ta=a.n(Sa),ba=a(215),va=a(216),ya=a(218),ha=a(55),ka=a(141),ja=a(220),Ca=a(99);!function(e){e.STOPPED="stopped",e.RUNNING="running",e.PAUSED="paused"}(Ct||(Ct={})),function(e){e.FOCUS="Focusing",e.SHORT="Short break",e.LONG="Long break"}(gt||(gt={}));var ga,Aa=(jt={},Object(P.a)(jt,gt.FOCUS,25),Object(P.a)(jt,gt.SHORT,5),Object(P.a)(jt,gt.LONG,15),jt);!function(e){e.STATE="pomodoro_state",e.MODE="pomodoro_mode",e.CHECKPOINT_START_AT="pomodoro_checkpoint_start_at",e.CHECKPOINT_ELAPSED="pomodoro_checkpoint_elapsed"}(ga||(ga={}));var Ra=new(function(e){function t(e){var a;return Object(ba.a)(this,t),(a=Object(ya.a)(this,Object(ha.a)(t).call(this))).state=Ct.STOPPED,a.mode=gt.FOCUS,a.duration=60*Aa[gt.FOCUS],a.tick=60,a.checkpointStartAt=NaN,a.checkpointElapsed=0,a.expireTimeout=null,a.tickInterval=null,a.restoreExpired=!1,a.tick=e,a.restoreStorage(),a}return Object(ja.a)(t,e),Object(va.a)(t,[{key:"on",value:function(e,a){return Object(ka.a)(Object(ha.a)(t.prototype),"on",this).call(this,e,a)}},{key:"once",value:function(e,a){return Object(ka.a)(Object(ha.a)(t.prototype),"once",this).call(this,e,a)}},{key:"start",value:function(){this.isStopped&&(this.setExpireTimeout(this.duration),this.setTickInterval(this.tick),this.state=Ct.RUNNING,this.checkpointStartAt=Date.now(),this.checkpointElapsed=0,this.emit("start",this.status),this.saveStorage())}},{key:"stop",value:function(){this.isStopped||(this.clearExpireTimeout(),this.clearTickInterval(),this.checkpointStartAt=NaN,this.checkpointElapsed=0,this.state=Ct.STOPPED,this.emit("stop",this.status),this.saveStorage())}},{key:"pause",value:function(){if(this.isRunning){this.clearExpireTimeout(),this.clearTickInterval();var e=(Date.now()-this.checkpointStartAt)/1e3;this.checkpointElapsed+=e,this.state=Ct.PAUSED,this.emit("pause",this.status),this.saveStorage()}}},{key:"resume",value:function(){this.isPaused&&(this.setExpireTimeout(this.remaining),this.setTickInterval(this.tick),this.state=Ct.RUNNING,this.checkpointStartAt=Date.now(),this.emit("resume",this.status),this.saveStorage())}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"changeMode",value:function(e){this.stop(),this.mode=e,this.duration=60*Aa[e],this.emit("change_mode",this.status),this.saveStorage()}},{key:"setExpireTimeout",value:function(e){var t=this;this.expireTimeout=setTimeout(function(){t.clearTickInterval(),t.clearExpireTimeout(),t.checkpointStartAt=Date.now(),t.checkpointElapsed=t.duration,t.state=Ct.STOPPED,t.emit("expire",t.status)},1e3*e)}},{key:"clearExpireTimeout",value:function(){this.expireTimeout&&clearTimeout(this.expireTimeout),this.expireTimeout=null}},{key:"setTickInterval",value:function(e){var t=this;this.tickInterval=setInterval(function(){t.emit("tick",t.status)},1e3*e)}},{key:"clearTickInterval",value:function(){this.tickInterval&&clearInterval(this.tickInterval),this.tickInterval=null}},{key:"saveStorage",value:function(){localStorage.setItem(ga.STATE,this.state),localStorage.setItem(ga.MODE,this.mode),localStorage.setItem(ga.CHECKPOINT_START_AT,Number.isNaN(this.checkpointStartAt)?"":String(this.checkpointStartAt)),localStorage.setItem(ga.CHECKPOINT_ELAPSED,String(this.checkpointElapsed))}},{key:"restoreStorage",value:function(){var e,t=localStorage.getItem(ga.STATE),a=localStorage.getItem(ga.MODE),n=localStorage.getItem(ga.CHECKPOINT_START_AT),r=localStorage.getItem(ga.CHECKPOINT_ELAPSED);if(e=t,_.a.includes(_.a.values(Ct),e)&&function(e){return _.a.includes(_.a.values(gt),e)}(a)){var c=t,s=a,o=60*Aa[s];switch(c){case Ct.STOPPED:this.changeMode(s);break;case Ct.PAUSED:var l=Number(r);l<1e3*o&&(this.state=c,this.mode=s,this.duration=o,this.checkpointElapsed=l);break;case Ct.RUNNING:var u=Number(n),i=Number(r);if(u>0)this.mode=s,this.duration=o,Date.now()-u+1e3*i<1e3*o?(this.state=Ct.RUNNING,this.checkpointStartAt=u,this.checkpointElapsed=i,this.setExpireTimeout(this.remaining),this.setTickInterval(this.tick)):(this.checkpointStartAt=Date.now(),this.checkpointElapsed=this.duration,this.state=Ct.STOPPED,this.restoreExpired=!0)}}}},{key:"isStopped",get:function(){return this.state===Ct.STOPPED}},{key:"isRunning",get:function(){return this.state===Ct.RUNNING}},{key:"isPaused",get:function(){return this.state===Ct.PAUSED}},{key:"remaining",get:function(){return Math.max(this.duration-this.elapsed,0)}},{key:"elapsed",get:function(){var e=0;return this.checkpointStartAt&&this.isRunning&&(e=(Date.now()-this.checkpointStartAt)/1e3),this.checkpointElapsed+e}},{key:"status",get:function(){return{state:this.state,duration:this.duration,elapsed:this.elapsed,remaining:this.remaining,checkpointElapsed:this.checkpointElapsed,checkpointStartAt:this.checkpointStartAt,mode:this.mode}}}]),t}(Ca.EventEmitter))(60),Na=new(a(462))({animation:"fade"}),Da=function(e){return Math.ceil(e/60)},Ua=function(e){switch(e.mode){case gt.SHORT:return s.a.createElement(w.a,{className:"fa-fw",icon:F.f});case gt.LONG:return s.a.createElement(w.a,{className:"fa-fw",icon:F.g});default:return s.a.createElement(At,null)}},Ma=function(e){var t=e.mode,a=e.onSelect,n=Object(c.useCallback)(function(){a(t)},[t,a]);return s.a.createElement(st.a,{onClick:n},s.a.createElement(Ua,{mode:t}),t)},xa=function(){var e=Object(c.useContext)(te),t=e.state,a=t.loaded,r=t.pomodoro_date,o=t.pomodoro_number,l=t.pomodoro_used_number,u=t.auth_token,m=t.isNotifable,d=e.dispatch,p=Object(c.useState)(!1),f=Object(i.a)(p,2),O=f[0],S=f[1],T=Object(c.useState)(Aa[gt.FOCUS]),b=Object(i.a)(T,2),v=b[0],y=b[1],h=Object(c.useState)(Ct.STOPPED),k=Object(i.a)(h,2),j=k[0],C=k[1],g=Object(c.useState)(gt.FOCUS),A=Object(i.a)(g,2),R=A[0],N=A[1],D=Object(c.useCallback)(function(){S(function(e){return!e})},[]),U=Object(c.useCallback)(function(e){Ra.changeMode(e)},[]),M=Object(c.useCallback)(function(){switch(j){case Ct.RUNNING:Ra.pause();break;case Ct.PAUSED:Ra.resume();break;case Ct.STOPPED:Ra.start()}},[j]),x=Object(c.useCallback)(function(e){C(e.state),y(Da(e.remaining))},[]),I=Object(c.useCallback)(function(e){N(e.mode),y(Da(e.duration))},[]),P=Object(c.useCallback)(function(e){y(Da(e.remaining))},[]),L=Object(c.useCallback)(function(e){var t=o;if(x(e),e.mode===gt.FOCUS?(d({type:n.ADD_POMODORO}),++t%4===0?Ra.changeMode(gt.LONG):Ra.changeMode(gt.SHORT)):Ra.changeMode(gt.FOCUS),m){var a,r="";switch(a="".concat(t," Pomodoros today!"),Ra.mode){case gt.FOCUS:r="Start Focusing.";break;case gt.SHORT:r="Take a Short Break.";break;case gt.LONG:r="Take a Long Break."}var c=new Notification(r,{body:a,icon:Ta.a});c.onclick=function(){Ra.start(),c.close()}}},[d,x,m,o]),H=Object(c.useCallback)(function(){Ra.changeMode(gt.FOCUS),Ra.start()},[]);return Object(c.useEffect)(function(){return Ra.on("tick",P),Ra.on("start",x),Ra.on("stop",x),Ra.on("pause",x),Ra.on("resume",x),Ra.on("expire",L),Ra.on("change_mode",I),function(){Ra.removeAllListeners()}},[L,I,x,P]),Object(c.useEffect)(function(){N(Ra.mode),C(Ra.state),y(Da(Ra.remaining)),Ra.restoreExpired&&(L(Ra.status),Ra.restoreExpired=!1)},[L]),Object(c.useEffect)(function(){var e=ye()().format("YYYY-MM-DD");a&&r!==e&&(d({type:n.RESET_POMODORO,payload:{pomodoro_date:e}}),Ra.changeMode(gt.FOCUS))},[d,a,r]),Object(c.useEffect)(function(){"denied"!==Notification.permission&&Notification.requestPermission(function(e){"granted"===e&&d({type:n.ALLOW_NOTIFICATION})})},[d]),Object(c.useEffect)(function(){var e=R===gt.FOCUS?"#f00":"#0f0",t=R===gt.FOCUS?"#fff":"#000",a=R===gt.FOCUS?"rectangle":"circle";switch(j){case Ct.RUNNING:Na.badge(v,{bgColor:e,textColor:t,type:a});break;case Ct.PAUSED:Na.badge("-",{bgColor:e,textColor:t,type:a});break;default:Na.reset()}},[R,v,j]),u?s.a.createElement(ne.a,{className:E()(Oa.a.top)},s.a.createElement(re.a,null,s.a.createElement("div",{className:"d-flex"},s.a.createElement(le.a,{className:E()(Oa.a.button_group)},s.a.createElement(pa.a,{isOpen:O,toggle:D,addonType:"prepend"},s.a.createElement(lt.a,{size:"sm",caret:!0},s.a.createElement(Ua,{mode:R})),s.a.createElement(ut.a,null,s.a.createElement(Ma,{mode:gt.FOCUS,onSelect:U}),s.a.createElement(Ma,{mode:gt.SHORT,onSelect:U}),s.a.createElement(Ma,{mode:gt.LONG,onSelect:U}))),s.a.createElement(ue.a,{addonType:"prepend"},s.a.createElement(Ke.a,{className:E()({"font-weight-bold":j===Ct.RUNNING})},v)),s.a.createElement(ue.a,{addonType:"prepend"},"min"),s.a.createElement(ue.a,{addonType:"append"},j===Ct.RUNNING?s.a.createElement(me.a,{color:"danger",onClick:M},s.a.createElement(w.a,{icon:F.v})):s.a.createElement(me.a,{color:"primary",onClick:M},s.a.createElement(w.a,{icon:F.w}))),R!==gt.FOCUS&&s.a.createElement(ue.a,{addonType:"append"},s.a.createElement(me.a,{color:"info",onClick:H,title:"Retry focusing"},s.a.createElement(w.a,{icon:F.y}),s.a.createElement(At,null)))),o>0&&s.a.createElement(ce.a,{color:"danger",className:"mr-2"},s.a.createElement(At,null)," ",s.a.createElement(w.a,{icon:F.D})," ",o),_.a.times(o).map(function(e){return s.a.createElement(At,{key:e,state:e<l?Tt.STALE:Tt.FRESH})})))):null},Ia=function(){return s.a.createElement("div",{className:"container"},s.a.createElement(u.a,{className:"toast-top"}),s.a.createElement(Pe.a,null,s.a.createElement(ae,null,s.a.createElement(xa,null),s.a.createElement(Ie,null),s.a.createElement(we.Route,{exact:!0,path:"/",component:oa}),s.a.createElement(we.Route,{exact:!0,path:"/:uid",component:Ea}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(Ia,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},70:function(e,t,a){e.exports={header:"UserStory_header__3lGFX",toggle_input:"UserStory_toggle_input__ARa5d",display_medal:"UserStory_display_medal__3t53K",medal:"UserStory_medal__2Zi1f",is_closed:"UserStory_is_closed__2ABQp"}}},[[244,1,2]]]);
//# sourceMappingURL=main.ba87c56b.chunk.js.map