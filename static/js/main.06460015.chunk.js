(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{116:function(e,t,a){e.exports={gold:"Hero_gold__22tvr",silver:"Hero_silver__3VD88",bronze:"Hero_bronze__2KzSy"}},144:function(e,t,a){e.exports={gold:"UserTasks_gold__1MP40",silver:"UserTasks_silver__GpK9Y",bronze:"UserTasks_bronze__1aHZc",custom_input_td:"UserTasks_custom_input_td__1JWmj"}},219:function(e,t,a){e.exports={header:"Controller_header__33lvE"}},234:function(e,t,a){e.exports=a.p+"static/media/tomato.c392a271.png"},263:function(e,t,a){e.exports=a(503)},268:function(e,t,a){},278:function(e,t,a){},503:function(e,t,a){"use strict";a.r(t);var n,r=a(1),c=a.n(r),o=a(33),s=a.n(o),l=(a(268),a(269),a(270),a(271),a(272),a(273),a(274),a(275),a(276),a(277),a(278),a(54)),u=a(13),i=a(5),m=a.n(i),_=a(2),d=a.n(_),E=a(11),p=a.n(E),O=a(19),f=a(18),T=a.n(f);!function(e){e.SET_TOKEN="SET_TOKEN",e.SET_TIMER_ID="SET_TIMER_ID",e.ADD_FB_TIMER="ADD_FB_TIMER",e.DEL_FB_TIMER="DEL_FB_TIMER",e.SET_URL="SET_URL",e.SIGN_IN="SIGN_IN",e.SET_AUTH_TOKEN="SET_AUTH_TOKEN",e.SET_AUTH_ERROR="SET_AUTH_ERROR",e.SIGN_OUT="SIGN_OUT",e.FETCH_PROJECTS="FETCH_PROJECTS",e.SET_PROJECTS="SET_PROJECTS",e.SET_PID="SET_PID",e.FETCH_PROJECT="FETCH_PROJECT",e.SET_PROJECT="SET_PROJECT",e.FETCH_MILESTONES="FETCH_MILESTONES",e.SET_MID="SET_MID",e.SET_MILESTONES="SET_MILESTONES",e.SET_MILESTONE="SET_MILESTONE",e.SET_CUSTOM_EID="SET_CUSTOM_EID",e.SET_CUSTOM_RID="SET_CUSTOM_RID",e.FETCH_CUSTOM_ATTRS="FETCH_CUSTOM_ATTRS",e.SET_CUSTOM_ATTRS="SET_CUSTOM_ATTRS",e.SET_CUSTOM_ATTR_E="SET_CUSTOM_ATTR_E",e.SET_CUSTOM_ATTR_R="SET_CUSTOM_ATTR_R",e.SET_BIZ_DAYS="SET_BIZ_DAYS",e.ADD_BIZ_DAY="ADD_BIZ_DAY",e.REMOVE_BIZ_DAY="REMOVE_BIZ_DAY",e.FETCH_TASKS="FETCH_TASKS",e.SET_TASKS="SET_TASKS",e.SET_TASK_ID="SET_TASK_ID",e.RESET_TASK_ID="RESET_TASK_ID",e.SET_TASK="SET_TASK",e.SET_USER_TASKS="SET_USER_TASKS",e.PATCH_TASK="PATCH_TASK",e.FETCH_TASK_STATUSES="FETCH_TASK_STATUSES",e.SET_TASK_STATUSES="SET_TASK_STATUSES",e.SET_ACTIVE_TASK_STATUSES="SET_ACTIVE_TASK_STATUSES",e.FETCH_CUSTOM_VALUE_MAP="FETCH_CUSTOM_VALUE_MAP",e.SET_CUSTOM_VALUE_MAP="SET_CUSTOM_VALUE_MAP",e.PATCH_CUSTOM_VALUE="PATCH_CUSTOM_VALUE",e.FETCH_USER="FETCH_USER",e.SET_USER="SET_USER",e.RESET_USER="RESET_USER",e.SET_REJECT_TASK_STATUS_IDS="SET_REJECT_TASK_STATUS_IDS",e.ADD_REJECT_TASK_STATUS_ID="ADD_REJECT_TASK_STATUS_ID",e.REMOVE_REJECT_TASK_STATUS_ID="REMOVE_REJECT_TASK_STATUS_ID",e.OPEN_CONTROLLER="OPEN_CONTROLLER",e.CLOSE_CONTROLLER="CLOSE_CONTROLLER",e.UPDATE_DATA="UPDATE_DATA",e.ADD_POMODORO="ADD_POMODORO",e.USE_POMODORO="USE_POMODORO",e.RESET_POMODORO="RESET_POMODORO",e.RESTORE_POMODORO="RESTORE_POMODORO",e.CALC_POMODORO_TOTAL="CALC_POMODORO_TOTAL",e.LOAD_POMODORO_TOTALS="LOAD_POMODORO_TOTALS",e.SET_POMODORO_TOTALS="SET_POMODORO_TOTALS",e.LOADED="LOADED",e.SET_POMODORO_STATE="SET_POMODORO_STATE",e.SET_POMODORO_MODE="SET_POMODORO_MODE",e.SET_TIMELIMIT_CLOSE_TASK="SET_TIMELIMIT_CLOSE_TASK",e.SET_IN_PROGRESS_TASK_STATUS_ID="SET_IN_PROGRESS_TASK_STATUS_ID",e.SET_POMODORO_LIVE_COUNT="SET_POMODORO_LIVE_COUNT"}(n||(n={}));var S,b,v,k=a(21),y=a(100),h=a(213),j=a(108),g=a(45),C=a(151),A=a(109),D=a(101);!function(e){e.STOPPED="stopped",e.RUNNING="running",e.PAUSED="paused"}(b||(b={})),function(e){e.FOCUS="Focusing",e.SHORT="Short break",e.LONG="Long break"}(v||(v={}));var R,M=(S={},Object(k.a)(S,v.FOCUS,25),Object(k.a)(S,v.SHORT,5),Object(k.a)(S,v.LONG,15),S);!function(e){e.STATE="pomodoro_state",e.MODE="pomodoro_mode",e.CHECKPOINT_START_AT="pomodoro_checkpoint_start_at",e.CHECKPOINT_ELAPSED="pomodoro_checkpoint_elapsed"}(R||(R={}));var I,N,x=new(function(e){function t(e){var a;return Object(y.a)(this,t),(a=Object(j.a)(this,Object(g.a)(t).call(this))).state=b.STOPPED,a.mode=v.FOCUS,a.duration=60*M[v.FOCUS],a.tick=60,a.checkpointStartAt=NaN,a.checkpointElapsed=0,a.expireTimeout=null,a.tickInterval=null,a.tickOffsetTimeout=null,a.restoreExpired=!1,a.estimateCompletedAt=new Date,a.tick=e,a.restoreStorage(),a}return Object(A.a)(t,e),Object(h.a)(t,[{key:"on",value:function(e,a){return Object(C.a)(Object(g.a)(t.prototype),"on",this).call(this,e,a)}},{key:"once",value:function(e,a){return Object(C.a)(Object(g.a)(t.prototype),"once",this).call(this,e,a)}},{key:"start",value:function(){this.isStopped&&(this.setExpireTimeout(this.duration),this.setTickInterval(this.tick),this.state=b.RUNNING,this.checkpointStartAt=Date.now(),this.checkpointElapsed=0,this.emit("start",this.status),this.saveStorage())}},{key:"stop",value:function(){this.isStopped||(this.clearExpireTimeout(),this.clearTickInterval(),this.checkpointStartAt=NaN,this.checkpointElapsed=0,this.state=b.STOPPED,this.emit("stop",this.status),this.saveStorage())}},{key:"pause",value:function(){if(this.isRunning){this.clearExpireTimeout(),this.clearTickInterval();var e=(Date.now()-this.checkpointStartAt)/1e3;this.checkpointElapsed+=e,this.state=b.PAUSED,this.emit("pause",this.status),this.saveStorage()}}},{key:"resume",value:function(){this.isPaused&&(this.setExpireTimeout(this.remaining),this.setTickInterval(this.tick),this.state=b.RUNNING,this.checkpointStartAt=Date.now(),this.emit("resume",this.status),this.saveStorage())}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"changeMode",value:function(e){this.stop(),this.mode=e,this.duration=60*M[e],this.emit("change_mode",this.status),this.saveStorage()}},{key:"setExpireTimeout",value:function(e){var t=this;this.expireTimeout=setTimeout(function(){t.emit("expire",t.status),t.stop()},1e3*e)}},{key:"clearExpireTimeout",value:function(){this.expireTimeout&&clearTimeout(this.expireTimeout),this.expireTimeout=null}},{key:"setTickInterval",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,r=this.status.remaining;if(r<=n)this.setSecTickInterval();else{var c=r%e;c>1&&!a?this.tickOffsetTimeout=setTimeout(function(){t.emit("tick",t.status),t.setTickInterval(e,!0)},1e3*c):this.tickInterval=setInterval(function(){var e=t.status;t.emit("tick",e),e.remaining<n&&(t.clearTickInterval(),t.setSecTickInterval())},1e3*e)}}},{key:"setSecTickInterval",value:function(){var e=this;this.tickInterval=setInterval(function(){e.emit("tick",e.status)},1e3)}},{key:"clearTickInterval",value:function(){this.tickInterval&&clearInterval(this.tickInterval),this.tickInterval=null,this.tickOffsetTimeout&&clearTimeout(this.tickOffsetTimeout),this.tickOffsetTimeout=null}},{key:"saveStorage",value:function(){localStorage.setItem(R.STATE,this.state),localStorage.setItem(R.MODE,this.mode),localStorage.setItem(R.CHECKPOINT_START_AT,Number.isNaN(this.checkpointStartAt)?"":String(this.checkpointStartAt)),localStorage.setItem(R.CHECKPOINT_ELAPSED,String(this.checkpointElapsed))}},{key:"restoreStorage",value:function(){var e,t=localStorage.getItem(R.STATE),a=localStorage.getItem(R.MODE),n=localStorage.getItem(R.CHECKPOINT_START_AT),r=localStorage.getItem(R.CHECKPOINT_ELAPSED);if(e=t,m.a.includes(m.a.values(b),e)&&function(e){return m.a.includes(m.a.values(v),e)}(a)){var c=t,o=a,s=60*M[o];switch(c){case b.STOPPED:this.changeMode(o);break;case b.PAUSED:var l=Number(r);l<1e3*s&&(this.state=c,this.mode=o,this.duration=s,this.checkpointElapsed=l);break;case b.RUNNING:var u=Number(n),i=Number(r);if(u>0)this.mode=o,this.duration=s,Date.now()-u+1e3*i<1e3*s?(this.state=b.RUNNING,this.checkpointStartAt=u,this.checkpointElapsed=i,this.setExpireTimeout(this.remaining),this.setTickInterval(this.tick)):(this.stop(),this.estimateCompletedAt=new Date(u+1e3*(s-i)),this.restoreExpired=!0)}}}},{key:"isStopped",get:function(){return this.state===b.STOPPED}},{key:"isRunning",get:function(){return this.state===b.RUNNING}},{key:"isPaused",get:function(){return this.state===b.PAUSED}},{key:"remaining",get:function(){return Math.max(this.duration-this.elapsed,0)}},{key:"elapsed",get:function(){var e=0;return this.checkpointStartAt&&this.isRunning&&(e=(Date.now()-this.checkpointStartAt)/1e3),this.checkpointElapsed+e}},{key:"status",get:function(){return{state:this.state,duration:this.duration,elapsed:this.elapsed,remaining:this.remaining,checkpointElapsed:this.checkpointElapsed,checkpointStartAt:this.checkpointStartAt,mode:this.mode}}}]),t}(D.EventEmitter))(60);!function(e){e.URL="taiga_url",e.TIMER_ID="taiga_timer_id",e.PID="taiga_pid",e.MID="taiga_mid",e.TASK_ID="taiga_task_id",e.CUSTOM_EID="taiga_custom_eid",e.CUSTOM_RID="taiga_custom_rid",e.BIZ_DAYS="taiga_biz_days",e.REJECT_TASK_STATUS_IDS="reject_task_status_ids",e.USERNAME="taiga_username",e.PASSWORD="taiga_password",e.POMODORO_DATE="taiga_pomodoro_date",e.POMODORO_NUMBER="taiga_pomodoro_number",e.POMODORO_USED_NUMBER="taiga_pomodoro_used_number",e.TIMELIMIT_CLOSE_TASK="taiga_timelimit_close_task"}(N||(N={}));var U=function(e){return localStorage.getItem(e)||""},P=function(e){return U(e)},L=function(e,t){return t?U("".concat(t,"/").concat(e)):""},K=function(e,t){localStorage.setItem(e,t)},w=function(e,t,a){return t?K("".concat(t,"/").concat(e),a):null},F={token:null,timer_id:null,url:"",auth_token:"",auth_error:!1,username:"",password:"",user:null,projects:[],pid:"",project:{},mid:"",custom_eid:"",custom_rid:"",custom_attrs:[],custom_attr_e:{},custom_attr_r:{},biz_days:[],milestones:[],milestone:{},tasks:[],task_id:"",task:null,user_tasks:[],task_statuses:[],active_task_statuses:[],custom_value_map:new WeakMap,reject_task_status_ids:[],updated_time:0,isOpen:!1,pomodoro_date:"",pomodoro_number:0,pomodoro_used_number:0,loaded:!1,pomodoro_daily_totals:[],pomodoro_state:b.STOPPED,pomodoro_mode:v.FOCUS,timelimit_close_task:"",in_progress_task_status_id:"",pomodoro_live_counts:(I={},Object(k.a)(I,v.FOCUS,0),Object(k.a)(I,v.SHORT,0),Object(k.a)(I,v.LONG,0),I)},H=a(39),Y=a(10),B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.SET_TOKEN:var a=t.payload.token;return Object(Y.a)({},e,{token:a});case n.SET_TIMER_ID:var r=t.payload.timer_id;return Object(Y.a)({},e,{timer_id:r});case n.SET_URL:var c=t.payload.url;return Object(Y.a)({},e,{url:c});case n.SET_PROJECTS:var o=t.payload.projects;return Object(Y.a)({},e,{projects:o});case n.SET_PID:var s=t.payload.pid;return Object(Y.a)({},e,{pid:s,project:{},mid:"",biz_days:[],custom_attrs:[],milestones:[],custom_value_map:new WeakMap});case n.SET_PROJECT:var l=t.payload.project;return Object(Y.a)({},e,{project:l});case n.SET_MID:var u=t.payload.mid;return Object(Y.a)({},e,{mid:u,milestone:{},tasks:[]});case n.SET_MILESTONES:var i=t.payload.milestones;return Object(Y.a)({},e,{milestones:i});case n.SET_MILESTONE:var _=t.payload.milestone;return Object(Y.a)({},e,{milestone:_});case n.SET_CUSTOM_EID:var d=t.payload.custom_eid;return Object(Y.a)({},e,{custom_eid:d});case n.SET_CUSTOM_ATTRS:var E=t.payload.custom_attrs;return Object(Y.a)({},e,{custom_attrs:E});case n.SET_CUSTOM_ATTR_E:var p=t.payload.custom_attr_e;return Object(Y.a)({},e,{custom_attr_e:p});case n.SET_CUSTOM_ATTR_R:var O=t.payload.custom_attr_r;return Object(Y.a)({},e,{custom_attr_r:O});case n.SET_CUSTOM_RID:var f=t.payload.custom_rid;return Object(Y.a)({},e,{custom_rid:f});case n.SET_BIZ_DAYS:var T=t.payload.biz_days;return Object(Y.a)({},e,{biz_days:T});case n.ADD_BIZ_DAY:var S=t.payload.biz_day,b=m.a.chain([].concat(Object(H.a)(e.biz_days),[S])).uniq().sort().value();return Object(Y.a)({},e,{biz_days:b});case n.REMOVE_BIZ_DAY:var v=t.payload.biz_day,y=m.a.reject(Object(H.a)(e.biz_days),function(e){return e===v});return Object(Y.a)({},e,{biz_days:y});case n.SET_TASKS:var h=t.payload.tasks;return Object(Y.a)({},e,{tasks:h});case n.SET_TASK_ID:var j=t.payload.task_id;return Object(Y.a)({},e,{task_id:j,task:null});case n.RESET_TASK_ID:return Object(Y.a)({},e,{task_id:"",task:null});case n.SET_TASK:var g=t.payload.task;return Object(Y.a)({},e,{task:g});case n.SET_USER_TASKS:var C=t.payload.user_tasks;return Object(Y.a)({},e,{user_tasks:C});case n.SET_TASK_STATUSES:var A=t.payload.task_statuses;return Object(Y.a)({},e,{task_statuses:A});case n.SET_ACTIVE_TASK_STATUSES:var D=t.payload.active_task_statuses;return Object(Y.a)({},e,{active_task_statuses:D});case n.SET_CUSTOM_VALUE_MAP:var R=t.payload.custom_value_map;return Object(Y.a)({},e,{custom_value_map:R});case n.SET_USER:var M=t.payload.user;return Object(Y.a)({},e,{user:M});case n.RESET_USER:return Object(Y.a)({},e,{user:null,user_tasks:[]});case n.SET_REJECT_TASK_STATUS_IDS:var I=t.payload.reject_task_status_ids;return Object(Y.a)({},e,{reject_task_status_ids:I});case n.ADD_REJECT_TASK_STATUS_ID:var N=t.payload.reject_task_status_id,x=m.a.chain([].concat(Object(H.a)(e.reject_task_status_ids),[N])).compact().uniq().value();return Object(Y.a)({},e,{reject_task_status_ids:x});case n.REMOVE_REJECT_TASK_STATUS_ID:var U=t.payload.reject_task_status_id,P=m.a.reject(Object(H.a)(e.reject_task_status_ids),function(e){return e===U});return Object(Y.a)({},e,{reject_task_status_ids:P});case n.OPEN_CONTROLLER:return Object(Y.a)({},e,{isOpen:!0});case n.CLOSE_CONTROLLER:return Object(Y.a)({},e,{isOpen:!1});case n.UPDATE_DATA:return Object(Y.a)({},e,{updated_time:Date.now()});case n.SIGN_IN:var L=t.payload,K=L.username,w=L.password;return Object(Y.a)({},e,{username:K,password:w,auth_error:!1});case n.SET_AUTH_TOKEN:var B=t.payload.auth_token;return Object(Y.a)({},e,{auth_token:B});case n.SET_AUTH_ERROR:return Object(Y.a)({},e,{auth_error:!0});case n.SIGN_OUT:return Object(Y.a)({},e,{auth_token:"",username:"",password:""});case n.ADD_POMODORO:var z=e.pomodoro_number+1;return Object(Y.a)({},e,{pomodoro_number:z});case n.USE_POMODORO:var V=t.payload.used_number,G=Math.max(0,e.pomodoro_used_number+V);return Object(Y.a)({},e,{pomodoro_used_number:G});case n.RESET_POMODORO:var J=t.payload.pomodoro_date;return Object(Y.a)({},e,{pomodoro_number:0,pomodoro_used_number:0,pomodoro_date:J});case n.RESTORE_POMODORO:var Z=t.payload,W=Z.pomodoro_date,q=Z.pomodoro_number,Q=Z.pomodoro_used_number;return Object(Y.a)({},e,{pomodoro_date:W,pomodoro_number:q,pomodoro_used_number:Q});case n.SET_POMODORO_TOTALS:var X=t.payload.pomodoro_daily_totals;return Object(Y.a)({},e,{pomodoro_daily_totals:X});case n.LOADED:return Object(Y.a)({},e,{loaded:!0});case n.SET_POMODORO_STATE:var $=t.payload.pomodoro_state;return Object(Y.a)({},e,{pomodoro_state:$});case n.SET_POMODORO_MODE:var ee=t.payload.pomodoro_mode;return Object(Y.a)({},e,{pomodoro_mode:ee});case n.SET_TIMELIMIT_CLOSE_TASK:var te=t.payload.timelimit_close_task;return Object(Y.a)({},e,{timelimit_close_task:te});case n.SET_IN_PROGRESS_TASK_STATUS_ID:var ae=t.payload.task_status_id;return Object(Y.a)({},e,{in_progress_task_status_id:ae});case n.SET_POMODORO_LIVE_COUNT:var ne=t.payload,re=ne.mode,ce=ne.value;return Object(Y.a)({},e,{pomodoro_live_counts:Object(Y.a)({},e.pomodoro_live_counts,Object(k.a)({},re,ce))});default:return e}},z=function(e,t,a,n){return function(r){t(r),a(r,n,e)}},V=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c=r(),!(o=c.url)){e.next=8;break}return e.next=5,De(o,"projects");case 5:s=e.sent,l=s.data,a({type:n.SET_PROJECTS,payload:{projects:l}});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),Ie(e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t,a,n){return e.apply(this,arguments)}}(),G=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_PROJECT){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.pid,!o||!s){e.next=10;break}return e.next=7,De(o,"projects/".concat(s));case 7:l=e.sent,u=l.data,a({type:n.SET_PROJECT,payload:{project:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Ie(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),J=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_MILESTONES){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.project,!o||!s){e.next=10;break}return e.next=7,De(o,"milestones",{params:{project:s}});case 7:l=e.sent,u=l.data,a({type:n.SET_MILESTONES,payload:{milestones:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Ie(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Z=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u,i,_,d,E,O;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_TASKS){e.next=17;break}if(e.prev=1,c=r(),o=c.url,s=t.payload,l=s.milestone,u=s.reject_task_status_ids,i=s.timelimit_close_task,!(o&&l&&i)){e.next=12;break}return _=T()(i),e.next=8,De(o,"tasks",{headers:{"x-disable-pagination":!0},params:{milestone:l}});case 8:d=e.sent,E=d.data,O=m.a.chain(E).reject(function(e){return m.a.includes(u,String(e.status))}).reject(function(e){return e.is_closed&&T()(e.finished_date).diff(_)<0}).value(),a({type:n.SET_TASKS,payload:{tasks:O}});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),Ie(e.t0);case 17:case"end":return e.stop()}},e,null,[[1,14]])}));return function(t,a,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_TASK_STATUSES){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.project,!o||!s){e.next=10;break}return e.next=7,De(o,"task-statuses",{params:{project:s}});case 7:l=e.sent,u=l.data,a({type:n.SET_TASK_STATUSES,payload:{task_statuses:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Ie(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),q=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_CUSTOM_ATTRS){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.project,!o||!s){e.next=10;break}return e.next=7,De(o,"task-custom-attributes",{params:{project:s}});case 7:l=e.sent,u=l.data,a({type:n.SET_CUSTOM_ATTRS,payload:{custom_attrs:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Ie(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),Q=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_CUSTOM_VALUE_MAP){e.next=16;break}if(e.prev=1,c=r(),o=c.url,s=c.custom_eid,l=c.custom_rid,u=t.payload.tasks,!(o&&u.length&&s&&l)){e.next=11;break}return e.t0=WeakMap,e.next=8,Promise.all(u.map(function(){var e=Object(O.a)(p.a.mark(function e(t){var a,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De(o,"tasks/custom-attributes-values/".concat(t.id));case 2:return a=e.sent,n=a.data,e.abrupt("return",[t,n]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 8:e.t1=e.sent,i=new e.t0(e.t1),a({type:n.SET_CUSTOM_VALUE_MAP,payload:{custom_value_map:i}});case 11:e.next=16;break;case 13:e.prev=13,e.t2=e.catch(1),Ie(e.t2);case 16:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t,a,n){return e.apply(this,arguments)}}(),X=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_USER){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.uid,!o||!s){e.next=10;break}return e.next=7,De(o,"users/".concat(s));case 7:l=e.sent,u=l.data,a({type:n.SET_USER,payload:{user:u}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Ie(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),$=a(12),ee=a(9),te=function(e){var t=e.icon,a=e.message;return c.a.createElement("div",{className:"d-flex"},c.a.createElement("h2",{className:"mr-2"},c.a.createElement($.a,{icon:t})),c.a.createElement("div",null,a))},ae=function(e){var t=e.title,a=e.body,n=e.icon;return c.a.createElement("div",{className:"d-flex"},c.a.createElement("img",{src:n,style:{width:"48px",height:"48px"},alt:""}),c.a.createElement("div",{className:"ml-2"},c.a.createElement("h5",null,t),c.a.createElement("p",null,a)))},ne=function(e){l.b.success(c.a.createElement(te,{icon:ee.d,message:e}))},re=function(e){l.b.error(c.a.createElement(te,{icon:ee.e,message:e}))},ce=function(e){var t=e.title,a=e.body,n=e.icon;Object(l.b)(c.a.createElement(ae,{title:t,body:a,icon:n}))},oe=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u,i,m,_,d,E,O,f,T,S;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.PATCH_CUSTOM_VALUE){e.next=20;break}if(e.prev=1,c=r(),o=c.url,s=c.custom_value_map,l=c.tasks,u=c.in_progress_task_status_id,i=t.payload,m=i.id,_=i.key,d=i.value,E=i.version,O=l.find(function(e){return e.id===m}),!(o&&m&&_&&O&&s.has(O))){e.next=15;break}if(!(f=s.get(O))){e.next=15;break}return T=f.attributes_values,e.next=11,Me(o,"tasks/custom-attributes-values/".concat(m),{attributes_values:Object(Y.a)({},T,Object(k.a)({},_,String(d))),version:E});case 11:t.meta&&t.meta.update_status&&d>0&&u&&!O.is_closed&&O.status!==Number(u)&&a({type:n.PATCH_TASK,payload:{key:"status",value:u,id:O.id}}),t.meta&&t.meta.use_pomodoro&&(S=t.meta.use_pomodoro.used_number,a({type:n.USE_POMODORO,payload:{used_number:S}})),a({type:n.UPDATE_DATA}),ne("Custom value updated. [".concat(d,"]"));case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),Ie(e.t0);case 20:case"end":return e.stop()}},e,null,[[1,17]])}));return function(t,a,n){return e.apply(this,arguments)}}(),se=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u,i,m,_,d;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.PATCH_TASK){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=c.tasks,l=t.payload,u=l.id,i=l.key,m=l.value,_=s.find(function(e){return e.id===u}),!(o&&u&&i&&_)){e.next=10;break}return e.next=8,Me(o,"tasks/".concat(u),(d={},Object(k.a)(d,i,m),Object(k.a)(d,"version",_.version),d));case 8:a({type:n.UPDATE_DATA}),ne("Task updated. [".concat(i,"=").concat(m,"]"));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Ie(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),le=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u,i,_;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.SIGN_IN){e.next=20;break}if(e.prev=1,c=r(),o=c.url,s=t.payload,l=s.username,u=s.password,!(o&&l&&u)){e.next=13;break}return e.next=7,Re(o,"auth",{username:l,password:u,type:"normal"});case 7:i=e.sent,_=i.data.auth_token,a({type:n.SET_AUTH_TOKEN,payload:{auth_token:_}}),K(N.USERNAME,l),K(N.PASSWORD,u),ne("".concat(l," signed in."));case 13:e.next=20;break;case 15:e.prev=15,e.t0=e.catch(1),a({type:n.SET_AUTH_ERROR}),m.a.get(e.t0,"response.data._err_message")&&a({type:n.SIGN_OUT}),Ie(e.t0);case 20:case"end":return e.stop()}},e,null,[[1,15]])}));return function(t,a,n){return e.apply(this,arguments)}}(),ue=a(46),ie=a.n(ue),me=function(e,t,a){m.a.defer(function(){var e=a(),t=e.pomodoro_date,n=e.pomodoro_number,r=e.pomodoro_used_number;K(N.POMODORO_DATE,t),K(N.POMODORO_NUMBER,String(n)),K(N.POMODORO_USED_NUMBER,String(r))})},_e=new(function(e){function t(){var e;return Object(y.a)(this,t),(e=Object(j.a)(this,Object(g.a)(t).call(this,"TaigaPomodoroDatabase"))).items=void 0,e.totals=void 0,e.version(1).stores({items:"++id, completedAt, duration, pure, dateKey",totals:"++id, date, value, pureValue, &dateKey, dayOfWeek"}),e.items=e.table("items"),e.totals=e.table("totals"),e}return Object(A.a)(t,e),t}(a(214).a)),de=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u,i,_,d,E,O,f,S,b;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.ADD_POMODORO||!t.meta){e.next=15;break}return c=r(),o=c.url,s=c.task_id,l=c.custom_rid,u=t.meta,i=u.completedAt,_=u.duration,d=u.pure,E=T()(i).format("YYYY-MM-DD"),e.next=6,_e.items.put({completedAt:i,duration:_,pure:d,dateKey:E});case 6:if(a({type:n.CALC_POMODORO_TOTAL,payload:{dateKey:E}}),!s||!l){e.next=15;break}return e.next=10,De(o,"tasks/custom-attributes-values/".concat(s));case 10:O=e.sent,f=O.data,S=Number(m.a.get(f,"attributes_values.".concat(l),"0"))+.5,b=f.version,f&&b&&a({type:n.PATCH_CUSTOM_VALUE,payload:{id:Number(s),key:l,value:S,version:b},meta:{use_pomodoro:{used_number:1},update_status:!0}});case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u,i,_;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.CALC_POMODORO_TOTAL){e.next=14;break}return c=t.payload,e.next=4,_e.totals.get(c);case 4:return o=e.sent,e.next=7,_e.items.where(c).toArray();case 7:s=e.sent,l=s.length,u=m.a.filter(s,{pure:!0}).length,i=T()(c.dateKey,"YYYY-MM-DD").day(),_=T()(c.dateKey,"YYYY-MM-DD").toDate(),_e.totals.put(Object(Y.a)({},o,c,{date:_,value:l,pureValue:u,dayOfWeek:i})),a({type:n.LOAD_POMODORO_TOTALS});case 14:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),pe=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.totals.toArray();case 2:c=e.sent,a({type:n.SET_POMODORO_TOTALS,payload:{pomodoro_daily_totals:c}});case 4:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),Oe=a(215),fe=a.n(Oe),Te=a(110),Se=a.n(Te);a(504),a(304);fe.a.config();var be=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_apiKey:"AIzaSyDscSWT2haNjkDvdx29dz1mIxX0LX3PLJM",REACT_APP_authDomain:"taiga-ext.firebaseapp.com",REACT_APP_databaseURL:"https://taiga-ext.firebaseio.com",REACT_APP_projectId:"taiga-ext",REACT_APP_storageBucket:"taiga-ext.appspot.com",REACT_APP_messagingSenderId:"670370401412",REACT_APP_appId:"1:670370401412:web:c1a69635a444ff4f",REACT_APP_VapidKey:"BOOlMIIx0P4qjkh4KEwpEunUeeuVvaYelqqcsUGnimb7LBc6GyDECYhUwe7vCdJEDDiNExg-annFh4kXrqiIank"}),ve=be.REACT_APP_apiKey,ke=be.REACT_APP_VapidKey,ye={apiKey:ve,authDomain:be.REACT_APP_authDomain,databaseURL:be.REACT_APP_databaseURL,projectId:be.REACT_APP_projectId,storageBucket:be.REACT_APP_storageBucket,messagingSenderId:be.REACT_APP_messagingSenderId,appId:be.REACT_APP_appId};Se.a.initializeApp(ye);var he=Se.a.messaging();navigator.serviceWorker.register("./firebase-messaging-sw.js").then(function(e){m.a.get(he,"registrationToUse")||he.useServiceWorker(e),he.usePublicVapidKey(ke||""),he.onTokenRefresh(Object(O.a)(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he.getToken();case 2:e.sent;case 3:case"end":return e.stop()}},e)}))),he.getToken().then(function(e){e})});var je=Se.a.firestore().collection("timers");he.requestPermission().then(function(){console.log("Notification permission granted.")}).catch(function(e){console.log("Unable to get permission to notify.",e)});var ge=function(){var e=Object(O.a)(p.a.mark(function e(t,a,n,r,c){var o,s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je.add({title:t,body:a,remaining:n,token:r,icon:"./tomato.png",click_action:window.location.href,mode:c});case 2:return o=e.sent,s=o.id,e.abrupt("return",s);case 5:case"end":return e.stop()}},e)}));return function(t,a,n,r,c){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(O.a)(p.a.mark(function e(t,a,r){var c,o,s,l,u,i,m,_;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.ADD_FB_TIMER){e.next=8;break}if(c=r(),o=c.token,s=c.pomodoro_mode,l=t.payload,u=l.title,i=l.body,m=l.remaining,!o){e.next=8;break}return e.next=6,ge(u,i,m,o,s);case 6:_=e.sent,a({type:n.SET_TIMER_ID,payload:{timer_id:_}});case 8:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),Ae=function(e,t,a){if(e.type===n.DEL_FB_TIMER){var r=a().timer_id;r&&(c=r,je.doc(c).delete(),t({type:n.SET_TIMER_ID,payload:{timer_id:null}}))}var c},De=function(e,t,a){return ie.a.get("".concat(Ue(e),"/").concat(t),a)},Re=function(e,t,a,n){return ie.a.post("".concat(Ue(e),"/").concat(t),a,n)},Me=function(e,t,a,n){return ie.a.patch("".concat(Ue(e),"/").concat(t),a,n)},Ie=function(e){var t;try{t=e.response?e.response.data._error_message:"error"}catch(a){t=a.message||a}re(t)},Ne=function(e,t,a){switch(e.type){case n.FETCH_PROJECTS:return void V(e,t,a);case n.FETCH_PROJECT:return void G(e,t,a);case n.FETCH_MILESTONES:return void J(e,t,a);case n.FETCH_TASKS:return void Z(e,t,a);case n.FETCH_TASK_STATUSES:return void W(e,t,a);case n.FETCH_CUSTOM_ATTRS:return void q(e,t,a);case n.FETCH_CUSTOM_VALUE_MAP:return void Q(e,t,a);case n.FETCH_USER:return void X(e,t,a);case n.PATCH_CUSTOM_VALUE:return void oe(e,t,a);case n.SIGN_IN:return void le(e,t,a);case n.PATCH_TASK:return void se(e,t,a);case n.SIGN_OUT:return localStorage.removeItem(N.USERNAME),localStorage.removeItem(N.PASSWORD),void(ie.a.defaults.headers.common.Authorization&&delete ie.a.defaults.headers.common.Authorization);case n.SET_AUTH_TOKEN:return void function(e,t,a){if(e.type===n.SET_AUTH_TOKEN){var r=e.payload.auth_token;ie.a.defaults.headers.common.Authorization="Bearer ".concat(r)}}(e);case n.SET_URL:return void function(e,t,a){if(e.type===n.SET_URL){var r=e.payload.url;K(N.URL,r)}}(e);case n.SET_PID:!function(e,t,a){if(e.type===n.SET_PID){var r=e.payload.pid;K(N.PID,r),localStorage.removeItem(N.MID);var c=L(N.CUSTOM_EID,r),o=L(N.CUSTOM_RID,r);t({type:n.SET_CUSTOM_EID,payload:{custom_eid:c}}),t({type:n.SET_CUSTOM_RID,payload:{custom_rid:o}})}}(e,t);break;case n.SET_MID:!function(e,t,a){if(e.type===n.SET_MID){var r=e.payload.mid,c=a().mid;K(N.MID,r);var o=m.a.compact(L(N.BIZ_DAYS,r).split(",")).sort();t({type:n.SET_BIZ_DAYS,payload:{biz_days:o}}),c&&r!==c&&t({type:n.RESET_TASK_ID});var s=L(N.TIMELIMIT_CLOSE_TASK,r);t({type:n.SET_TIMELIMIT_CLOSE_TASK,payload:{timelimit_close_task:s}})}}(e,t,a);break;case n.SET_CUSTOM_EID:!function(e,t,a){if(e.type===n.SET_CUSTOM_EID){var r=e.payload.custom_eid,c=P(N.PID);w(N.CUSTOM_EID,c,r)}}(e);break;case n.SET_CUSTOM_RID:!function(e,t,a){if(e.type===n.SET_CUSTOM_RID){var r=e.payload.custom_rid,c=P(N.PID);w(N.CUSTOM_RID,c,r)}}(e);break;case n.SET_BIZ_DAYS:case n.ADD_BIZ_DAY:case n.REMOVE_BIZ_DAY:!function(e,t,a){m.a.defer(function(){var e=a(),t=e.mid,n=e.biz_days;w(N.BIZ_DAYS,t,n.join(","))})}(0,0,a);break;case n.ADD_REJECT_TASK_STATUS_ID:case n.REMOVE_REJECT_TASK_STATUS_ID:!function(e,t,a){m.a.defer(function(){var e=a(),t=e.pid,n=e.reject_task_status_ids;w(N.REJECT_TASK_STATUS_IDS,t,n.join(","))})}(0,0,a);break;case n.ADD_POMODORO:de(e,t,a),me(0,0,a);break;case n.USE_POMODORO:case n.RESET_POMODORO:me(0,0,a);break;case n.CALC_POMODORO_TOTAL:Ee(e,t,a);break;case n.LOAD_POMODORO_TOTALS:pe(e,t,a);break;case n.SET_TASK_ID:case n.RESET_TASK_ID:!function(e,t,a){m.a.defer(function(){var e=a().task_id;e?K(N.TASK_ID,e):localStorage.removeItem(N.TASK_ID)})}(0,0,a);break;case n.SET_TIMELIMIT_CLOSE_TASK:!function(e,t,a){if(e.type===n.SET_TIMELIMIT_CLOSE_TASK){var r=e.payload.timelimit_close_task,c=!!e.meta&&e.meta.customize,o=a().mid;r&&c&&w(N.TIMELIMIT_CLOSE_TASK,o,r)}}(e,0,a);break;case n.ADD_FB_TIMER:Ce(e,t,a);break;case n.DEL_FB_TIMER:Ae(e,t,a);break;case n.SET_TIMER_ID:!function(e,t,a){if(e.type===n.SET_TIMER_ID){var r=e.payload.timer_id;r?K(N.TIMER_ID,r):localStorage.removeItem(N.TIMER_ID)}}(e)}},xe=function(e){!function(e){var t=P(N.URL),a=P(N.TIMER_ID),r=P(N.PID),c=P(N.MID),o=L(N.CUSTOM_EID,r),s=L(N.CUSTOM_RID,r),l=m.a.compact(L(N.BIZ_DAYS,c).split(",")).sort(),u=m.a.compact(L(N.REJECT_TASK_STATUS_IDS,r).split(",")),i=!(t&&r&&c&&o&&s),_=P(N.POMODORO_DATE),d=Number(P(N.POMODORO_NUMBER)||"0"),E=Number(P(N.POMODORO_USED_NUMBER)||"0"),p=P(N.TASK_ID);a&&e({type:n.SET_TIMER_ID,payload:{timer_id:a}}),t&&e({type:n.SET_URL,payload:{url:t}}),r&&e({type:n.SET_PID,payload:{pid:r}}),c&&e({type:n.SET_MID,payload:{mid:c}}),o&&e({type:n.SET_CUSTOM_EID,payload:{custom_eid:o}}),s&&e({type:n.SET_CUSTOM_RID,payload:{custom_rid:s}}),l.length&&e({type:n.SET_BIZ_DAYS,payload:{biz_days:l}}),u.length&&e({type:n.SET_REJECT_TASK_STATUS_IDS,payload:{reject_task_status_ids:u}}),p&&e({type:n.SET_TASK_ID,payload:{task_id:p}}),i&&e({type:n.OPEN_CONTROLLER}),_&&e({type:n.RESTORE_POMODORO,payload:{pomodoro_date:_,pomodoro_number:d,pomodoro_used_number:E}}),e({type:n.LOADED}),e({type:n.LOAD_POMODORO_TOTALS})}(e),m.a.defer(function(){!function(e){var t=P(N.USERNAME),a=P(N.PASSWORD);e({type:n.SIGN_IN,payload:{username:t,password:a}})}(e)})},Ue=function(e){return"".concat(e.replace(/[\xa5\/]$/,""),"/api/v1")},Pe=function(e,t){return m.a.find(e,{id:t})},Le=Object(r.createContext)({state:F,dispatch:function(e){}}),Ke=function(e){var t=e.children,a=function(e,t){var a=Object(u.a)(e,2),n=a[0],c=a[1],o=null,s=Object(r.useCallback)(function(e){o&&o(e)},[o]),l=Object(r.useMemo)(function(){return function(){var e;return{getter:function(){return e},setter:function(t){e=t}}}()},[]);return l.setter(n),[n,o=Object(r.useCallback)(z(l.getter,c,t,s),[])]}(Object(r.useReducer)(B,F),Ne),o=Object(u.a)(a,2),s=o[0],l=o[1],i={state:s,dispatch:l};return Object(r.useEffect)(function(){s.url&&l({type:n.FETCH_PROJECTS})},[l,s.url]),Object(r.useEffect)(function(){s.url&&s.pid&&(l({type:n.FETCH_MILESTONES,payload:{project:s.pid}}),l({type:n.FETCH_CUSTOM_ATTRS,payload:{project:s.pid}}),l({type:n.FETCH_TASK_STATUSES,payload:{project:s.pid}}),l({type:n.FETCH_PROJECT,payload:{pid:s.pid}}))},[s.url,s.pid,l]),Object(r.useEffect)(function(){s.url&&s.mid&&s.milestone.id&&s.timelimit_close_task&&l({type:n.FETCH_TASKS,payload:{milestone:s.mid,reject_task_status_ids:s.reject_task_status_ids,timelimit_close_task:s.timelimit_close_task}})},[s.url,s.mid,s.updated_time,s.reject_task_status_ids,l,s.milestone.id,s.timelimit_close_task]),Object(r.useEffect)(function(){l({type:n.FETCH_CUSTOM_VALUE_MAP,payload:{tasks:s.tasks}})},[l,s.tasks,s.custom_eid,s.custom_rid]),Object(r.useEffect)(function(){var e=m.a.chain(s.task_statuses).reject(function(e){return m.a.includes(s.reject_task_status_ids,String(e.id))}).orderBy(function(e){return e.order}).value();l({type:n.SET_ACTIVE_TASK_STATUSES,payload:{active_task_statuses:e}})},[s.task_statuses,s.reject_task_status_ids,l]),Object(r.useEffect)(function(){var e=Pe(s.custom_attrs,Number(s.custom_eid));e&&l({type:n.SET_CUSTOM_ATTR_E,payload:{custom_attr_e:e}})},[l,s.custom_attrs,s.custom_eid]),Object(r.useEffect)(function(){var e=Pe(s.custom_attrs,Number(s.custom_rid));e&&l({type:n.SET_CUSTOM_ATTR_R,payload:{custom_attr_r:e}})},[l,s.custom_attrs,s.custom_rid]),Object(r.useEffect)(function(){var e,t,a=(e=s.milestones,t=s.mid,e.find(function(e){return String(e.id)===t}));a&&l({type:n.SET_MILESTONE,payload:{milestone:a}})},[l,s.mid,s.milestones]),Object(r.useEffect)(function(){if(s.tasks.length>0&&s.user){var e=(t=s.tasks,a=s.user.id,m.a.chain(t).filter({assigned_to:a}).sortBy("user_story").value());l({type:n.SET_USER_TASKS,payload:{user_tasks:e}})}var t,a},[l,s.tasks,s.user]),Object(r.useEffect)(function(){xe(l)},[l]),Object(r.useEffect)(function(){if(s.task_id){var e=s.tasks.find(function(e){return e.id===Number(s.task_id)});e&&l({type:n.SET_TASK,payload:{task:e}})}},[l,s.task_id,s.tasks]),Object(r.useEffect)(function(){var e=s.biz_days[0];if(e&&!s.timelimit_close_task){var t="".concat(T()(e).local().startOf("day").format("YYYY-MM-DD"),"T12:00");l({type:n.SET_TIMELIMIT_CLOSE_TASK,payload:{timelimit_close_task:t}})}},[l,s.biz_days,s.milestone,s.timelimit_close_task]),Object(r.useEffect)(function(){if(s.task_statuses.length>0){var e=s.task_statuses.find(function(e){return"in-progress"===e.slug});e&&l({type:n.SET_IN_PROGRESS_TASK_STATUS_ID,payload:{task_status_id:String(e.id)}})}},[l,s.task_statuses,s.task_statuses.length]),Object(r.useEffect)(function(){he.onTokenRefresh(Object(O.a)(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he.getToken();case 2:t=e.sent,l({type:n.SET_TOKEN,payload:{token:t}});case 4:case"end":return e.stop()}},e)}))),he.getToken().then(function(e){l({type:n.SET_TOKEN,payload:{token:e}})})},[l]),Object(r.useEffect)(function(){Object.values(v).forEach(function(e){je.where("mode","==",e).onSnapshot(function(t){l({type:n.SET_POMODORO_LIVE_COUNT,payload:{mode:e,value:t.size}})})})},[l]),c.a.createElement(Le.Provider,{value:i},t)},we=a(515),Fe=a(516),He=a(520),Ye=a(521),Be=a(519),ze=a(510),Ve=a(511),Ge=a(512),Je=a(218),Ze=function(e){e.preventDefault()},We=function(e){e.stopPropagation()},qe=function(){var e=Object(r.useContext)(Le),t=e.state,a=t.pid,o=t.projects,s=e.dispatch,l=Object(r.useCallback)(function(e){var t=e.target.value;t&&s({type:n.SET_PID,payload:{pid:t}})},[s]);return c.a.createElement(ze.a,{className:"col"},c.a.createElement(Ve.a,{addonType:"prepend"},"Project"),c.a.createElement(Ge.a,{value:a,type:"select",onChange:l},c.a.createElement("option",{value:""}," --- "),o.map(function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)})))},Qe=function(){var e=Object(r.useContext)(Le),t=e.state,a=t.milestones,o=t.mid,s=e.dispatch,l=Object(r.useCallback)(function(e){var t=e.target.value;t&&s({type:n.SET_MID,payload:{mid:t}})},[s]);return c.a.createElement(ze.a,{className:"col"},c.a.createElement(Ve.a,{addonType:"prepend"},"Sprint"),c.a.createElement(Ge.a,{type:"select",value:o,onChange:l},c.a.createElement("option",{value:""}," --- "),a.map(function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)})))},Xe=function(){var e=Object(r.useContext)(Le),t=e.state,a=t.custom_attrs,o=t.custom_eid,s=t.custom_rid,l=e.dispatch,u=Object(r.useCallback)(function(e){var t=e.target.value;if(t)switch(e.target.name){case"eid":l({type:n.SET_CUSTOM_EID,payload:{custom_eid:t}});break;case"rid":l({type:n.SET_CUSTOM_RID,payload:{custom_rid:t}})}},[l]);return c.a.createElement("div",{className:"row"},c.a.createElement(ze.a,{className:"col"},c.a.createElement(Ve.a,{addonType:"prepend"},"Estimate"),c.a.createElement(Ge.a,{value:o,name:"eid",type:"select",onChange:u},c.a.createElement("option",{value:""}," --- "),a.map(function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)}))),c.a.createElement(ze.a,{className:"col"},c.a.createElement(Ve.a,{addonType:"prepend"},"Result"),c.a.createElement(Ge.a,{value:s,name:"rid",type:"select",onChange:u},c.a.createElement("option",null," --- "),a.map(function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)}))))},$e=a(513),et=a(514),tt=a(540),at=a(517),nt=a(111),rt=a.n(nt),ct=function(e,t){return-1===t?"":0===t?"Planning":"Day ".concat(t)},ot=function(e){return{"text-danger":0===e,"text-info":6===e}},st=function(e){var t=e.item,a=e.idx,o=Object(r.useContext)(Le),s=o.state.biz_days,l=o.dispatch,u=Object(r.useCallback)(function(e){var t=e.target.value;e.target.checked?l({type:n.ADD_BIZ_DAY,payload:{biz_day:t}}):l({type:n.REMOVE_BIZ_DAY,payload:{biz_day:t}})},[l]);if(!t)return c.a.createElement("td",null,c.a.createElement("br",null));var i=t.format("YYYY-MM-DD"),_=i===s[0],E="biz-day-".concat(i),p=m.a.includes(s,i);return c.a.createElement(c.a.Fragment,null,c.a.createElement("td",{className:d()(ot(a),{"table-info":_}),id:E},rt.a.isWeekDay(t)?c.a.createElement($e.a,{check:!0,inline:!0},c.a.createElement(et.a,{check:!0},c.a.createElement(Ge.a,{onChange:u,disabled:rt.a.isWeekendDay(t),value:i,type:"checkbox",checked:p,className:"form-check-input"}),i)):c.a.createElement("span",null,i)),p?c.a.createElement(tt.a,{target:E},function(e,t){var a=t.indexOf(e);return ct(0,a)}(i,s)):null)},lt=function(){var e=Object(r.useContext)(Le),t=e.state,a=t.biz_days,o=t.milestone,s=e.dispatch,l=Object(r.useState)([]),i=Object(u.a)(l,2),_=i[0],E=i[1];if(Object(r.useEffect)(function(){if(o){var e=function(e){var t=T()(e.estimated_start).local(),a=T()(e.estimated_finish).local().diff(t,"days");return m.a.times(a).map(function(e){return t.clone().add(e,"days")})}(o);E(e),a.length<=1&&s({type:n.SET_BIZ_DAYS,payload:{biz_days:(t=e,t.filter(function(e){return rt.a.isWeekDay(e)}).map(function(e){return e.format("YYYY-MM-DD")}))}})}var t},[o,a,s]),0===_.length)return null;var p=m.a.chunk([].concat(Object(H.a)(m.a.times(_[0].day(),function(){return null})),Object(H.a)(_)),7);return c.a.createElement(we.a,null,c.a.createElement(Fe.a,null,"Business Days"),c.a.createElement(at.a,{bordered:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,T.a.weekdays().map(function(e,t){return c.a.createElement("th",{key:t,className:d()("text-center",ot(t))},e)}))),c.a.createElement("tbody",null,p.map(function(e,t){return c.a.createElement("tr",{key:t},e.map(function(e,t){return c.a.createElement(st,{idx:t,key:t,item:e})}))}))))},ut=a(518),it=function(e){var t=e.item,a=Object(r.useContext)(Le),o=a.state.reject_task_status_ids,s=a.dispatch,l=Object(r.useCallback)(function(e){var t=e.target.value;e.target.checked?s({type:n.REMOVE_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}}):s({type:n.ADD_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}})},[s]);return c.a.createElement($e.a,{check:!0,inline:!0},c.a.createElement(et.a,{check:!0},c.a.createElement(Ge.a,{onChange:l,type:"checkbox",value:t.id,defaultChecked:!m.a.includes(o,String(t.id))}),t.name))},mt=function(){var e=Object(r.useContext)(Le).state.task_statuses;return 0===e.length?null:c.a.createElement(we.a,null,c.a.createElement(Fe.a,null,"Task status"),c.a.createElement(ut.a,null,e.map(function(e){return c.a.createElement(it,{key:e.id,item:e})})))},_t=a(216),dt=function(){return c.a.createElement(Ve.a,{addonType:"append"},c.a.createElement(_t.a,null,c.a.createElement($.a,{icon:ee.G,className:"fa-pulse"})))},Et=function(){var e=Object(r.useContext)(Le),t=e.state.timelimit_close_task,a=e.dispatch,o=Object(r.useState)(""),s=Object(u.a)(o,2),l=s[0],i=s[1],_=Object(r.useState)(!1),d=Object(u.a)(_,2),E=d[0],p=d[1],O=Object(r.useCallback)(function(e){i(e.target.value)},[]),f=Object(r.useCallback)(function(e){l&&a({type:n.SET_TIMELIMIT_CLOSE_TASK,payload:{timelimit_close_task:l},meta:{customize:!0}}),e.preventDefault()},[l,a]);return Object(r.useEffect)(function(){t&&(p(!0),m.a.defer(p,!1))},[t]),c.a.createElement(Be.a,{onSubmit:f},c.a.createElement(ze.a,null,c.a.createElement(Ve.a,{addonType:"prepend"},"Timelimit for closing old tasks"),E?c.a.createElement(dt,null):c.a.createElement(Ge.a,{defaultValue:t,onChange:O,type:"datetime-local"}),c.a.createElement(Ve.a,{addonType:"append"},c.a.createElement(Je.a,null,"Set"))))},pt=a(219),Ot=a.n(pt),ft=function(e){var t=e.isOpen?90:void 0;return c.a.createElement($.a,{className:"text-muted mr-2",rotation:t,icon:ee.f})},Tt=function(){var e=Object(r.useContext)(Le),t=e.state,a=t.url,o=t.isOpen,s=t.biz_days,l=t.milestone,i=e.dispatch,_=Object(r.useState)(""),E=Object(u.a)(_,2),p=E[0],O=E[1],f=Object(r.useCallback)(function(e){O(e.target.value)},[O]),T=Object(r.useCallback)(function(e){p&&i({type:n.SET_URL,payload:{url:p}}),e.preventDefault()},[p,i]),S=Object(r.useCallback)(function(){i(o?{type:n.CLOSE_CONTROLLER}:{type:n.OPEN_CONTROLLER})},[i,o]),b=Object(r.useMemo)(function(){return function(e,t){return e&&t.project_extra_info?"".concat(e,"/project/").concat(t.project_extra_info.slug,"/taskboard/").concat(t.slug):""}(a,l)},[l,a]),v=l.name,k=Object(r.useMemo)(function(){return function(e){return e.length>1?"[".concat(m.a.head(e)," - ").concat(m.a.last(e),"]"):""}(s)},[s]);return c.a.createElement(we.a,null,c.a.createElement(Fe.a,{className:d()(Ot.a.header),onClick:S},c.a.createElement(ft,{isOpen:o}),v&&c.a.createElement(He.a,{color:"primary",pill:!0,className:"p-1 m-1"},c.a.createElement("span",null,v)),k&&c.a.createElement(He.a,{className:"p-1 m-1"},c.a.createElement("span",null,k)),b?c.a.createElement("a",{target:"_blank",onClick:We,className:"float-right",href:b,rel:"noopener noreferrer"},c.a.createElement($.a,{className:"mr-1",icon:ee.q}),"Taskboard"):null),c.a.createElement(Ye.a,{isOpen:o},c.a.createElement(Be.a,{onSubmit:T},c.a.createElement(ze.a,null,c.a.createElement(Ve.a,{addonType:"prepend"},"URL"),c.a.createElement(Ge.a,{defaultValue:a,onChange:f,placeholder:"http://hostname:port"}),c.a.createElement(Ve.a,{addonType:"append"},c.a.createElement(Je.a,null,"Set")))),c.a.createElement("div",{className:"row"},c.a.createElement(qe,null),c.a.createElement(Qe,null)),c.a.createElement(Xe,null),c.a.createElement(Et,null),c.a.createElement(lt,null),c.a.createElement(mt,null)))},St=a(68),bt=a(51),vt=a(220),kt=a(523),yt=a(524),ht=function(){var e=Object(r.useContext)(Le).dispatch,t=Object(r.useCallback)(function(){e({type:n.UPDATE_DATA})},[e]);return c.a.createElement(Je.a,{onClick:t},c.a.createElement($.a,{icon:ee.H}))},jt=a(144),gt=a.n(jt),Ct=a(522),At=function(){var e=Object(r.useContext)(Le),t=e.state,a=t.auth_token,o=t.auth_error,s=t.username,l=e.dispatch,i=Object(r.useState)(""),m=Object(u.a)(i,2),_=m[0],d=m[1],E=Object(r.useState)(""),p=Object(u.a)(E,2),O=p[0],f=p[1],T=Object(r.useState)(!1),S=Object(u.a)(T,2),b=S[0],v=S[1],k=Object(r.useCallback)(function(e){_&&O&&(v(!0),l({type:n.SIGN_IN,payload:{username:_,password:O}})),e.preventDefault()},[O,_,l,v]),y=Object(r.useCallback)(function(e){d(e.target.value)},[d]),h=Object(r.useCallback)(function(e){f(e.target.value)},[f]),j=Object(r.useCallback)(function(){l({type:n.SIGN_OUT})},[l]);return Object(r.useEffect)(function(){(o||a)&&v(!1)},[o,a,v]),c.a.createElement(c.a.Fragment,null,a?c.a.createElement(Be.a,{inline:!0,onSubmit:Ze,className:"mr-1"},c.a.createElement(ze.a,null,c.a.createElement(Ve.a,{addonType:"prepend"},c.a.createElement(_t.a,null,c.a.createElement($.a,{icon:ee.K}))),c.a.createElement(Ve.a,{addonType:"prepend",className:"border border-success"},c.a.createElement(_t.a,null,s)),c.a.createElement(Ve.a,{addonType:"append"},c.a.createElement(Je.a,{title:"Sign out",onClick:j,color:"danger"},c.a.createElement($.a,{icon:ee.F}))))):c.a.createElement(Be.a,{inline:!0,onSubmit:k,className:"mr-1"},c.a.createElement(ze.a,null,c.a.createElement(Ve.a,{addonType:"prepend"},c.a.createElement(_t.a,null,c.a.createElement($.a,{icon:ee.K}))),c.a.createElement(Ge.a,{disabled:b,onInput:y,onChange:y,name:"username",placeholder:"username",invalid:o})),c.a.createElement(ze.a,null,c.a.createElement(Ve.a,{addonType:"prepend"},c.a.createElement(_t.a,null,c.a.createElement($.a,{icon:ee.w}))),c.a.createElement(Ge.a,{disabled:b,onInput:h,onChange:h,name:"password",placeholder:"password",type:"password",invalid:o})),c.a.createElement(Je.a,{color:"info"},b?c.a.createElement(Ct.a,{size:"sm",type:"grow"}):c.a.createElement($.a,{icon:ee.E}))))},Dt=["success","warning","info","danger"],Rt=function(e){return m.a.groupBy(e,"assigned_to")},Mt=function(e){var t=e.src||"http://i.pravatar.cc/80?u=".concat(Math.random());return c.a.createElement(vt.a,Object.assign({},e,{src:t,square:!0,className:"mr-1"}))},It=function(e,t,a){return e.has(t)?(n=m.a.get(e.get(t),"attributes_values.".concat(a),"0"),m.a.chain(n).replace(/[^0-9.+,]/g,"").replace(/[+]/g,",").split(",").compact().map(Number).sum().value()):0;var n},Nt=function(e,t,a){return m.a.chain(t).map(function(t){return It(e,t,a)}).sum().value()},xt=function(e,t,a){return Nt(e,t.filter(function(e){return e.is_closed}),a)},Ut=function(e,t){return e.has(t)?m.a.get(e.get(t),"version"):void 0},Pt=function(e,t,a){return a&&t===e},Lt=function(e,t){return t>e},Kt=function(e){var t=e.username,a=e.val,n=e.total,o=e.imgSrc,s=Object(r.useMemo)(function(){var e=n>0?(a-n)/n:0;return e<-.1?[ee.s,""]:e<=.1?[ee.s,"table-success"]:e<=.2?[ee.t,"table-warning"]:[ee.j,"table-danger"]},[n,a]),l=Object(u.a)(s,2),i=l[0],m=l[1];return a?c.a.createElement(c.a.Fragment,null,c.a.createElement("td",{className:m},c.a.createElement(Mt,{src:o})," ",t,c.a.createElement($.a,{className:"mx-1",icon:i})),c.a.createElement("td",{className:d()(m,"text-right")},a)):c.a.createElement(c.a.Fragment,null,c.a.createElement("td",null,c.a.createElement(Mt,{src:o})," ",t),c.a.createElement("td",null))},wt=function(e){var t=e.e,a=e.r,n=Object(r.useMemo)(function(){return function(e,t){if(m.a.isNumber(e)&&m.a.isNumber(t)&&e>0){var a=Math.abs(e-t)/e;if(a<=.05)return["gold",3];if(a<=.1)return["silver",2];if(a<.2)return["bronze",1]}return[null,0]}(t,a)},[t,a]),o=Object(u.a)(n,2),s=o[0],l=o[1];return s?c.a.createElement(c.a.Fragment,null,m.a.times(l).map(function(e){return c.a.createElement($.a,{key:e,className:gt.a[s],icon:ee.y})})):null},Ft=function(e){var t=e.tasks,a=Object(r.useContext)(Le).state,n=a.active_task_statuses,o=a.custom_eid,s=a.custom_value_map,l=Number(o),u=Object(r.useMemo)(function(){return m.a.chain(n).filter({is_closed:!0}).reverse().map(function(e,a){return{status:e.id,total:Nt(s,m.a.filter(t,{status:e.id}),l),style:Dt[a],label:e.name}}).value()},[n,s,l,t]),i=Object(r.useMemo)(function(){return Nt(s,t,l)},[s,l,t]);return c.a.createElement(kt.a,{multi:!0},u.map(function(e){return c.a.createElement(kt.a,{key:e.label,bar:!0,max:i,value:e.total,color:e.style},e.label)}))},Ht=function(e){var t=e.item,a=e.sums,n=e.isPast,o=e.total,s=e.hpd,l=e.tasks,i=Object(r.useState)(0),_=Object(u.a)(i,2),d=_[0],E=_[1],p=Object(r.useCallback)(function(e){E(Number(e.target.value)||0)},[E]),O=m.a.get(a,t.id),f=m.a.get(O,"e"),T=m.a.get(O,"r"),S=d||o,b=String(S);return c.a.createElement("tr",{key:t.id},o>0?c.a.createElement(c.a.Fragment,null,c.a.createElement(Kt,{username:t.username,val:f,total:S,imgSrc:t.photo}),c.a.createElement("td",{className:"text-right"},o),c.a.createElement("td",{className:gt.a.custom_input_td},c.a.createElement(Ge.a,{bsSize:"sm",type:"number",className:"text-right",value:b,step:s,onChange:p}))):c.a.createElement(c.a.Fragment,null,c.a.createElement("td",null,c.a.createElement(Mt,{src:t.photo}),c.a.createElement(St.b,{to:"/".concat(t.id)},t.username)),c.a.createElement("td",{className:"text-right"},t.burn_down||""),c.a.createElement("td",{className:"text-right"},f),c.a.createElement("td",{className:"text-right"},T),c.a.createElement("td",null,m.a.isNumber(f)&&c.a.createElement(Ft,{tasks:l}))),n?c.a.createElement("td",null,c.a.createElement(wt,{e:f,r:T})):null)},Yt=function(e,t,a,n){var r=Number(a),c=Number(n);return m.a.mapValues(Rt(e),function(e){return m.a.chain(e).map(function(e){return{e:It(t,e,r),r:It(t,e,c)}}).reduce(function(e,t){return{e:e.e+t.e,r:e.r+t.r}},{e:0,r:0}).value()})},Bt=function(){var e=Object(r.useContext)(Le).state,t=e.tasks,a=e.custom_value_map,n=e.custom_eid,o=e.custom_rid,s=e.biz_days,l=e.custom_attr_e,i=e.custom_attr_r,_=e.project.members,d=Object(r.useState)(0),E=Object(u.a)(d,2),p=E[0],O=E[1],f=s.length-1,S=Object(r.useCallback)(function(e){O(Number(e.target.value)||0)},[O]),b=p*f,v=Object(r.useMemo)(function(){return Yt(t,a,n,o)},[n,o,a,t]),k=m.a.get(v,"null.e",0),y=b>0,h=Object(r.useMemo)(function(){return!y&&T()().diff(T()(m.a.last(s)).local().endOf("days"))>0},[s,y]),j=Object(r.useMemo)(function(){return Rt(t)},[t]),g=Object(r.useMemo)(function(){return m.a.chain(_).map(function(e){return Object(Y.a)({},e,{burn_down:xt(a,j[e.id]||[],Number(n))})}).sortBy("burn_down").reverse().value()},[n,a,_,j]);return!l.id||!i.id||s.length<=1?null:c.a.createElement(c.a.Fragment,null,c.a.createElement(yt.a,{color:"light",light:!0},c.a.createElement(Be.a,{inline:!0,className:"mr-auto",onSubmit:Ze},c.a.createElement(ze.a,null,c.a.createElement(Ge.a,{type:"number",step:"0.5",placeholder:"hours / day",className:"text-right",onChange:S}),c.a.createElement(Ve.a,{addonType:"append"},c.a.createElement(_t.a,null,c.a.createElement($.a,{className:"mx-2",icon:ee.J}),f," [days]",c.a.createElement($.a,{className:"mx-2",icon:ee.n})),b>0?c.a.createElement(c.a.Fragment,null,c.a.createElement(_t.a,{className:"bg-white"},c.a.createElement("strong",null,b)),c.a.createElement(_t.a,null,"hours / sprint")):null))),c.a.createElement(At,null),c.a.createElement(ht,null)),c.a.createElement(at.a,{bordered:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Name"),!y&&c.a.createElement("th",{className:"text-danger"},c.a.createElement($.a,{icon:ee.x}),c.a.createElement($.a,{icon:ee.c})),c.a.createElement("th",null,l.name),y?c.a.createElement(c.a.Fragment,null,c.a.createElement("th",null,"Total")," ",c.a.createElement("th",null,"Custom")):c.a.createElement(c.a.Fragment,null,c.a.createElement("th",null,i.name),c.a.createElement("th",null,"Progress")),h?c.a.createElement("th",null,"Grade"):null)),c.a.createElement("tbody",null,(g||[]).map(function(e){return c.a.createElement(Ht,{key:e.id,isPast:h,item:e,sums:v,total:b,hpd:p,tasks:j[e.id]||[]})}),c.a.createElement("tr",{key:"null"},c.a.createElement("td",{className:"text-danger"},c.a.createElement($.a,{icon:ee.r,className:"ml-1 mr-2 fa-lg"}),"Not assigned"),!y&&c.a.createElement("td",null),c.a.createElement("td",{className:"text-right text-danger"},k),c.a.createElement("td",null),c.a.createElement("td",null),h?c.a.createElement("td",null):null))))},zt=a(526),Vt=a(527),Gt=a(528),Jt=a(529),Zt=a(530),Wt=a(531),qt=a(532),Qt=a(533),Xt=a(534),$t=a(535);function ea(){return(ea=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ta(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var aa,na=c.a.createElement("g",null,c.a.createElement("path",{fill:"currentColor",className:"leaf",d:"M115.343,123.839c0.814,1.256,3.343,2.605,7.23,4.014c7.586-1.069,14.943-1.586,21.885-1.586 c15.579,0,30.166,2.469,42.438,7.145c17.87-5.567,43.412-11.694,69.108-11.694c25.694,0,51.228,6.126,69.108,11.694 c12.262-4.676,26.848-7.145,42.42-7.145c7.001,0,14.418,0.518,22.063,1.604c3.471-1.341,6.296-2.699,8.325-4.031 c42.2-28.139,53.036-81.183,47.41-69.931c-4.218,8.418-60.309,35.581-100.004,52.222c14.68-17.769,31.677-44.134,43.438-80.309 c0,0-60.978,52.382-98.867,74.887c-11.974-20.816-33.892-86.589-33.892-86.589s-18.567,49.515-20.358,81.412 c-30.21-16.929-63.354-51.474-72.485-74.538c-10.752-27.189-13.78,53.545,15.436,89.396c-1.095,0.162-2.206,0.315-3.344,0.476 c-39.111-16.072-100.454-47.91-104.926-54.86C64.708,47.255,73.143,101.954,115.343,123.839z M290.531,107.181l0.747,0.857 l-3.098-0.746L290.531,107.181z"}),c.a.createElement("path",{fill:"currentColor",className:"tomato",d:"M485.83,198.564c-38.169-57.253-117.544-70.584-160.338-52.195c-18.27-5.906-43.872-12.27-69.49-12.27 c-25.619,0-51.228,6.364-69.499,12.27c-42.794-18.388-122.168-5.058-160.338,52.195c-64.136,96.203-18.711,299.318,229.836,299.318 C504.541,497.882,549.974,294.767,485.83,198.564z M101.172,262.929c-17.099,0-30.947-13.857-30.947-30.948 c0-17.09,13.848-30.947,30.947-30.947c17.082,0,30.947,13.857,30.947,30.947C132.119,249.071,118.253,262.929,101.172,262.929z"})),ra=function(e){var t=e.svgRef,a=ta(e,["svgRef"]);return c.a.createElement("svg",ea({id:"_x32_",x:"0px",y:"0px",viewBox:"0 0 512 512",xmlSpace:"preserve",ref:t},a),na)},ca=c.a.forwardRef(function(e,t){return c.a.createElement(ra,ea({svgRef:t},e))}),oa=(a.p,a(82)),sa=a.n(oa);!function(e){e.FRESH="fresh",e.STALE="stale"}(aa||(aa={}));var la=function(e){var t,a=e.state,n=e.bl,r=e.br;return c.a.createElement(ca,{className:d()("fa-fw","svg-inline--fa",(t={},Object(k.a)(t,sa.a.fresh,a===aa.FRESH),Object(k.a)(t,sa.a.stale,a===aa.STALE),Object(k.a)(t,sa.a.bl,n),Object(k.a)(t,sa.a.br,r),t))})},ua=a(114),ia=a.n(ua),ma=a(113),_a=a.n(ma),da=a(75),Ea=a.n(da),pa=a(237),Oa=a(112),fa=a.n(Oa),Ta=function(e){return m.a.chain(e).groupBy("user_story").map(function(e,t){return{user_story:Number(t),user_story_extra_info:e[0].user_story_extra_info,project_extra_info:e[0].project_extra_info,tasks:e,is_closed:e.every(function(e){return e.is_closed})}}).value()},Sa=function(e){return e?"Need sign in!":""},ba=function(e){var t=e.user_story_extra_info,a=e.project_extra_info,n=Object(r.useContext)(Le).state.url,o=a.slug,s=t?"#".concat(t.ref," ").concat(t.subject):void 0,l=t?"".concat(n,"/project/").concat(o,"/us/").concat(t.ref):"#";return s?c.a.createElement("a",{href:l,onClick:We,target:"_blank",rel:"noopener noreferrer",title:s},c.a.createElement($.a,{icon:ee.q})," ",s):c.a.createElement(c.a.Fragment,null,"(Unassigned tasks)")},va=function(e){var t=e.item,a=Object(r.useContext)(Le).state.url,n="#".concat(t.ref," ").concat(t.subject),o="".concat(a,"/project/").concat(t.project_extra_info.slug,"/task/").concat(t.ref);return c.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer",title:n},c.a.createElement($.a,{icon:ee.q})," ",n)},ka=function(e){var t=e.label,a=e.value,n=e.onSubmit,o=e.onEditable,s=e.onValueChange,l=e.valid,i=e.invalid,m=e.disabled,_=e.loading,d=e.id,E=e.submitting,p=Object(r.useState)(!1),O=Object(u.a)(p,2),f=O[0],T=O[1],S=Object(r.useState)(""),b=Object(u.a)(S,2),v=b[0],k=b[1],y=Object(r.useState)(!1),h=Object(u.a)(y,2),j=h[0],g=h[1],C=Object(r.useCallback)(function(e){T(e.currentTarget.checked)},[T]),A=Object(r.useCallback)(function(e){var t=e.target.value;k(t),s&&s(Number(t))},[s]),D=Object(r.useCallback)(function(e){var t=Number(v);f&&""!==v&&t>=0&&n&&(n(t),T(!1),g(!0)),e.preventDefault()},[f,v,n,T]);Object(r.useEffect)(function(){m&&T(!1)},[T,m]),Object(r.useEffect)(function(){g(!1)},[a]),Object(r.useEffect)(function(){o&&o(f)},[f,o]),Object(r.useEffect)(function(){E&&(T(!1),g(!0))},[E]),Object(r.useEffect)(function(){_&&T(!1)},[_]);var R=Sa(m);return c.a.createElement(Be.a,{inline:!0,onSubmit:D},c.a.createElement(ze.a,{className:Ea.a.toggle_input},c.a.createElement(Ve.a,{addonType:"prepend"},t),_?c.a.createElement(dt,null):c.a.createElement(c.a.Fragment,null,f?c.a.createElement(c.a.Fragment,null,c.a.createElement(Ve.a,{addonType:"prepend"},c.a.createElement(fa.a,null,a)),c.a.createElement(Ve.a,{addonType:"prepend"},c.a.createElement(fa.a,null,c.a.createElement($.a,{className:"text-info",icon:ee.u}))),c.a.createElement(Ge.a,{onInput:A,onChange:A,defaultValue:String(a),type:"number",step:"0.5",min:"0",id:d}),c.a.createElement(Ve.a,{addonType:"append"},c.a.createElement(Je.a,{color:"info"},c.a.createElement($.a,{icon:ee.g})))):c.a.createElement(c.a.Fragment,null,j?c.a.createElement(dt,null):c.a.createElement(Ge.a,{valid:l,invalid:i,readOnly:!0,value:a})),c.a.createElement(Ve.a,{addonType:"append",title:R},c.a.createElement(pa.a,{disabled:m,checked:f,onChange:C},c.a.createElement($.a,{className:"text-info",icon:ee.k}))))))},ya=function(e){var t=e.e,a=e.r;return c.a.createElement(ze.a,{className:Ea.a.display_medal},c.a.createElement(Ve.a,{addonType:"prepend"},"Grade"),c.a.createElement(fa.a,{className:Ea.a.medal},c.a.createElement(wt,{e:t,r:a})))},ha=function(e){var t=e.item,a=e.task,o=e.onSelect,s=Object(r.useContext)(Le).dispatch,l=Object(r.useCallback)(function(){s({type:n.PATCH_TASK,payload:{key:"status",value:t.id,id:a.id}}),o&&o(t.id)},[s,t.id,a.id,o]);return c.a.createElement(zt.a,{onClick:l},t.name)},ja=function(e){var t=e.task,a=e.disabled,n=Object(r.useState)(!1),o=Object(u.a)(n,2),s=o[0],l=o[1],i=Object(r.useContext)(Le).state.active_task_statuses,m=Object(r.useCallback)(function(){l(!0)},[l]);return Object(r.useEffect)(function(){l(!1)},[t.version,l]),c.a.createElement(c.a.Fragment,null,s?c.a.createElement(Ct.a,{type:"grow",color:"info"}):c.a.createElement(Vt.a,null,c.a.createElement(Gt.a,{title:Sa(a),disabled:a,caret:!a},t.status_extra_info.name),c.a.createElement(Jt.a,null,i.map(function(e){return c.a.createElement(ha,{item:e,key:e.id,task:t,onSelect:m})}))))},ga=function(e){var t=e.item,a=e.onSelect,n=Object(r.useCallback)(function(){a&&a(t.id)},[t.id,a]);return c.a.createElement(zt.a,{onClick:n},c.a.createElement(Mt,{src:t.photo}),t.username)},Ca=function(e){var t=e.task,a=e.disabled,o=Object(r.useState)(!1),s=Object(u.a)(o,2),l=s[0],i=s[1],m=Object(r.useContext)(Le),_=m.state.project.members,d=m.dispatch,E=Object(r.useCallback)(function(e){i(!0),d({type:n.PATCH_TASK,payload:{key:"assigned_to",value:e,id:t.id}})},[d,t.id]);return Object(r.useEffect)(function(){i(!1)},[t.version,i]),c.a.createElement(c.a.Fragment,null,l?c.a.createElement(Ct.a,{type:"grow",color:"info"}):c.a.createElement(Vt.a,null,c.a.createElement(Gt.a,{title:Sa(a),size:"sm",disabled:a,caret:!a},"Assign To"),c.a.createElement(Jt.a,null,(_||[]).map(function(e){return c.a.createElement(ga,{item:e,onSelect:E,key:e.id})}))))},Aa=function(e){var t=e.task,a=Object(r.useState)(!1),o=Object(u.a)(a,2),s=o[0],l=o[1],i=Object(r.useContext)(Le).dispatch,m=Object(r.useCallback)(function(){l(!0),i({type:n.PATCH_TASK,payload:{key:"assigned_to",value:null,id:t.id}})},[i,t.id]);return Object(r.useEffect)(function(){l(!1)},[t.version,l]),c.a.createElement(c.a.Fragment,null,s?c.a.createElement(Ct.a,{type:"grow",color:"danger"}):c.a.createElement(Je.a,{className:"mr-2",title:"Not assigned",color:"danger",onClick:m},c.a.createElement($.a,{icon:ee.M})))},Da=function(e){var t=e.item,a=Object(r.useContext)(Le),o=a.state,s=o.custom_eid,l=o.custom_value_map,u=o.auth_token,i=o.custom_attr_e,m=a.dispatch,_=Ut(l,t),d=Object(r.useCallback)(function(e){_&&m({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:s,value:e,version:_}})},[m,t.id,s,_]),E=Object(r.useMemo)(function(){return It(l,t,i.id)},[i.id,l,t]);if(!i.id)return null;var p=!E,O=""===u,f=!_;return c.a.createElement(ka,{onSubmit:d,label:i.name,value:E,invalid:p,disabled:O,loading:f})},Ra=function(e){var t=e.item,a=Object(r.useState)(!1),o=Object(u.a)(a,2),s=o[0],l=o[1],i=Object(r.useState)(0),_=Object(u.a)(i,2),E=_[0],p=_[1],O=Object(r.useState)(!1),f=Object(u.a)(O,2),T=f[0],S=f[1],b=Object(r.useState)(!1),v=Object(u.a)(b,2),k=v[0],y=v[1],h=Object(r.useContext)(Le),j=h.state,g=j.custom_rid,C=j.custom_value_map,A=j.custom_attr_e,D=j.custom_attr_r,R=j.auth_token,M=j.pomodoro_number,I=j.pomodoro_used_number,N=h.dispatch,x=Ut(C,t),U=Object(r.useCallback)(function(){l(!s)},[s]),P=Object(r.useCallback)(function(e,a){var r=e>0,c=a?{used_number:a}:void 0;x&&(N({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:g,value:e,version:x},meta:{use_pomodoro:c,update_status:r}}),y(!0))},[g,N,t.id,x]),L=Object(r.useCallback)(function(){p(E+1)},[E]),K=Object(r.useCallback)(function(){p(E-1)},[E]),w=Object(r.useCallback)(function(){p(0)},[]),F=Object(r.useCallback)(function(e){S(e)},[]),H=Object(r.useMemo)(function(){return It(C,t,A.id)},[A.id,C,t]),Y=Object(r.useMemo)(function(){return It(C,t,D.id)},[D.id,C,t]),B=Object(r.useCallback)(function(e){S(Y===e)},[Y]),z=Object(r.useCallback)(function(){P(Y+E/2,E),l(!1),p(0)},[P,Y,E]),V=Object(r.useMemo)(function(){return Pt(H,Y,t.is_closed)},[H,t.is_closed,Y]),G=Object(r.useMemo)(function(){return Lt(H,Y)},[H,Y]);if(Object(r.useEffect)(function(){x||y(!1)},[x]),Object(r.useEffect)(function(){p(0)},[I]),!D.id)return null;var J=""===R,Z=!x,W="rusult-input-".concat(t.id),q=M-I,Q=E>0,X=E===q;return c.a.createElement(c.a.Fragment,null,c.a.createElement(ka,{onSubmit:P,onEditable:F,onValueChange:B,label:D.name,value:Y,valid:V,invalid:G,disabled:J,loading:Z,id:W,submitting:k}),T&&q>0&&c.a.createElement(Zt.a,{className:d()("popover-wide"),target:W,placement:"top",isOpen:s,toggle:U,trigger:"click hover"},c.a.createElement(Wt.a,null,"Pomodoro"),c.a.createElement(qt.a,null,c.a.createElement(Qt.a,null,c.a.createElement(Je.a,{disabled:X,onClick:L},c.a.createElement($.a,{icon:ee.C})),c.a.createElement(Je.a,{disabled:!Q,onClick:K},c.a.createElement($.a,{icon:ee.z})),c.a.createElement(Je.a,{disabled:!0,className:"bg-light"},m.a.times(q).map(function(e){return c.a.createElement(la,{key:e,state:e>=E?aa.FRESH:aa.STALE})})),c.a.createElement(Je.a,{disabled:!Q,onClick:z},c.a.createElement($.a,{icon:ee.g})),c.a.createElement(Je.a,{disabled:!Q,onClick:w},c.a.createElement($.a,{icon:ee.o}))))))},Ma=function(e){var t=e.item,a=Object(r.useContext)(Le),o=a.state,s=o.task_id,l=o.pomodoro_mode,u=o.pomodoro_state,i=a.dispatch,m=Object(r.useCallback)(function(){Number(s)!==t.id&&i({type:n.SET_TASK_ID,payload:{task_id:String(t.id)}}),u===b.STOPPED?(x.changeMode(v.FOCUS),x.start()):l===v.FOCUS?x.resume():(x.changeMode(v.FOCUS),x.start())},[i,t.id,l,u,s]),_=Object(r.useCallback)(function(){x.pause()},[]);return Number(s)===t.id?l===v.FOCUS&&u===b.RUNNING?c.a.createElement(Je.a,{className:"mr-2",color:"danger",onClick:_},c.a.createElement($.a,{icon:ee.A}),c.a.createElement(la,null)):c.a.createElement(Je.a,{onClick:m,color:"primary",className:"mr-2"},c.a.createElement($.a,{icon:ee.B}),c.a.createElement(la,null)):""===s?l===v.FOCUS&&u!==b.STOPPED?null:c.a.createElement(Je.a,{onClick:m,color:"primary",className:"mr-2"},c.a.createElement($.a,{icon:ee.B}),c.a.createElement(la,null)):null},Ia=function(e){var t=e.item,a=Object(r.useContext)(Le).state,n=a.custom_value_map,o=a.custom_attr_e,s=a.custom_attr_r,l=a.auth_token,u=Object(r.useMemo)(function(){return Ut(n,t)},[n,t]),i=Object(r.useMemo)(function(){return It(n,t,o.id)},[o.id,n,t]),m=Object(r.useMemo)(function(){return It(n,t,s.id)},[s.id,n,t]);if(!o.id||!s.id)return null;var _=""===l,E=!u,p=0===m&&!t.is_closed&&!_&&!E;return c.a.createElement(_a.a,{className:d()(Object(k.a)({},Ea.a.is_closed,t.is_closed))},c.a.createElement("div",{className:"d-flex mb-1"},c.a.createElement("div",{className:"mr-auto text-truncate"},c.a.createElement(va,{item:t})),p&&c.a.createElement(Aa,{task:t}),c.a.createElement(Ma,{item:t}),c.a.createElement(ja,{task:t,disabled:_})),c.a.createElement(Xt.a,null,c.a.createElement($t.a,null,c.a.createElement(Da,{item:t})),c.a.createElement($t.a,null,c.a.createElement(Ra,{item:t})),c.a.createElement($t.a,null,c.a.createElement(ya,{e:i,r:m}))))},Na=function(e){var t=e.item;return c.a.createElement(we.a,null,c.a.createElement(Fe.a,{className:"text-truncate"},c.a.createElement(ba,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),c.a.createElement(ia.a,null,t.tasks.map(function(e){return c.a.createElement(_a.a,{key:e.id,className:"text-truncate"},c.a.createElement("div",{className:"d-flex"},c.a.createElement("div",{className:"mr-auto text-truncate"},c.a.createElement(va,{item:e})),c.a.createElement(Da,{item:e})))})))},xa=function(e){var t=e.item,a=""===Object(r.useContext)(Le).state.auth_token;return c.a.createElement(we.a,null,c.a.createElement(Fe.a,{className:"text-truncate"},c.a.createElement(ba,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),c.a.createElement(Ye.a,{isOpen:!0},c.a.createElement(ia.a,null,t.tasks.map(function(e){return c.a.createElement(_a.a,{key:e.id},c.a.createElement("div",{className:"d-flex"},c.a.createElement("div",{className:"mr-auto text-truncate"},c.a.createElement(va,{item:e})),c.a.createElement(Ca,{task:e,disabled:a})))}))))},Ua=function(e){var t=e.item,a=Object(r.useState)(!1),n=Object(u.a)(a,2),o=n[0],s=n[1],l=Object(r.useCallback)(function(){s(!o)},[o,s]);return Object(r.useEffect)(function(){s(!t.is_closed)},[t.is_closed,s]),c.a.createElement(we.a,null,c.a.createElement(Fe.a,{className:d()(Ea.a.header,"text-truncate",{"alert-primary":t.is_closed}),onClick:l},c.a.createElement(ft,{isOpen:o}),c.a.createElement(ba,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),c.a.createElement(Ye.a,{isOpen:o},c.a.createElement(ia.a,null,t.tasks.map(function(e){return c.a.createElement(Ia,{item:e,key:e.id})}))))},Pa=function(){var e=Object(r.useContext)(Le).state,t=e.tasks,a=e.custom_value_map,n=e.custom_eid,o=Object(r.useMemo)(function(){return Number(n)},[n]),s=Object(r.useMemo)(function(){return o?t.filter(function(e){return Ut(a,e)&&0===It(a,e,o)}):[]},[a,o,t]),l=Object(r.useMemo)(function(){return Ta(s)},[s]);return 0===s.length?null:c.a.createElement(we.a,null,c.a.createElement(Fe.a,{className:"alert-danger"},"Un estimated tasks"),c.a.createElement(ut.a,null,l.map(function(e){return c.a.createElement(Na,{item:e,key:e.user_story})})))},La=function(){var e=Object(r.useContext)(Le).state.tasks,t=Object(r.useMemo)(function(){return m.a.filter(e,{assigned_to:null})},[e]),a=Object(r.useMemo)(function(){return Ta(t)},[t]);return 0===t.length?null:c.a.createElement(we.a,null,c.a.createElement(Fe.a,{className:"alert-danger"},"Not assigned tasks"),c.a.createElement(ut.a,null,a.map(function(e){return c.a.createElement(xa,{item:e,key:e.user_story})})))},Ka=a(48),wa=function(e,t){return e.filter(function(e){return T()(t).local().endOf("days").diff(T()(e.created_date))>0})},Fa=function(e){var t=e.tasks,a=Object(r.useState)([]),n=Object(u.a)(a,2),o=n[0],s=n[1],l=Object(r.useContext)(Le).state,i=l.biz_days,m=l.custom_value_map,_=l.custom_eid,d=l.custom_attr_e,E=l.custom_attr_r;Object(r.useEffect)(function(){var e=i.length,a=Number(_);if(e>0&&t.length>0&&_){var n=Nt(m,wa(t,i[0]),a),r=i.map(function(r,c){var o=ct(0,c),s=n-n*c/(e-1);if(T()().local().endOf("days").diff(T()(r))>0){var l=0===c?0:Nt(m,function(e,t){return e.filter(function(e){return T()(t).local().format("YYYY-MM-DD")===T()(e.created_date).local().format("YYYY-MM-DD")})}(t,r),a);return{label:o,estimate:s,result:Nt(m,wa(t,r),a)-l-Nt(m,function(e,t){return e.filter(function(e){return!!e.finished_date&&T()(t).local().endOf("days").diff(T()(e.finished_date))>0})}(t,r),a),add:l}}return{label:o,estimate:s}});s(r)}else s([])},[t,i,_,m,s]);var p=Object(r.useCallback)(function(e){switch(e){case"estimate":return d.name||e;case"result":return E.name||e;default:return e}},[d.name,E.name]),O=Object(r.useCallback)(function(e,t){return[Number(e).toFixed(1),p(t)]},[p]);return 0===o.length?null:c.a.createElement(we.a,{className:"mb-2"},c.a.createElement(Fe.a,null,"Burn down chart"),c.a.createElement(Ka.b,{data:o,width:800,height:400},c.a.createElement(Ka.g,null),c.a.createElement(Ka.f,{dataKey:"label"}),c.a.createElement(Ka.e,{formatter:O}),c.a.createElement(Ka.c,{formatter:p}),c.a.createElement(Ka.a,{dataKey:"result",fill:"#8884d8",stackId:"a"}),c.a.createElement(Ka.a,{dataKey:"add",fill:"#82ca9d",stackId:"a"}),c.a.createElement(Ka.d,{dataKey:"estimate"})))},Ha=a(536),Ya=a(232),Ba=a(231),za=a.n(Ba),Va=a(116),Ga=a.n(Va),Ja=function(e,t){var a,n=m.a.last(e);a=n&&n.ranking?n.e===t.e?n.ranking:n.ranking+1:1;var r=Object(Y.a)({},t,{ranking:a});return[].concat(Object(H.a)(e),[r])},Za=function(e){var t=e.name,a=e.src,n=e.value,r=e.ranking;return c.a.createElement($t.a,{sm:4},c.a.createElement(we.a,null,c.a.createElement(Fe.a,{className:d()(Object(k.a)({},Ga.a.gold,1===r),Object(k.a)({},Ga.a.silver,2===r),Object(k.a)({},Ga.a.bronze,3===r))},c.a.createElement($.a,{icon:ee.b})," Top ",r),c.a.createElement(ut.a,null,c.a.createElement(Ha.a,null,c.a.createElement("h2",{className:"text-truncate",title:t},c.a.createElement(Mt,{src:a,size:"xlarge"}),t)),c.a.createElement(Xt.a,null,c.a.createElement($t.a,{className:"my-auto text-danger text-right"},c.a.createElement("h4",null,c.a.createElement($.a,{icon:ee.x}),c.a.createElement($.a,{icon:ee.c}))),c.a.createElement($t.a,null,c.a.createElement(Ya.a,{z:6},c.a.createElement("h1",{className:"text-center"},c.a.createElement(za.a,{start:0,delay:3,duration:n,end:n}))))))))},Wa=function(){var e=Object(r.useContext)(Le).state,t=e.project.members,a=e.tasks,n=e.custom_value_map,o=e.custom_eid,s=e.custom_rid,l=e.biz_days,i=T()().format("YYYY-MM-DD"),_=Object(r.useMemo)(function(){return function(e,t,a){var n=a.indexOf(t);if(n<1)return[];var r=T()(a[n-1]).local().startOf("day"),c=T()(t).local().startOf("day");return e.filter(function(e){var t=T()(e.finished_date);return t.diff(r)>=0&&t.diff(c)<0})}(a,i,l)},[l,a,i]),d=Object(r.useMemo)(function(){return Yt(_,n,o,s)},[o,s,n,_]),E=Object(r.useMemo)(function(){return m.a.chain(t).map(function(e){return[e,d[e.id]||{e:0,r:0}]}).map(function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1],r=n.e,c=n.r;return Object(Y.a)({},a,{e:r,r:c})}).sortBy(function(e){return e.e+e.r/100}).reverse().filter(function(e){return e.e>0}).take(3).reduce(Ja,[]).value()},[t,d]),p=l.indexOf(i)-1;return p<1||0===E.length?null:c.a.createElement(we.a,null,c.a.createElement(Fe.a,null,"Day ",p," Hero"),c.a.createElement(ut.a,null,c.a.createElement(Xt.a,null,E.map(function(e){return c.a.createElement(Za,{key:e.id,name:e.username,value:e.e,src:e.photo,ranking:e.ranking})}),m.a.times(3-E.length).map(function(e){return c.a.createElement($t.a,{key:e},c.a.createElement(we.a,null,c.a.createElement(Fe.a,null,c.a.createElement($.a,{icon:ee.l})),c.a.createElement(ut.a,{className:"text-center"},c.a.createElement($.a,{icon:ee.m}))))}))))},qa=function(){var e=Object(r.useContext)(Le).state.tasks;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Bt,null),c.a.createElement(Fa,{tasks:e}),c.a.createElement(Wa,null),c.a.createElement(La,null),c.a.createElement("br",null),c.a.createElement(Pa,null))},Qa=a(538),Xa=a(537),$a=function(){var e=Object(r.useContext)(Le).state,t=e.custom_value_map,a=e.biz_days,n=e.user_tasks,o=e.custom_attr_e,s=e.custom_attr_r,l=Object(r.useMemo)(function(){return Ta(n)},[n]),i=Object(r.useMemo)(function(){return n.reduce(function(e,a){return[e[0]+It(t,a,o.id),e[1]+It(t,a,s.id)]},[0,0])},[o.id,s.id,t,n]),m=Object(u.a)(i,2),_=m[0],E=m[1],p=Object(r.useMemo)(function(){return Pt(_,E,l.every(function(e){return e.is_closed}))},[_,E,l]),O=Object(r.useMemo)(function(){return Lt(_,E)},[_,E]),f=Object(r.useMemo)(function(){return n.some(function(e){return!Ut(t,e)})},[t,n]);return!o.id||!s.id||a.length<=1?null:c.a.createElement(c.a.Fragment,null,l.map(function(e){return c.a.createElement(Ua,{item:e,key:e.user_story})}),c.a.createElement(we.a,null,c.a.createElement(Fe.a,{className:d()("alert-info")},"Total"),c.a.createElement(ut.a,null,c.a.createElement(Xt.a,null,c.a.createElement($t.a,null,c.a.createElement(ze.a,null,c.a.createElement(Ve.a,{addonType:"prepend"},o.name),f?c.a.createElement(dt,null):c.a.createElement(Ge.a,{readOnly:!0,value:_}))),c.a.createElement($t.a,null,c.a.createElement(ze.a,null,c.a.createElement(Ve.a,{addonType:"prepend"},s.name),f?c.a.createElement(dt,null):c.a.createElement(Ge.a,{readOnly:!0,value:E,invalid:O,valid:p}))),c.a.createElement($t.a,null,c.a.createElement(ya,{e:_,r:E})))),c.a.createElement(Xa.a,null,c.a.createElement(Ft,{tasks:n}))))},en=function(){var e=Object(r.useContext)(Le).state.user;return c.a.createElement(we.a,null,e&&c.a.createElement(Fe.a,null,c.a.createElement(Mt,{src:e.photo,size:"xlarge"}),e.username," 's task"))},tn=a(233),an=a.n(tn),nn=function(){var e=Object(r.useContext)(Le),t=e.state,a=t.user,o=t.user_tasks,s=t.url,l=e.dispatch,u=an()().match.params.uid;return Object(r.useEffect)(function(){return u&&s&&l({type:n.FETCH_USER,payload:{uid:u}}),function(){l({type:n.RESET_USER})}},[l,u,s]),c.a.createElement(c.a.Fragment,null,c.a.createElement(yt.a,{color:"light",light:!0},c.a.createElement(Je.a,{tag:St.b,to:"/",className:"mr-auto"},c.a.createElement($.a,{icon:ee.a})," Go back"),c.a.createElement(At,null),c.a.createElement(ht,null)),a?c.a.createElement(c.a.Fragment,null,c.a.createElement(en,null),c.a.createElement("br",null),c.a.createElement($a,null),c.a.createElement("br",null),c.a.createElement(Fa,{tasks:o})):c.a.createElement(Qa.a,{color:"danger"},"This user does not exist."))},rn=a(238),cn=a(239),on=a(150),sn=a(539),ln=a(56),un=a.n(ln),mn=a(234),_n=a.n(mn),dn=a(235),En=a.n(dn),pn=a(236),On=a.n(pn),fn=function(){var e=Object(r.useContext)(Le).state.pomodoro_daily_totals,t=Object(r.useMemo)(function(){return e.map(function(e){return{date:e.dateKey,value:e.value,pureValue:e.pureValue}})},[e]),a=(m.a.maxBy(t,"value")||{value:1}).value,n=Object(r.useCallback)(function(e){return e?"style-pomodoro color-pomodoro-".concat(Math.ceil(8*(e.value||0)/a)):"style-pomodoro empty-pomodoro"},[a]),o=Object(r.useCallback)(function(e){return e&&e.date?{"data-tip":"".concat(e.value," Pomodoros on ").concat(e.date)}:null},[]),s=Object(r.useMemo)(function(){return T()().subtract(12,"month").toDate()},[]);return 0===e.length?c.a.createElement(Qa.a,{color:"warning"},"No pomodoro history!"):c.a.createElement(c.a.Fragment,null,c.a.createElement(On.a,{startDate:s,showWeekdayLabels:!0,values:t,classForValue:n,tooltipDataAttrs:o}),c.a.createElement(En.a,null))},Tn=new(a(502))({type:"rectangle"}),Sn=function(e){return Math.ceil(e/60)},bn=function(e){switch(e.mode){case v.SHORT:return c.a.createElement($.a,{className:d()("fa-fw",un.a.short_break_icon),icon:ee.h});case v.LONG:return c.a.createElement($.a,{className:d()("fa-fw",un.a.long_break_icon),icon:ee.i});default:return c.a.createElement(la,{state:aa.FRESH})}},vn=function(e){var t=e.mode,a=e.onSelect,n=Object(r.useCallback)(function(){a(t)},[t,a]);return c.a.createElement(zt.a,{onClick:n},c.a.createElement(bn,{mode:t}),t)},kn=function(e){x.start(),e()},yn=function(e){x.start(),e(2)},hn=function(e){x.changeMode(v.FOCUS),x.start(),e()},jn=function(){var e=Object(r.useContext)(Le),t=e.state,a=t.loaded,o=t.pomodoro_date,s=t.pomodoro_number,l=t.pomodoro_used_number,i=t.task_id,_=t.task,E=t.auth_token,p=t.pomodoro_live_counts,O=e.dispatch,f=Object(r.useState)(!1),S=Object(u.a)(f,2),k=S[0],y=S[1],h=Object(r.useState)(!1),j=Object(u.a)(h,2),g=j[0],C=j[1],A=Object(r.useState)(M[v.FOCUS]),D=Object(u.a)(A,2),R=D[0],I=D[1],N=Object(r.useState)(b.STOPPED),U=Object(u.a)(N,2),P=U[0],L=U[1],K=Object(r.useState)(v.FOCUS),w=Object(u.a)(K,2),F=w[0],H=w[1],Y=Object(r.useState)(0),B=Object(u.a)(Y,2),z=B[0],V=B[1],G=Object(r.useState)("min"),J=Object(u.a)(G,2),Z=J[0],W=J[1],q=Object(r.useCallback)(function(){C(function(e){return!e})},[]),Q=Object(r.useCallback)(function(e){x.changeMode(e)},[]),X=Object(r.useCallback)(function(){switch(P){case b.RUNNING:x.pause();break;case b.PAUSED:x.resume();break;case b.STOPPED:x.start()}},[P]),te=Object(r.useCallback)(function(e){var t=function(e){return e>=60?[Sn(e),"min"]:[Math.ceil(e),"sec"]}(e),a=Object(u.a)(t,2),n=a[0],r=a[1];I(n),W(r)},[]),ae=Object(r.useCallback)(function(e){L(e.state),te(e.remaining)},[te]),ne=Object(r.useCallback)(function(e){H(e.mode),te(e.duration)},[te]),re=Object(r.useCallback)(function(e){te(e.remaining)},[te]),oe=Object(r.useCallback)(function(e,t){var a=s;ae(e),e.mode===v.FOCUS?(O({type:n.ADD_POMODORO,meta:{completedAt:t||new Date,duration:e.duration,pure:0===e.checkpointElapsed}}),++a%4===0?x.changeMode(v.LONG):x.changeMode(v.SHORT)):x.changeMode(v.FOCUS);var r,c="",o=void 0,l=kn,u=void 0;switch(r="".concat(a," Pomodoros today!"),x.mode){case v.FOCUS:c="Start Focusing.";break;case v.SHORT:c="Take a Short Break.",o="Retry focusing if double click.",l=yn,u=hn;break;case v.LONG:c="Take a Long Break.",o="Retry focusing if double click.",l=yn,u=hn}!function(e){var t=e.title,a=e.body,n=e.option,r=void 0===n?"":n,c=e.icon,o=e.onClick,s=e.onDblclick,l=0,u=null;if("granted"===Notification.permission){var i=new Notification(t,{body:"".concat(a," ").concat(r),icon:c}),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?u=setTimeout(function(){i.close(),u=null},1e3*e):i.close()};i.onclick=function(){0===l?(l++,o(m)):(u&&clearTimeout(u),s&&s(m))}}else ce({title:t,body:a,icon:c})}({title:c,body:r,option:o,icon:_n.a,onClick:l,onDblclick:u})},[O,ae,s]),se=Object(r.useCallback)(function(){x.changeMode(v.FOCUS),m.a.defer(function(){x.start()})},[]),le=Object(r.useCallback)(function(){O({type:n.RESET_TASK_ID})},[O]),ue=Object(r.useCallback)(function(e){var t=" from firebase!",a=s,r=e.remaining;t=e.mode===v.FOCUS?++a%4===0?"Take a Long Break ".concat(t):"Take a Short Break ".concat(t):"Start Focusing ".concat(t);var c="".concat(a," Pomodoros today!");O({type:n.ADD_FB_TIMER,payload:{title:t,body:c,remaining:r}})},[O,s]),ie=Object(r.useCallback)(function(e){O({type:n.DEL_FB_TIMER})},[O]);Object(r.useEffect)(function(){return x.on("tick",re),x.on("start",ae),x.on("start",ue),x.on("stop",ae),x.on("stop",ie),x.on("pause",ae),x.on("pause",ie),x.on("resume",ae),x.on("resume",ue),x.on("expire",oe),x.on("change_mode",ne),function(){x.removeAllListeners()}},[oe,ne,ae,re,ue,ie]),Object(r.useEffect)(function(){H(x.mode),L(x.state),te(x.remaining),x.restoreExpired&&E&&(m.a.defer(function(){oe(x.status)}),x.restoreExpired=!1)},[E,oe,te]),Object(r.useEffect)(function(){var e=T()().format("YYYY-MM-DD");a&&o!==e&&(O({type:n.RESET_POMODORO,payload:{pomodoro_date:e}}),x.changeMode(v.FOCUS))},[O,a,o]),Object(r.useEffect)(function(){"denied"!==Notification.permission&&Notification.requestPermission()},[O]),Object(r.useEffect)(function(){var e=F===v.FOCUS?"#f00":"#0f0",t=F===v.FOCUS?"#fff":"#000",a="fade";if("sec"===Z){var n=[t,e];e=n[0],t=n[1],a="none"}switch(P){case b.RUNNING:Tn.badge(R,{bgColor:e,textColor:t,animation:a});break;case b.PAUSED:Tn.badge("-",{bgColor:e,textColor:t,animation:a});break;default:Tn.reset()}},[F,R,P,Z]),Object(r.useEffect)(function(){var e=60*M[F];V(.01+99*(e-("min"===Z?60*R:R))/e/100)},[F,R,Z]),Object(r.useEffect)(function(){O({type:n.SET_POMODORO_STATE,payload:{pomodoro_state:P}})},[O,P]),Object(r.useEffect)(function(){O({type:n.SET_POMODORO_MODE,payload:{pomodoro_mode:F}})},[O,F]);var me=Object(r.useCallback)(function(){y(function(e){return!e})},[]),_e=P===b.RUNNING?z:1;if(!E)return null;var de=_?"#".concat(_.ref," ").concat(m.a.get(_,"user_story_extra_info.subject","Unassigned tasks")," / ").concat(_.subject):"",Ee=_?m.a.truncate("#".concat(_.ref," ").concat(_.subject),{length:10}):"",pe=Object.values(p).some(function(e){return e>0});return c.a.createElement(we.a,{className:d()(un.a.top,"sticky-top")},c.a.createElement(cn.a,{options:{primary:F===v.FOCUS?"red":"green"}},c.a.createElement(rn.a,{buffer:_e,progress:z,closed:P===b.STOPPED})),c.a.createElement(Fe.a,{onClick:me},c.a.createElement("div",{className:"d-flex"},c.a.createElement(ft,{isOpen:k}),c.a.createElement(ze.a,{className:d()(un.a.button_group,"ml-1")},c.a.createElement(sn.a,{onClick:We,isOpen:g,toggle:q,addonType:"prepend"},c.a.createElement(Gt.a,{color:"light",size:"sm",caret:!0},c.a.createElement(bn,{mode:F})),c.a.createElement(Jt.a,null,c.a.createElement(vn,{mode:v.FOCUS,onSelect:Q}),c.a.createElement(vn,{mode:v.SHORT,onSelect:Q}),c.a.createElement(vn,{mode:v.LONG,onSelect:Q}))),c.a.createElement(Ve.a,{addonType:"prepend",onClick:We},c.a.createElement(_t.a,{className:d()(un.a.fix_w,{"font-weight-bold":P===b.RUNNING})},R)),c.a.createElement(Ve.a,{onClick:We,addonType:"prepend"},Z),c.a.createElement(Ve.a,{addonType:"append",onClick:We},P===b.RUNNING?c.a.createElement(Je.a,{color:"danger",onClick:X},c.a.createElement($.a,{icon:ee.A})):c.a.createElement(Je.a,{color:"primary",onClick:X},c.a.createElement($.a,{icon:ee.B}))),F!==v.FOCUS&&c.a.createElement(Ve.a,{addonType:"append",onClick:We},c.a.createElement(Je.a,{color:"light",onClick:se,title:"Retry focusing"},c.a.createElement($.a,{icon:ee.D,className:"text-muted"}),c.a.createElement(la,{state:aa.STALE}))),i&&c.a.createElement(on.b,{onClick:We,className:d()(un.a.chip_set)},c.a.createElement(on.a,{icon:c.a.createElement($.a,{icon:ee.I}),onRemove:le,title:de,trailingIcon:c.a.createElement($.a,{icon:ee.J})},Ee||c.a.createElement(Ct.a,{type:"grow"}))),pe&&c.a.createElement("div",{className:"ml-1"},c.a.createElement("div",{className:d()("w-100","text-light","bg-danger","text-center","rounded","shadow","font-weight-bold",un.a.live)},c.a.createElement($.a,{className:"ml-1",icon:ee.L}),c.a.createElement("span",{className:"mx-1"},"LIVE")),c.a.createElement("div",null,Object.entries(p).filter(function(e){var t=Object(u.a)(e,2);t[0];return t[1]>0}).map(function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];return c.a.createElement(He.a,{key:a,color:"light",className:"border"},c.a.createElement(bn,{mode:a}),":",n)})))),s>0&&c.a.createElement(He.a,{color:"danger",className:"mr-2"},c.a.createElement(la,null)," ",c.a.createElement($.a,{icon:ee.J})," ",s),m.a.times(s).map(function(e){return c.a.createElement(la,{key:e,state:e<l?aa.STALE:aa.FRESH,br:e%2!==s%2&&e<s-1})}))),c.a.createElement(Ye.a,{isOpen:k},c.a.createElement(ut.a,{className:"bg-grass"},c.a.createElement(fn,null))))},gn=function(){return c.a.createElement("div",{className:"container"},c.a.createElement(l.a,{className:"toast-top"}),c.a.createElement(St.a,null,c.a.createElement(Ke,null,c.a.createElement(jn,null),c.a.createElement(Tt,null),c.a.createElement(bt.Route,{exact:!0,path:"/",component:qa}),c.a.createElement(bt.Route,{exact:!0,path:"/:uid",component:nn}))))};s.a.render(c.a.createElement(gn,null),document.getElementById("root"))},56:function(e,t,a){e.exports={top:"Pomodoro_top__2KPBC",button_group:"Pomodoro_button_group__25QhE",chip_set:"Pomodoro_chip_set__UcFix",fix_w:"Pomodoro_fix_w__26hsb",short_break_icon:"Pomodoro_short_break_icon__3e20m",long_break_icon:"Pomodoro_long_break_icon__1CgqS",live:"Pomodoro_live__293Tt"}},75:function(e,t,a){e.exports={header:"UserStory_header__3lGFX",toggle_input:"UserStory_toggle_input__ARa5d",display_medal:"UserStory_display_medal__3t53K",medal:"UserStory_medal__2Zi1f",is_closed:"UserStory_is_closed__2ABQp"}},82:function(e,t,a){e.exports={fresh:"Tomato_fresh__2s5Ye",stale:"Tomato_stale__3bjHh",bl:"Tomato_bl__2-LRw",br:"Tomato_br__2_ZQQ"}}},[[263,1,2]]]);
//# sourceMappingURL=main.06460015.chunk.js.map