(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{129:function(e,t,a){e.exports={gold:"UserTasks_gold__1MP40",silver:"UserTasks_silver__GpK9Y",bronze:"UserTasks_bronze__1aHZc",custom_input_td:"UserTasks_custom_input_td__1JWmj"}},194:function(e,t,a){e.exports={header:"Controller_header__33lvE"}},233:function(e,t,a){e.exports=a(450)},238:function(e,t,a){},450:function(e,t,a){"use strict";a.r(t);var n,r,c=a(1),l=a.n(c),u=a(35),s=a.n(u),o=(a(238),a(239),a(240),a(241),a(242),a(243),a(55)),i=a(15),m=a(8),_=a.n(m),E=a(3),d=a.n(E);!function(e){e.SET_URL="SET_URL",e.SIGN_IN="SIGN_IN",e.SET_AUTH_TOKEN="SET_AUTH_TOKEN",e.SET_AUTH_ERROR="SET_AUTH_ERROR",e.SIGN_OUT="SIGN_OUT",e.FETCH_PROJECTS="FETCH_PROJECTS",e.SET_PROJECTS="SET_PROJECTS",e.SET_PID="SET_PID",e.FETCH_PROJECT="FETCH_PROJECT",e.SET_PROJECT="SET_PROJECT",e.FETCH_MILESTONES="FETCH_MILESTONES",e.SET_MID="SET_MID",e.SET_MILESTONES="SET_MILESTONES",e.SET_CUSTOM_EID="SET_CUSTOM_EID",e.SET_CUSTOM_RID="SET_CUSTOM_RID",e.FETCH_CUSTOM_ATTRS="FETCH_CUSTOM_ATTRS",e.SET_CUSTOM_ATTRS="SET_CUSTOM_ATTRS",e.SET_CUSTOM_ATTR_E="SET_CUSTOM_ATTR_E",e.SET_CUSTOM_ATTR_R="SET_CUSTOM_ATTR_R",e.SET_BIZ_DAYS="SET_BIZ_DAYS",e.ADD_BIZ_DAY="ADD_BIZ_DAY",e.REMOVE_BIZ_DAY="REMOVE_BIZ_DAY",e.FETCH_TASKS="FETCH_TASKS",e.SET_TASKS="SET_TASKS",e.PATCH_TASK="PATCH_TASK",e.FETCH_TASK_STATUSES="FETCH_TASK_STATUSES",e.SET_TASK_STATUSES="SET_TASK_STATUSES",e.SET_ACTIVE_TASK_STATUSES="SET_ACTIVE_TASK_STATUSES",e.FETCH_CUSTOM_VALUE_MAP="FETCH_CUSTOM_VALUE_MAP",e.SET_CUSTOM_VALUE_MAP="SET_CUSTOM_VALUE_MAP",e.PATCH_CUSTOM_VALUE="PATCH_CUSTOM_VALUE",e.FETCH_USER="FETCH_USER",e.SET_USER="SET_USER",e.RESET_USER="RESET_USER",e.ADD_REJECT_TASK_STATUS_ID="ADD_REJECT_TASK_STATUS",e.REMOVE_REJECT_TASK_STATUS_ID="REMOVE_REJECT_TASK_STATUS",e.OPEN_CONTROLLER="OPEN_CONTROLLER",e.CLOSE_CONTROLLER="CLOSE_CONTROLLER",e.UPDATE_DATA="UPDATE_DATA"}(n||(n={})),function(e){e.URL="taiga_url",e.PID="taiga_pid",e.MID="taiga_mid",e.CUSTOM_EID="taiga_custom_eid",e.CUSTOM_RID="taiga_custom_rid",e.BIZ_DAYS="taiga_biz_days",e.REJECT_TASK_STATUS_IDS="reject_task_status_ids",e.USERNAME="taiga_username",e.PASSWORD="taiga_password"}(r||(r={}));var p=function(e){return localStorage.getItem(e)||""},f=function(e){return p(e)},T=function(e,t){return t?p("".concat(t,"/").concat(e)):""},S=function(e,t){localStorage.setItem(e,t)},b=function(e,t,a){return t?S("".concat(t,"/").concat(e),a):null},O=function(){var e=f(r.URL),t=f(r.PID),a=f(r.MID),n=T(r.CUSTOM_EID,t),c=T(r.CUSTOM_RID,t),l=T(r.BIZ_DAYS,a),u=_.a.compact(l.split(",")).sort(),s=_.a.compact(T(r.REJECT_TASK_STATUS_IDS,t).split(",")),o=!(e&&t&&a&&n&&c);return{url:e,auth_token:"",auth_error:!1,username:"",password:"",user:null,projects:[],pid:t,project:{},mid:a,custom_eid:n,custom_rid:c,custom_attrs:[],custom_attr_e:{},custom_attr_r:{},biz_days:u,milestones:[],tasks:[],task_statuses:[],active_task_statuses:[],custom_value_map:new WeakMap,reject_task_status_ids:s,updated_time:0,isOpen:o}},v=a(52),y=a(16),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.SET_URL:var a=t.payload.url;return Object(y.a)({},e,{url:a});case n.SET_PROJECTS:var r=t.payload.projects;return Object(y.a)({},e,{projects:r});case n.SET_PID:var c=t.payload.pid;return Object(y.a)({},e,{pid:c,project:{},mid:"",custom_attrs:[],milestones:[],custom_value_map:new WeakMap});case n.SET_PROJECT:var l=t.payload.project;return Object(y.a)({},e,{project:l});case n.SET_MID:var u=t.payload.mid;return Object(y.a)({},e,{mid:u,tasks:[]});case n.SET_MILESTONES:var s=t.payload.milestones;return Object(y.a)({},e,{milestones:s});case n.SET_CUSTOM_EID:var o=t.payload.custom_eid;return Object(y.a)({},e,{custom_eid:o});case n.SET_CUSTOM_ATTRS:var i=t.payload.custom_attrs;return Object(y.a)({},e,{custom_attrs:i});case n.SET_CUSTOM_ATTR_E:var m=t.payload.custom_attr_e;return Object(y.a)({},e,{custom_attr_e:m});case n.SET_CUSTOM_ATTR_R:var E=t.payload.custom_attr_r;return Object(y.a)({},e,{custom_attr_r:E});case n.SET_CUSTOM_RID:var d=t.payload.custom_rid;return Object(y.a)({},e,{custom_rid:d});case n.SET_BIZ_DAYS:var p=t.payload.biz_days;return Object(y.a)({},e,{biz_days:p});case n.ADD_BIZ_DAY:var f=t.payload.biz_day,T=_.a.chain([].concat(Object(v.a)(e.biz_days),[f])).uniq().sort().value();return Object(y.a)({},e,{biz_days:T});case n.REMOVE_BIZ_DAY:var S=t.payload.biz_day,b=_.a.reject(Object(v.a)(e.biz_days),function(e){return e===S});return Object(y.a)({},e,{biz_days:b});case n.SET_TASKS:var j=t.payload.tasks;return Object(y.a)({},e,{tasks:j});case n.SET_TASK_STATUSES:var k=t.payload.task_statuses;return Object(y.a)({},e,{task_statuses:k});case n.SET_ACTIVE_TASK_STATUSES:var C=t.payload.active_task_statuses;return Object(y.a)({},e,{active_task_statuses:C});case n.SET_CUSTOM_VALUE_MAP:var h=t.payload.custom_value_map;return Object(y.a)({},e,{custom_value_map:h});case n.SET_USER:var A=t.payload.user;return Object(y.a)({},e,{user:A});case n.RESET_USER:return Object(y.a)({},e,{user:null});case n.ADD_REJECT_TASK_STATUS_ID:var g=t.payload.reject_task_status_id,U=_.a.chain([].concat(Object(v.a)(e.reject_task_status_ids),[g])).compact().uniq().value();return Object(y.a)({},e,{reject_task_status_ids:U});case n.REMOVE_REJECT_TASK_STATUS_ID:var x=t.payload.reject_task_status_id,N=_.a.reject(Object(v.a)(e.reject_task_status_ids),function(e){return e===x});return Object(y.a)({},e,{reject_task_status_ids:N});case n.OPEN_CONTROLLER:return Object(y.a)({},e,{isOpen:!0});case n.CLOSE_CONTROLLER:return Object(y.a)({},e,{isOpen:!1});case n.UPDATE_DATA:return Object(y.a)({},e,{updated_time:Date.now()});case n.SIGN_IN:var R=t.payload,D=R.username,M=R.password;return Object(y.a)({},e,{username:D,password:M,auth_error:!1});case n.SET_AUTH_TOKEN:var I=t.payload.auth_token;return Object(y.a)({},e,{auth_token:I});case n.SET_AUTH_ERROR:return Object(y.a)({},e,{auth_error:!0});case n.SIGN_OUT:return Object(y.a)({},e,{auth_token:"",username:"",password:""});default:return e}},k=function(e,t,a,n){return function(r){t(r),a(r,n,e)}},C=a(13),h=a.n(C),A=a(19),g=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c=r(),!(l=c.url)){e.next=8;break}return e.next=5,Z(l,"projects");case 5:u=e.sent,s=u.data,a({type:n.SET_PROJECTS,payload:{projects:s}});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),q(e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t,a,n){return e.apply(this,arguments)}}(),U=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s,o;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_PROJECT){e.next=15;break}if(e.prev=1,c=r(),l=c.url,u=t.payload.pid,!l||!u){e.next=10;break}return e.next=7,Z(l,"projects/".concat(u));case 7:s=e.sent,o=s.data,a({type:n.SET_PROJECT,payload:{project:o}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),x=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s,o;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_MILESTONES){e.next=15;break}if(e.prev=1,c=r(),l=c.url,u=t.payload.project,!l||!u){e.next=10;break}return e.next=7,Z(l,"milestones",{params:{project:u}});case 7:s=e.sent,o=s.data,a({type:n.SET_MILESTONES,payload:{milestones:o}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s,o,i,m;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_TASKS){e.next=16;break}if(e.prev=1,c=r(),l=c.url,u=c.reject_task_status_ids,s=t.payload.milestone,!l||!s){e.next=11;break}return e.next=7,Z(l,"tasks",{headers:{"x-disable-pagination":!0},params:{milestone:s}});case 7:o=e.sent,i=o.data,m=i.filter(function(e){return!_.a.includes(u,String(e.status))}),a({type:n.SET_TASKS,payload:{tasks:m}});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),q(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t,a,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s,o;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_TASK_STATUSES){e.next=15;break}if(e.prev=1,c=r(),l=c.url,u=t.payload.project,!l||!u){e.next=10;break}return e.next=7,Z(l,"task-statuses",{params:{project:u}});case 7:s=e.sent,o=s.data,a({type:n.SET_TASK_STATUSES,payload:{task_statuses:o}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),D=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s,o;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_CUSTOM_ATTRS){e.next=15;break}if(e.prev=1,c=r(),l=c.url,u=t.payload.project,!l||!u){e.next=10;break}return e.next=7,Z(l,"task-custom-attributes",{params:{project:u}});case 7:s=e.sent,o=s.data,a({type:n.SET_CUSTOM_ATTRS,payload:{custom_attrs:o}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),M=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s,o,i;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_CUSTOM_VALUE_MAP){e.next=16;break}if(e.prev=1,c=r(),l=c.url,u=c.custom_eid,s=c.custom_rid,o=t.payload.tasks,!(l&&o.length&&u&&s)){e.next=11;break}return e.t0=WeakMap,e.next=8,Promise.all(o.map(function(){var e=Object(A.a)(h.a.mark(function e(t){var a,n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(l,"tasks/custom-attributes-values/".concat(t.id));case 2:return a=e.sent,n=a.data,e.abrupt("return",[t,n]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 8:e.t1=e.sent,i=new e.t0(e.t1),a({type:n.SET_CUSTOM_VALUE_MAP,payload:{custom_value_map:i}});case 11:e.next=16;break;case 13:e.prev=13,e.t2=e.catch(1),q(e.t2);case 16:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t,a,n){return e.apply(this,arguments)}}(),I=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s,o;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_USER){e.next=15;break}if(e.prev=1,c=r(),l=c.url,u=t.payload.uid,!l||!u){e.next=10;break}return e.next=7,Z(l,"users/".concat(u));case 7:s=e.sent,o=s.data,a({type:n.SET_USER,payload:{user:o}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),P=a(42),w=a(18),H=a(14),F=function(e){var t=e.icon,a=e.message;return l.a.createElement("div",{className:"d-flex"},l.a.createElement("h2",{className:"mr-2"},l.a.createElement(w.a,{icon:t})),l.a.createElement("div",null,a))},L=function(e){o.b.success(l.a.createElement(F,{icon:H.b,message:e}))},K=function(e){o.b.error(l.a.createElement(F,{icon:H.c,message:e}))},Y=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s,o,i,m,_,E,d,p,f;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.PATCH_CUSTOM_VALUE){e.next=18;break}if(e.prev=1,c=r(),l=c.url,u=c.custom_value_map,s=c.tasks,o=t.payload,i=o.id,m=o.key,_=o.value,E=o.version,d=s.find(function(e){return e.id===i}),!(l&&i&&m&&d&&u.has(d))){e.next=13;break}if(!(p=u.get(d))){e.next=13;break}return f=p.attributes_values,e.next=11,W(l,"tasks/custom-attributes-values/".concat(i),{attributes_values:Object(y.a)({},f,Object(P.a)({},m,String(_))),version:E});case 11:a({type:n.UPDATE_DATA}),L("Custom value updated. [".concat(_,"]"));case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),q(e.t0);case 18:case"end":return e.stop()}},e,null,[[1,15]])}));return function(t,a,n){return e.apply(this,arguments)}}(),z=function(){var e=Object(A.a)(h.a.mark(function e(t,a,r){var c,l,u,s,o,i,m,_,E;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.PATCH_TASK){e.next=15;break}if(e.prev=1,c=r(),l=c.url,u=c.tasks,s=t.payload,o=s.id,i=s.key,m=s.value,_=u.find(function(e){return e.id===o}),!(l&&o&&i&&_)){e.next=10;break}return e.next=8,W(l,"tasks/".concat(o),(E={},Object(P.a)(E,i,m),Object(P.a)(E,"version",_.version),E));case 8:a({type:n.UPDATE_DATA}),L("Task updated. [".concat(i,"=").concat(m,"]"));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),q(e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])}));return function(t,a,n){return e.apply(this,arguments)}}(),J=function(){var e=Object(A.a)(h.a.mark(function e(t,a,c){var l,u,s,o,i,m,_;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.SIGN_IN){e.next=20;break}if(e.prev=1,l=c(),u=l.url,s=t.payload,o=s.username,i=s.password,!(u&&o&&i)){e.next=13;break}return e.next=7,G(u,"auth",{username:o,password:i,type:"normal"});case 7:m=e.sent,_=m.data.auth_token,a({type:n.SET_AUTH_TOKEN,payload:{auth_token:_}}),S(r.USERNAME,o),S(r.PASSWORD,i),L("".concat(o," signed in."));case 13:e.next=20;break;case 15:e.prev=15,e.t0=e.catch(1),a({type:n.SET_AUTH_ERROR}),a({type:n.SIGN_OUT}),q(e.t0);case 20:case"end":return e.stop()}},e,null,[[1,15]])}));return function(t,a,n){return e.apply(this,arguments)}}(),V=a(43),B=a.n(V),Z=function(e,t,a){return B.a.get("".concat(Q(e),"/").concat(t),a)},G=function(e,t,a,n){return B.a.post("".concat(Q(e),"/").concat(t),a,n)},W=function(e,t,a,n){return B.a.patch("".concat(Q(e),"/").concat(t),a,n)},q=function(e){var t;try{t=e.response?e.response.data._error_message:"error"}catch(a){t=a.message||a}K(t)},$=function(e,t,a){switch(e.type){case n.FETCH_PROJECTS:return void g(e,t,a);case n.FETCH_PROJECT:return void U(e,t,a);case n.FETCH_MILESTONES:return void x(e,t,a);case n.FETCH_TASKS:return void N(e,t,a);case n.FETCH_TASK_STATUSES:return void R(e,t,a);case n.FETCH_CUSTOM_ATTRS:return void D(e,t,a);case n.FETCH_CUSTOM_VALUE_MAP:return void M(e,t,a);case n.FETCH_USER:return void I(e,t,a);case n.PATCH_CUSTOM_VALUE:return void Y(e,t,a);case n.SIGN_IN:return void J(e,t,a);case n.PATCH_TASK:return void z(e,t,a);case n.SIGN_OUT:return localStorage.removeItem(r.USERNAME),localStorage.removeItem(r.PASSWORD),void(B.a.defaults.headers.common.Authorization&&delete B.a.defaults.headers.common.Authorization);case n.SET_AUTH_TOKEN:return void function(e,t,a){if(e.type===n.SET_AUTH_TOKEN){var r=e.payload.auth_token;B.a.defaults.headers.common.Authorization="Bearer ".concat(r)}}(e);case n.SET_URL:return void function(e,t,a){if(e.type===n.SET_URL){var c=e.payload.url;S(r.URL,c)}}(e);case n.SET_PID:!function(e,t,a){if(e.type===n.SET_PID){var c=e.payload.pid;S(r.PID,c);var l=T(r.CUSTOM_EID,c),u=T(r.CUSTOM_RID,c);t({type:n.SET_CUSTOM_EID,payload:{custom_eid:l}}),t({type:n.SET_CUSTOM_RID,payload:{custom_rid:u}})}}(e,t);break;case n.SET_MID:!function(e,t,a){if(e.type===n.SET_MID){var c=e.payload.mid;S(r.MID,c);var l=_.a.compact(T(r.BIZ_DAYS,c).split(",")).sort();t({type:n.SET_BIZ_DAYS,payload:{biz_days:l}})}}(e,t);break;case n.SET_CUSTOM_EID:!function(e,t,a){if(e.type===n.SET_CUSTOM_EID){var c=e.payload.custom_eid,l=a().pid;b(r.CUSTOM_EID,l,c)}}(e,0,a);break;case n.SET_CUSTOM_RID:!function(e,t,a){if(e.type===n.SET_CUSTOM_RID){var c=e.payload.custom_rid,l=a().pid;b(r.CUSTOM_RID,l,c)}}(e,0,a);break;case n.SET_BIZ_DAYS:case n.ADD_BIZ_DAY:case n.REMOVE_BIZ_DAY:!function(e,t,a){var n=a(),c=n.mid,l=n.biz_days;b(r.BIZ_DAYS,c,l.join(","))}(0,0,a);break;case n.ADD_REJECT_TASK_STATUS_ID:case n.REMOVE_REJECT_TASK_STATUS_ID:!function(e,t,a){var n=a(),c=n.pid,l=n.reject_task_status_ids;b(r.REJECT_TASK_STATUS_IDS,c,l.join(","))}(0,0,a)}},Q=function(e){return"".concat(e.replace(/[\xa5\/]$/,""),"/api/v1")},X=function(e,t){return _.a.find(e,{id:t})},ee=O(),te=Object(c.createContext)({state:ee,dispatch:function(e){}}),ae=function(e){var t=e.children,a=function(e,t){var a=Object(i.a)(e,2),n=a[0],r=a[1],l=null,u=Object(c.useCallback)(function(e){l&&l(e)},[l]),s=Object(c.useMemo)(function(){return function(){var e;return{getter:function(){return e},setter:function(t){e=t}}}()},[]);return s.setter(n),[n,l=Object(c.useCallback)(k(s.getter,r,t,u),[])]}(Object(c.useReducer)(j,ee),$),u=Object(i.a)(a,2),s=u[0],o=u[1],m={state:s,dispatch:o};return Object(c.useEffect)(function(){s.url&&o({type:n.FETCH_PROJECTS})},[o,s.url]),Object(c.useEffect)(function(){s.url&&s.pid&&(o({type:n.FETCH_MILESTONES,payload:{project:s.pid}}),o({type:n.FETCH_CUSTOM_ATTRS,payload:{project:s.pid}}),o({type:n.FETCH_TASK_STATUSES,payload:{project:s.pid}}),o({type:n.FETCH_PROJECT,payload:{pid:s.pid}}))},[s.url,s.pid,o]),Object(c.useEffect)(function(){s.url&&s.mid&&o({type:n.FETCH_TASKS,payload:{milestone:s.mid,reject_task_status_ids:s.reject_task_status_ids}})},[s.url,s.mid,s.updated_time,s.reject_task_status_ids,o]),Object(c.useEffect)(function(){o({type:n.FETCH_CUSTOM_VALUE_MAP,payload:{tasks:s.tasks}})},[o,s.tasks,s.custom_eid,s.custom_rid]),Object(c.useEffect)(function(){var e=_.a.chain(s.task_statuses).reject(function(e){return _.a.includes(s.reject_task_status_ids,String(e.id))}).orderBy(function(e){return e.order}).value();o({type:n.SET_ACTIVE_TASK_STATUSES,payload:{active_task_statuses:e}})},[s.task_statuses,s.reject_task_status_ids,o]),Object(c.useEffect)(function(){var e=X(s.custom_attrs,Number(s.custom_eid));e&&o({type:n.SET_CUSTOM_ATTR_E,payload:{custom_attr_e:e}})},[o,s.custom_attrs,s.custom_eid]),Object(c.useEffect)(function(){var e=X(s.custom_attrs,Number(s.custom_rid));e&&o({type:n.SET_CUSTOM_ATTR_R,payload:{custom_attr_r:e}})},[o,s.custom_attrs,s.custom_rid]),Object(c.useEffect)(function(){!function(e){var t=f(r.USERNAME),a=f(r.PASSWORD);e({type:n.SIGN_IN,payload:{username:t,password:a}})}(o)},[o]),l.a.createElement(te.Provider,{value:m},t)},ne=a(458),re=a(459),ce=a(462),le=a(463),ue=a(464),se=a(453),oe=a(454),ie=a(455),me=a(195),_e=function(e){e.preventDefault()},Ee=function(e){e.stopPropagation()},de=function(){var e=Object(c.useContext)(te),t=e.state,a=t.pid,r=t.projects,u=e.dispatch,s=Object(c.useCallback)(function(e){var t=e.target.value;t&&u({type:n.SET_PID,payload:{pid:t}})},[u]);return l.a.createElement(se.a,{className:"col"},l.a.createElement(oe.a,{addonType:"prepend"},"Project"),l.a.createElement(ie.a,{value:a,type:"select",onChange:s},l.a.createElement("option",{value:""}," --- "),r.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)})))},pe=function(){var e=Object(c.useContext)(te),t=e.state,a=t.milestones,r=t.mid,u=e.dispatch,s=Object(c.useCallback)(function(e){var t=e.target.value;t&&u({type:n.SET_MID,payload:{mid:t}})},[u]);return l.a.createElement(se.a,{className:"col"},l.a.createElement(oe.a,{addonType:"prepend"},"Sprint"),l.a.createElement(ie.a,{type:"select",value:r,onChange:s},l.a.createElement("option",{value:""}," --- "),a.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)})))},fe=function(){var e=Object(c.useContext)(te),t=e.state,a=t.custom_attrs,r=t.custom_eid,u=t.custom_rid,s=e.dispatch,o=Object(c.useCallback)(function(e){var t=e.target.value;if(t)switch(e.target.name){case"eid":s({type:n.SET_CUSTOM_EID,payload:{custom_eid:t}});break;case"rid":s({type:n.SET_CUSTOM_RID,payload:{custom_rid:t}});break;default:console.log("other id")}},[s]);return l.a.createElement("div",{className:"row"},l.a.createElement(se.a,{className:"col"},l.a.createElement(oe.a,{addonType:"prepend"},"Estimate"),l.a.createElement(ie.a,{value:r,name:"eid",type:"select",onChange:o},l.a.createElement("option",{value:""}," --- "),a.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)}))),l.a.createElement(se.a,{className:"col"},l.a.createElement(oe.a,{addonType:"prepend"},"Result"),l.a.createElement(ie.a,{value:u,name:"rid",type:"select",onChange:o},l.a.createElement("option",null," --- "),a.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)}))))},Te=a(456),Se=a(457),be=a(475),Oe=a(460),ve=a(22),ye=a.n(ve),je=a(97),ke=a.n(je),Ce=function(e,t){return-1===t?"":0===t?"Planning":"Day ".concat(t)},he=function(e,t){return t.find(function(t){return String(t.id)===e})},Ae=function(e){return{"text-danger":0===e,"text-info":6===e}},ge=function(e){var t=e.item,a=e.biz_days,r=e.idx,u=Object(c.useContext)(te).dispatch,s=Object(c.useCallback)(function(e){var t=e.target.value;e.target.checked?u({type:n.ADD_BIZ_DAY,payload:{biz_day:t}}):u({type:n.REMOVE_BIZ_DAY,payload:{biz_day:t}})},[u]);if(!t)return l.a.createElement("td",null,l.a.createElement("br",null));var o=t.format("YYYY-MM-DD"),i=o===a[0],m="biz-day-".concat(o);return l.a.createElement(l.a.Fragment,null,l.a.createElement("td",{className:d()(Ae(r),{"table-info":i}),id:m},ke.a.isWeekDay(t)?l.a.createElement(Te.a,{check:!0,inline:!0},l.a.createElement(Se.a,{check:!0},l.a.createElement(ie.a,{onChange:s,disabled:ke.a.isWeekendDay(t),value:o,type:"checkbox",checked:_.a.includes(a,o),className:"form-check-input"}),o)):l.a.createElement("span",null,o)),_.a.includes(a,o)?l.a.createElement(be.a,{target:m},function(e,t){var a=t.indexOf(e);return Ce(0,a)}(o,a)):null)},Ue=function(){var e=Object(c.useContext)(te),t=e.state,a=t.mid,r=t.milestones,u=t.biz_days,s=e.dispatch,o=Object(c.useState)([]),m=Object(i.a)(o,2),E=m[0],p=m[1];if(Object(c.useEffect)(function(){var e,t=he(a,r);if(t){var c=function(e){var t=ye()(e.estimated_start).local(),a=ye()(e.estimated_finish).local().diff(t,"days");return _.a.times(a).map(function(e){return t.clone().add(e,"days")})}(t);p(c),u.length<=1&&s({type:n.SET_BIZ_DAYS,payload:{biz_days:(e=c,e.filter(function(e){return ke.a.isWeekDay(e)}).map(function(e){return e.format("YYYY-MM-DD")}))}})}},[a,r,u,s]),0===E.length)return null;var f=_.a.chunk([].concat(Object(v.a)(_.a.times(E[0].day(),function(){return null})),Object(v.a)(E)),7);return l.a.createElement(ne.a,null,l.a.createElement(re.a,null,"Business Days"),l.a.createElement(Oe.a,{bordered:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,ye.a.weekdays().map(function(e,t){return l.a.createElement("th",{key:t,className:d()("text-center",Ae(t))},e)}))),l.a.createElement("tbody",null,f.map(function(e,t){return l.a.createElement("tr",{key:t},e.map(function(e,t){return l.a.createElement(ge,{idx:t,key:t,item:e,biz_days:u})}))}))))},xe=a(461),Ne=function(e){var t=e.item,a=Object(c.useContext)(te),r=a.state.reject_task_status_ids,u=a.dispatch,s=Object(c.useCallback)(function(e){var t=e.target.value;e.target.checked?u({type:n.REMOVE_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}}):u({type:n.ADD_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}})},[u]);return l.a.createElement(Te.a,{check:!0,inline:!0},l.a.createElement(Se.a,{check:!0},l.a.createElement(ie.a,{onChange:s,type:"checkbox",value:t.id,defaultChecked:!_.a.includes(r,String(t.id))}),t.name))},Re=function(){var e=Object(c.useContext)(te).state.task_statuses;return 0===e.length?null:l.a.createElement(ne.a,null,l.a.createElement(re.a,null,"Task status"),l.a.createElement(xe.a,null,e.map(function(e){return l.a.createElement(Ne,{key:e.id,item:e})})))},De=a(194),Me=a.n(De),Ie=function(e){var t=e.isOpen?90:void 0;return l.a.createElement(w.a,{className:"text-muted mr-2",rotation:t,icon:H.d})},Pe=function(){var e=Object(c.useContext)(te),t=e.state,a=t.url,r=t.isOpen,u=t.mid,s=t.milestones,o=t.biz_days,m=e.dispatch,E=Object(c.useState)(""),p=Object(i.a)(E,2),f=p[0],T=p[1],S=Object(c.useCallback)(function(e){T(e.target.value)},[T]),b=Object(c.useCallback)(function(e){f&&m({type:n.SET_URL,payload:{url:f}}),e.preventDefault()},[f,m]),O=Object(c.useCallback)(function(){m(r?{type:n.CLOSE_CONTROLLER}:{type:n.OPEN_CONTROLLER})},[m,r]),v=function(e,t,a){var n=he(t,a);return e&&n?"".concat(e,"/project/").concat(n.project_extra_info.slug,"/taskboard/").concat(n.slug):""}(a,u,s);return l.a.createElement(ne.a,null,l.a.createElement(re.a,{className:d()(Me.a.header),onClick:O},l.a.createElement(Ie,{isOpen:r}),l.a.createElement(ce.a,{color:"primary",pill:!0,className:"p-1 m-1"},l.a.createElement("span",null,function(e,t){return _.a.get(he(e,t),"name","")}(u,s))),l.a.createElement(ce.a,{className:"p-1 m-1"},l.a.createElement("span",null,function(e){return e.length>1?"[".concat(_.a.head(e)," - ").concat(_.a.last(e),"]"):""}(o))),v?l.a.createElement("a",{target:"_blank",onClick:Ee,className:"float-right",href:v,rel:"noopener noreferrer"},l.a.createElement(w.a,{className:"mr-1",icon:H.j}),"Taskboard"):null),l.a.createElement(le.a,{isOpen:r},l.a.createElement(ue.a,{onSubmit:b},l.a.createElement(se.a,null,l.a.createElement(oe.a,{addonType:"prepend"},"URL"),l.a.createElement(ie.a,{defaultValue:a,onChange:S,placeholder:"http://hostname:port"}),l.a.createElement(oe.a,{addonType:"append"},l.a.createElement(me.a,null,"Set")))),l.a.createElement("div",{className:"row"},l.a.createElement(de,null),l.a.createElement(pe,null)),l.a.createElement(fe,null),l.a.createElement(Ue,null),l.a.createElement(Re,null)))},we=a(64),He=a(49),Fe=a(209),Le=a(474),Ke=a(472),Ye=a(191),ze=function(){var e=Object(c.useContext)(te).dispatch,t=Object(c.useCallback)(function(){e({type:n.UPDATE_DATA})},[e]);return l.a.createElement(me.a,{onClick:t},l.a.createElement(w.a,{icon:H.u}))},Je=a(129),Ve=a.n(Je),Be=a(466),Ze=a(473),Ge=a(469),We=a(470),qe=a(471),$e=function(){return l.a.createElement(oe.a,{addonType:"append"},l.a.createElement(Ye.a,null,l.a.createElement(w.a,{icon:H.t,className:"fa-pulse"})))},Qe=a(465),Xe=a(476),et=a(467),tt=a(468),at=a(100),nt=a.n(at),rt=a(99),ct=a.n(rt),lt=a(68),ut=a.n(lt),st=a(208),ot=a(98),it=a.n(ot),mt=function(e){return _.a.chain(e).groupBy("user_story").map(function(e,t){return{user_story:Number(t),user_story_extra_info:e[0].user_story_extra_info,project_extra_info:e[0].project_extra_info,tasks:e,is_closed:e.every(function(e){return e.is_closed})}}).value()},_t=function(e){return e?"Need sign in!":""},Et=function(e){var t=e.user_story_extra_info,a=e.project_extra_info,n=Object(c.useContext)(te).state.url,r=a.slug,u=t?"#".concat(t.ref," ").concat(t.subject):void 0,s=t?"".concat(n,"/project/").concat(r,"/us/").concat(t.ref):"#";return u?l.a.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer",title:u},l.a.createElement(w.a,{icon:H.j})," ",u):l.a.createElement(l.a.Fragment,null,"(Unassigned tasks)")},dt=function(e){var t=e.item,a=Object(c.useContext)(te).state.url,n="#".concat(t.ref," ").concat(t.subject),r="".concat(a,"/project/").concat(t.project_extra_info.slug,"/task/").concat(t.ref);return l.a.createElement("a",{href:r,target:"_blank",rel:"noopener noreferrer",title:n},l.a.createElement(w.a,{icon:H.j})," ",n)},pt=function(e){var t=e.label,a=e.value,n=e.onSubmit,r=e.valid,u=e.invalid,s=e.disabled,o=e.loading,m=Object(c.useState)(!1),_=Object(i.a)(m,2),E=_[0],d=_[1],p=Object(c.useState)(""),f=Object(i.a)(p,2),T=f[0],S=f[1],b=Object(c.useCallback)(function(e){d(e.currentTarget.checked)},[d]),O=Object(c.useCallback)(function(e){S(e.target.value)},[S]),v=Object(c.useCallback)(function(e){var t=Number(T);E&&""!==T&&t>=0&&n&&(n(t),d(!1)),e.preventDefault()},[E,T,n,d]);Object(c.useEffect)(function(){s&&d(!1)},[d,s]);var y=_t(s);return l.a.createElement(ue.a,{inline:!0,onSubmit:v},l.a.createElement(se.a,{className:ut.a.toggle_input},l.a.createElement(oe.a,{addonType:"prepend"},t),o?l.a.createElement($e,null):l.a.createElement(l.a.Fragment,null,E?l.a.createElement(l.a.Fragment,null,l.a.createElement(oe.a,{addonType:"prepend"},l.a.createElement(it.a,null,a)),l.a.createElement(oe.a,{addonType:"prepend"},l.a.createElement(it.a,null,l.a.createElement(w.a,{className:"text-info",icon:H.n}))),l.a.createElement(ie.a,{onInput:O,onChange:O,defaultValue:String(a),type:"number",step:"0.5",min:"0"}),l.a.createElement(oe.a,{addonType:"append"},l.a.createElement(me.a,{color:"info"},l.a.createElement(w.a,{icon:H.e})))):l.a.createElement(ie.a,{valid:r,invalid:u,readOnly:!0,value:a}),l.a.createElement(oe.a,{addonType:"append",title:y},l.a.createElement(st.a,{disabled:s,checked:E,onChange:b},l.a.createElement(w.a,{className:"text-info",icon:H.g}))))))},ft=function(e){var t=e.e,a=e.r;return l.a.createElement(se.a,{className:ut.a.display_medal},l.a.createElement(oe.a,{addonType:"prepend"},"Grade"),l.a.createElement(it.a,{className:ut.a.medal},l.a.createElement(Zt,{e:t,r:a})))},Tt=function(e){var t=e.item,a=e.task,r=e.onSelect,u=Object(c.useContext)(te).dispatch,s=Object(c.useCallback)(function(){u({type:n.PATCH_TASK,payload:{key:"status",value:t.id,id:a.id}}),r&&r(t.id)},[u,t.id,a.id,r]);return l.a.createElement(Qe.a,{onClick:s},t.name)},St=function(e){var t=e.task,a=e.disabled,n=Object(c.useState)(!1),r=Object(i.a)(n,2),u=r[0],s=r[1],o=Object(c.useContext)(te).state.active_task_statuses,m=Object(c.useCallback)(function(){s(!0)},[s]);return Object(c.useEffect)(function(){s(!1)},[t.version,s]),l.a.createElement(l.a.Fragment,null,u?l.a.createElement(Be.a,{type:"grow",color:"info"}):l.a.createElement(Xe.a,null,l.a.createElement(et.a,{title:_t(a),disabled:a,caret:!a},t.status_extra_info.name),l.a.createElement(tt.a,null,o.map(function(e){return l.a.createElement(Tt,{item:e,key:e.id,task:t,onSelect:m})}))))},bt=function(e){var t=e.item,a=e.onSelect,n=Object(c.useCallback)(function(){a&&a(t.id)},[t.id,a]);return l.a.createElement(Qe.a,{onClick:n},l.a.createElement(Lt,{src:t.photo}),t.username)},Ot=function(e){var t=e.task,a=e.disabled,r=Object(c.useState)(!1),u=Object(i.a)(r,2),s=u[0],o=u[1],m=Object(c.useContext)(te),_=m.state.project.members,E=m.dispatch,d=Object(c.useCallback)(function(e){o(!0),E({type:n.PATCH_TASK,payload:{key:"assigned_to",value:e,id:t.id}})},[E,t.id]);return Object(c.useEffect)(function(){o(!1)},[t.version,o]),l.a.createElement(l.a.Fragment,null,s?l.a.createElement(Be.a,{type:"grow",color:"info"}):l.a.createElement(Xe.a,null,l.a.createElement(et.a,{title:_t(a),size:"sm",disabled:a,caret:!a},"Assign To"),l.a.createElement(tt.a,null,(_||[]).map(function(e){return l.a.createElement(bt,{item:e,onSelect:d,key:e.id})}))))},vt=function(e){var t=e.task,a=Object(c.useState)(!1),r=Object(i.a)(a,2),u=r[0],s=r[1],o=Object(c.useContext)(te).dispatch,m=Object(c.useCallback)(function(){s(!0),o({type:n.PATCH_TASK,payload:{key:"assigned_to",value:null,id:t.id}})},[o,t.id]);return Object(c.useEffect)(function(){s(!1)},[t.version,s]),l.a.createElement(l.a.Fragment,null,u?l.a.createElement(Be.a,{type:"grow",color:"danger"}):l.a.createElement(me.a,{className:"mr-2",title:"Not assigned",color:"danger",onClick:m},l.a.createElement(w.a,{icon:H.x})))},yt=function(e){var t=e.item,a=Object(c.useContext)(te),r=a.state,u=r.custom_attrs,s=r.custom_eid,o=r.custom_value_map,i=r.auth_token,m=a.dispatch,_=zt(o,t),E=Object(c.useCallback)(function(e){_&&m({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:s,value:e,version:_}})},[m,t.id,s,_]),d=qt(u,Number(s));if(!d)return null;var p=Kt(o,t,d.id),f=!p,T=""===i,S=!_;return l.a.createElement(pt,{onSubmit:E,label:d.name,value:p,invalid:f,disabled:T,loading:S})},jt=function(e){var t=e.item,a=Object(c.useContext)(te),r=a.state,u=r.custom_attrs,s=r.custom_eid,o=r.custom_rid,i=r.custom_value_map,m=r.auth_token,_=a.dispatch,E=zt(i,t),p=Object(c.useCallback)(function(e){E&&_({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:s,value:e,version:E}})},[_,t.id,s,E]),f=Object(c.useCallback)(function(e){E&&_({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:o,value:e,version:E}})},[o,_,t.id,E]),T=qt(u,Number(s)),S=qt(u,Number(o));if(!T||!S)return null;var b=Kt(i,t,T.id),O=Kt(i,t,S.id),v=!b,y=Jt(b,O,t.is_closed),j=Vt(b,O),k=""===m,C=!E,h=0===O&&!t.is_closed&&!k&&!C;return l.a.createElement(ct.a,{className:d()(Object(P.a)({},ut.a.is_closed,t.is_closed))},l.a.createElement("div",{className:"d-flex mb-1"},l.a.createElement("div",{className:"mr-auto text-truncate"},l.a.createElement(dt,{item:t})),h&&l.a.createElement(vt,{task:t}),l.a.createElement(St,{task:t,disabled:k})),l.a.createElement(Ge.a,null,l.a.createElement(We.a,null,l.a.createElement(pt,{onSubmit:p,label:T.name,value:b,invalid:v,disabled:k,loading:C})),l.a.createElement(We.a,null,l.a.createElement(pt,{onSubmit:f,label:S.name,value:O,valid:y,invalid:j,disabled:k,loading:C})),l.a.createElement(We.a,null,l.a.createElement(ft,{e:b,r:O}))))},kt=function(e){var t=e.item;return l.a.createElement(ne.a,null,l.a.createElement(re.a,{className:"text-truncate"},l.a.createElement(Et,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),l.a.createElement(nt.a,null,t.tasks.map(function(e){return l.a.createElement(ct.a,{key:e.id,className:"text-truncate"},l.a.createElement("div",{className:"d-flex"},l.a.createElement("div",{className:"mr-auto text-truncate"},l.a.createElement(dt,{item:e})),l.a.createElement(yt,{item:e})))})))},Ct=function(e){var t=e.item,a=""===Object(c.useContext)(te).state.auth_token;return l.a.createElement(ne.a,null,l.a.createElement(re.a,{className:"text-truncate"},l.a.createElement(Et,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),l.a.createElement(le.a,{isOpen:!0},l.a.createElement(nt.a,null,t.tasks.map(function(e){return l.a.createElement(ct.a,{key:e.id},l.a.createElement("div",{className:"d-flex"},l.a.createElement("div",{className:"mr-auto text-truncate"},l.a.createElement(dt,{item:e})),l.a.createElement(Ot,{task:e,disabled:a})))}))))},ht=function(e){var t=e.item,a=Object(c.useState)(!1),n=Object(i.a)(a,2),r=n[0],u=n[1],s=Object(c.useCallback)(function(){u(!r)},[r,u]);return Object(c.useEffect)(function(){u(!t.is_closed)},[t.is_closed,u]),l.a.createElement(ne.a,null,l.a.createElement(re.a,{className:d()(ut.a.header,"text-truncate",{"alert-primary":t.is_closed}),onClick:s},l.a.createElement(Ie,{isOpen:r}),l.a.createElement(Et,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),l.a.createElement(le.a,{isOpen:r},l.a.createElement(nt.a,null,t.tasks.map(function(e){return l.a.createElement(jt,{item:e,key:e.id})}))))},At=function(e){var t=e.userInfo,a=Object(c.useContext)(te).state,n=a.tasks,r=a.custom_attrs,u=a.custom_value_map,s=a.custom_eid,o=a.custom_rid,m=a.biz_days,_=Object(c.useState)([]),E=Object(i.a)(_,2),p=E[0],f=E[1],T=Object(c.useState)([]),S=Object(i.a)(T,2),b=S[0],O=S[1];Object(c.useEffect)(function(){var e=n.filter(function(e){return e.assigned_to===t.id}).sort(function(e,t){return e.user_story-t.user_story});f(e);var a=mt(e);O(a)},[n,t.id]);var v=Object(c.useMemo)(function(){return qt(r,Number(s))},[r,s]),y=Object(c.useMemo)(function(){return qt(r,Number(o))},[r,o]),j=Object(c.useMemo)(function(){return p.reduce(function(e,t){return[e[0]+(v?Kt(u,t,v.id):0),e[1]+(y?Kt(u,t,y.id):0)]},[0,0])},[v,y,u,p]),k=Object(i.a)(j,2),C=k[0],h=k[1],A=Object(c.useMemo)(function(){return Jt(C,h,b.every(function(e){return e.is_closed}))},[C,h,b]),g=Object(c.useMemo)(function(){return Vt(C,h)},[C,h]),U=Object(c.useMemo)(function(){return p.some(function(e){return!zt(u,e)})},[u,p]);return!v||!y||m.length<=1?null:l.a.createElement(l.a.Fragment,null,b.map(function(e){return l.a.createElement(ht,{item:e,key:e.user_story})}),l.a.createElement(ne.a,null,l.a.createElement(re.a,{className:d()("alert-info")},"Total"),l.a.createElement(xe.a,null,l.a.createElement(Ge.a,null,l.a.createElement(We.a,null,l.a.createElement(se.a,null,l.a.createElement(oe.a,{addonType:"prepend"},v.name),U?l.a.createElement($e,null):l.a.createElement(ie.a,{readOnly:!0,value:C}))),l.a.createElement(We.a,null,l.a.createElement(se.a,null,l.a.createElement(oe.a,{addonType:"prepend"},y.name),U?l.a.createElement($e,null):l.a.createElement(ie.a,{readOnly:!0,value:h,invalid:g,valid:A}))),l.a.createElement(We.a,null,l.a.createElement(ft,{e:C,r:h})))),l.a.createElement(qe.a,null,l.a.createElement(Gt,{tasks:p}))))},gt=function(e){var t=e.userInfo;return l.a.createElement(ne.a,null,l.a.createElement(re.a,null,l.a.createElement(Lt,{src:t.photo,size:"xlarge"}),t.username," 's task"))},Ut=a(45),xt=function(e,t){return e.filter(function(e){return ye()(t).endOf("days").diff(ye()(e.created_date))>0})},Nt=function(e,t,a){return _.a.chain(t).map(function(t){return Kt(e,t,Number(a))}).sum().value()},Rt=function(e){var t=e.tasks,a=Object(c.useState)([]),n=Object(i.a)(a,2),r=n[0],u=n[1],s=Object(c.useContext)(te).state,o=s.biz_days,m=s.custom_value_map,_=s.custom_eid,E=s.custom_attr_e,d=s.custom_attr_r;Object(c.useEffect)(function(){var e=o.length;if(e>0&&t.length>0&&_){var a=Nt(m,xt(t,o[0]),_),n=o.map(function(n,r){var c=Ce(0,r),l=a-a*r/(e-1);if(ye()().local().endOf("days").diff(ye()(n))>0){var u=0===r?0:Nt(m,function(e,t){return e.filter(function(e){return ye()(t).local().format("YYYY-MM-DD")===ye()(e.created_date).local().format("YYYY-MM-DD")})}(t,n),_);return{label:c,estimate:l,result:Nt(m,xt(t,n),_)-u-Nt(m,function(e,t){return e.filter(function(e){return!!e.finished_date&&ye()(t).local().endOf("days").diff(ye()(e.finished_date))>0})}(t,n),_),add:u}}return{label:c,estimate:l}});u(n)}else u([])},[t,o,_,m,u]);var p=Object(c.useCallback)(function(e){switch(e){case"estimate":return E.name||e;case"result":return d.name||e;default:return e}},[E.name,d.name]),f=Object(c.useCallback)(function(e,t){return[Number(e).toFixed(1),p(t)]},[p]);return 0===r.length?null:l.a.createElement(ne.a,{className:"mb-2"},l.a.createElement(re.a,null,"Burn down chart"),l.a.createElement(Ut.b,{data:r,width:800,height:400},l.a.createElement(Ut.g,null),l.a.createElement(Ut.f,{dataKey:"label"}),l.a.createElement(Ut.e,{formatter:f}),l.a.createElement(Ut.c,{formatter:p}),l.a.createElement(Ut.a,{dataKey:"result",fill:"#8884d8",stackId:"a"}),l.a.createElement(Ut.a,{dataKey:"add",fill:"#82ca9d",stackId:"a"}),l.a.createElement(Ut.d,{dataKey:"estimate"})))},Dt=function(e){var t=e.userInfo,a=Object(c.useState)([]),n=Object(i.a)(a,2),r=n[0],u=n[1],s=Object(c.useContext)(te).state.tasks;return Object(c.useEffect)(function(){var e=s.filter(function(e){return e.assigned_to===t.id}).sort(function(e,t){return e.user_story-t.user_story});u(e)},[s,t.id]),l.a.createElement(Rt,{tasks:r})},Mt=a(205),It=a.n(Mt),Pt=function(){var e=Object(c.useContext)(te),t=e.state,a=t.auth_token,r=t.auth_error,u=t.username,s=e.dispatch,o=Object(c.useState)(""),m=Object(i.a)(o,2),_=m[0],E=m[1],d=Object(c.useState)(""),p=Object(i.a)(d,2),f=p[0],T=p[1],S=Object(c.useState)(!1),b=Object(i.a)(S,2),O=b[0],v=b[1],y=Object(c.useCallback)(function(e){_&&f&&(v(!0),s({type:n.SIGN_IN,payload:{username:_,password:f}})),e.preventDefault()},[f,_,s,v]),j=Object(c.useCallback)(function(e){E(e.target.value)},[E]),k=Object(c.useCallback)(function(e){T(e.target.value)},[T]),C=Object(c.useCallback)(function(){s({type:n.SIGN_OUT})},[s]);return Object(c.useEffect)(function(){(r||a)&&v(!1)},[r,a,v]),l.a.createElement(l.a.Fragment,null,a?l.a.createElement(ue.a,{inline:!0,onSubmit:_e,className:"mr-1"},l.a.createElement(se.a,null,l.a.createElement(oe.a,{addonType:"prepend"},l.a.createElement(Ye.a,null,l.a.createElement(w.a,{icon:H.w}))),l.a.createElement(oe.a,{addonType:"prepend",className:"border border-success"},l.a.createElement(Ye.a,null,u)),l.a.createElement(oe.a,{addonType:"append"},l.a.createElement(me.a,{title:"Sign out",onClick:C,color:"danger"},l.a.createElement(w.a,{icon:H.s}))))):l.a.createElement(ue.a,{inline:!0,onSubmit:y,className:"mr-1"},l.a.createElement(se.a,null,l.a.createElement(oe.a,{addonType:"prepend"},l.a.createElement(Ye.a,null,l.a.createElement(w.a,{icon:H.w}))),l.a.createElement(ie.a,{disabled:O,onInput:j,onChange:j,name:"username",placeholder:"username",invalid:r})),l.a.createElement(se.a,null,l.a.createElement(oe.a,{addonType:"prepend"},l.a.createElement(Ye.a,null,l.a.createElement(w.a,{icon:H.p}))),l.a.createElement(ie.a,{disabled:O,onInput:k,onChange:k,name:"password",placeholder:"password",type:"password",invalid:r})),l.a.createElement(me.a,{color:"info"},O?l.a.createElement(Be.a,{size:"sm",type:"grow"}):l.a.createElement(w.a,{icon:H.r}))))},wt=function(){var e=Object(c.useContext)(te),t=e.state.user,a=e.dispatch,r=It()().match.params.uid;return Object(c.useEffect)(function(){return r&&a({type:n.FETCH_USER,payload:{uid:r}}),function(){a({type:n.RESET_USER})}},[a,r]),l.a.createElement(l.a.Fragment,null,l.a.createElement(Ke.a,{color:"light",light:!0},l.a.createElement(me.a,{tag:we.b,to:"/",className:"mr-auto"},l.a.createElement(w.a,{icon:H.a})," Go back"),l.a.createElement(Pt,null),l.a.createElement(ze,null)),t?l.a.createElement(l.a.Fragment,null,l.a.createElement(gt,{userInfo:t}),l.a.createElement("br",null),l.a.createElement(At,{userInfo:t}),l.a.createElement("br",null),l.a.createElement(Dt,{userInfo:t})):l.a.createElement(Ze.a,{color:"danger"},"This user does not exist."))},Ht=["success","warning","info","danger"],Ft=function(e){return _.a.groupBy(e,"assigned_to")},Lt=function(e){var t=e.src||"http://i.pravatar.cc/80?u=".concat(Math.random());return l.a.createElement(Fe.a,Object.assign({},e,{src:t,square:!0,className:"mr-1"}))},Kt=function(e,t,a){return e.has(t)?(n=_.a.get(e.get(t),"attributes_values.".concat(a),"0"),_.a.chain(n).replace(/[^0-9.+,]/g,"").replace(/[+]/g,",").split(",").compact().map(Number).sum().value()):0;var n},Yt=function(e,t,a){return _.a.chain(t).map(function(t){return Kt(e,t,a)}).sum().value()},zt=function(e,t){return e.has(t)?_.a.get(e.get(t),"version"):void 0},Jt=function(e,t,a){return a&&t===e},Vt=function(e,t){return t>e},Bt=function(e){var t=e.username,a=e.val,n=e.total,r=e.imgSrc;if(!a)return l.a.createElement(l.a.Fragment,null,l.a.createElement("td",null,l.a.createElement(Lt,{src:r})," ",t),l.a.createElement("td",null));var c,u,s=(a-n)/n;return s<-.1?(c=H.l,u=""):s<=.1?(u="table-success",c=H.l):s<=.2?(u="table-warning",c=H.m):(u="table-danger",c=H.f),l.a.createElement(l.a.Fragment,null,l.a.createElement("td",{className:u},l.a.createElement(Lt,{src:r})," ",t,l.a.createElement(w.a,{className:"mx-1",icon:c})),l.a.createElement("td",{className:d()(u,"text-right")},a))},Zt=function(e){var t=function(e,t){if(_.a.isNumber(e)&&_.a.isNumber(t)&&e>0){var a=Math.abs(e-t)/e;if(a<=.05)return["gold",3];if(a<=.1)return["silver",2];if(a<.2)return["bronze",1]}return[null,0]}(e.e,e.r),a=Object(i.a)(t,2),n=a[0],r=a[1];return n?l.a.createElement(l.a.Fragment,null,_.a.times(r).map(function(e){return l.a.createElement(w.a,{key:e,className:Ve.a[n],icon:H.q})})):null},Gt=function(e){var t=e.tasks,a=Object(c.useContext)(te).state,n=a.active_task_statuses,r=a.custom_eid,u=a.custom_value_map,s=Object(c.useState)([]),o=Object(i.a)(s,2),m=o[0],E=o[1],d=Object(c.useState)(0),p=Object(i.a)(d,2),f=p[0],T=p[1],S=Number(r);return Object(c.useEffect)(function(){var e=_.a.chain(n).filter({is_closed:!0}).reverse().map(function(e,a){return{status:e.id,total:Yt(u,_.a.filter(t,{status:e.id}),S),style:Ht[a],label:e.name}}).value();E(e)},[n,S,u,E,t]),Object(c.useEffect)(function(){var e=Yt(u,t,S);T(e)},[S,u,T,t]),l.a.createElement(Le.a,{multi:!0},m.map(function(e){return l.a.createElement(Le.a,{key:e.label,bar:!0,max:f,value:e.total,color:e.style},e.label)}))},Wt=function(e){var t=e.item,a=e.sums,n=e.isPast,r=e.total,u=e.hpd,s=e.tasks,o=Object(c.useState)(0),m=Object(i.a)(o,2),E=m[0],d=m[1],p=Object(c.useCallback)(function(e){d(Number(e.target.value)||0)},[d]),f=_.a.get(a,t.id),T=_.a.get(f,"e"),S=_.a.get(f,"r"),b=E||r,O=String(b);return l.a.createElement("tr",{key:t.id},r>0?l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt,{username:t.username,val:T,total:b,imgSrc:t.photo}),l.a.createElement("td",{className:"text-right"},r),l.a.createElement("td",{className:Ve.a.custom_input_td},l.a.createElement(ie.a,{bsSize:"sm",type:"number",className:"text-right",value:O,step:u,onChange:p}))):l.a.createElement(l.a.Fragment,null,l.a.createElement("td",null,l.a.createElement(Lt,{src:t.photo}),l.a.createElement(we.b,{to:"/".concat(t.id)},t.username)),l.a.createElement("td",{className:"text-right"},T),l.a.createElement("td",{className:"text-right"},S),l.a.createElement("td",null,_.a.isNumber(T)&&l.a.createElement(Gt,{tasks:s}))),n?l.a.createElement("td",null,l.a.createElement(Zt,{e:T,r:S})):null)},qt=function(e,t){return e.find(function(e){return e.id===t})},$t=function(){var e=Object(c.useContext)(te).state,t=e.tasks,a=e.custom_value_map,n=e.custom_attrs,r=e.custom_eid,u=e.custom_rid,s=e.biz_days,o=e.project.members,m=Object(c.useState)(0),E=Object(i.a)(m,2),d=E[0],p=E[1],f=Object(c.useState)(0),T=Object(i.a)(f,2),S=T[0],b=T[1],O=s.length-1,v=Object(c.useCallback)(function(e){p(Number(e.target.value)||0)},[p]);Object(c.useEffect)(function(){b(d*O)},[d,O,b]);var y=function(e,t,a,n){var r=Number(a),c=Number(n);return _.a.mapValues(Ft(e),function(e){return _.a.chain(e).map(function(e){return{e:Kt(t,e,r),r:Kt(t,e,c)}}).reduce(function(e,t){return{e:e.e+t.e,r:e.r+t.r}},{e:0,r:0}).value()})}(t,a,r,u),j=qt(n,Number(r)),k=qt(n,Number(u));if(!j||!k||s.length<=1)return null;var C=_.a.get(y,"null.e",0),h=S>0,A=!h&&ye()().diff(ye()(_.a.last(s)).local().endOf("days"))>0,g=Ft(t.filter(function(e){return e.is_closed}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(Ke.a,{color:"light",light:!0},l.a.createElement(ue.a,{inline:!0,className:"mr-auto",onSubmit:_e},l.a.createElement(se.a,null,l.a.createElement(ie.a,{type:"number",step:"0.5",placeholder:"hours / day",className:"text-right",onChange:v}),l.a.createElement(oe.a,{addonType:"append"},l.a.createElement(Ye.a,null,l.a.createElement(w.a,{className:"mx-2",icon:H.v}),O," [days]",l.a.createElement(w.a,{className:"mx-2",icon:H.h})),S>0?l.a.createElement(l.a.Fragment,null,l.a.createElement(Ye.a,{className:"bg-white"},l.a.createElement("strong",null,S)),l.a.createElement(Ye.a,null,"hours / sprint")):null))),l.a.createElement(Pt,null),l.a.createElement(ze,null)),l.a.createElement(Oe.a,{bordered:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Name"),l.a.createElement("th",null,j.name),h?l.a.createElement(l.a.Fragment,null,l.a.createElement("th",null,"Total")," ",l.a.createElement("th",null,"Custom")):l.a.createElement(l.a.Fragment,null,l.a.createElement("th",null,k.name),l.a.createElement("th",null,"Progress")),A?l.a.createElement("th",null,"Grade"):null)),l.a.createElement("tbody",null,(o||[]).map(function(e){return l.a.createElement(Wt,{key:e.id,isPast:A,item:e,sums:y,total:S,hpd:d,tasks:g[e.id]||[]})}),l.a.createElement("tr",{key:"null"},l.a.createElement("td",{className:"text-danger"},l.a.createElement(w.a,{icon:H.k,className:"ml-1 mr-2 fa-lg"}),"Not assigned"),l.a.createElement("td",{className:"text-right text-danger"},C),l.a.createElement("td",null),l.a.createElement("td",null),A?l.a.createElement("td",null):null))))},Qt=function(){var e=Object(c.useContext)(te).state,t=e.tasks,a=e.custom_value_map,n=e.custom_eid,r=Object(c.useMemo)(function(){return Number(n)},[n]),u=Object(c.useMemo)(function(){return r?t.filter(function(e){return zt(a,e)&&0===Kt(a,e,r)}):[]},[a,r,t]),s=Object(c.useMemo)(function(){return mt(u)},[u]);return 0===u.length?null:l.a.createElement(ne.a,null,l.a.createElement(re.a,{className:"alert-danger"},"Un estimated tasks"),l.a.createElement(xe.a,null,s.map(function(e){return l.a.createElement(kt,{item:e,key:e.user_story})})))},Xt=function(){var e=Object(c.useContext)(te).state.tasks,t=Object(c.useMemo)(function(){return _.a.filter(e,{assigned_to:null})},[e]),a=Object(c.useMemo)(function(){return mt(t)},[t]);return 0===t.length?null:l.a.createElement(ne.a,null,l.a.createElement(re.a,{className:"alert-danger"},"Not assigned tasks"),l.a.createElement(xe.a,null,a.map(function(e){return l.a.createElement(Ct,{item:e,key:e.user_story})})))},ea=function(){var e=Object(c.useContext)(te).state.tasks;return l.a.createElement(Rt,{tasks:e})},ta=function(){return c.createElement(c.Fragment,null,c.createElement($t,null),c.createElement(Xt,null),c.createElement("br",null),c.createElement(Qt,null),c.createElement("br",null),c.createElement(ea,null))},aa=function(){return l.a.createElement("div",{className:"container"},l.a.createElement(o.a,null),l.a.createElement(we.a,null,l.a.createElement(ae,null,l.a.createElement(Pe,null),l.a.createElement(He.Route,{exact:!0,path:"/",component:ta}),l.a.createElement(He.Route,{exact:!0,path:"/:uid",component:wt}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(aa,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},68:function(e,t,a){e.exports={header:"UserStory_header__3lGFX",toggle_input:"UserStory_toggle_input__ARa5d",display_medal:"UserStory_display_medal__3t53K",medal:"UserStory_medal__2Zi1f",is_closed:"UserStory_is_closed__2ABQp"}}},[[233,1,2]]]);
//# sourceMappingURL=main.deba5304.chunk.js.map