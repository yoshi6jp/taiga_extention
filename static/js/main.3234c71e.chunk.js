(this["webpackJsonptaiga-extention"]=this["webpackJsonptaiga-extention"]||[]).push([[0],{111:function(e,t,a){e.exports={btn:"TaskTimerButton_btn__3yv2h"}},147:function(e,t,a){e.exports={gold:"UserTasks_gold__3HGjY",silver:"UserTasks_silver__1pI-2",bronze:"UserTasks_bronze__3Y2bu",custom_input_td:"UserTasks_custom_input_td__2hLT8"}},226:function(e,t,a){e.exports={header:"Controller_header__33lvE"}},230:function(e,t,a){e.exports={input_group:"ToggleNumberInput_input_group__1wkB8"}},239:function(e,t,a){e.exports=a.p+"static/media/tomato.c392a271.png"},271:function(e,t,a){e.exports=a(517)},276:function(e,t,a){},286:function(e,t,a){},517:function(e,t,a){"use strict";a.r(t);var n,r=a(1),c=a.n(r),o=a(32),s=a.n(o),l=(a(276),a(277),a(278),a(279),a(280),a(281),a(282),a(283),a(284),a(285),a(286),a(54)),i=a(13),u=a(6),m=a.n(u),_=a(2),d=a.n(_),E=a(11),p=a.n(E),O=a(18),T=a.n(O);!function(e){e.SET_TOKEN="SET_TOKEN",e.SET_TIMER_ID="SET_TIMER_ID",e.ADD_FB_TIMER="ADD_FB_TIMER",e.DEL_FB_TIMER="DEL_FB_TIMER",e.SET_URL="SET_URL",e.SIGN_IN="SIGN_IN",e.SET_AUTH_TOKEN="SET_AUTH_TOKEN",e.SET_AUTH_ERROR="SET_AUTH_ERROR",e.SIGN_OUT="SIGN_OUT",e.FETCH_PROJECTS="FETCH_PROJECTS",e.SET_PROJECTS="SET_PROJECTS",e.SET_PID="SET_PID",e.FETCH_PROJECT="FETCH_PROJECT",e.SET_PROJECT="SET_PROJECT",e.FETCH_MILESTONES="FETCH_MILESTONES",e.SET_MID="SET_MID",e.SET_MILESTONES="SET_MILESTONES",e.SET_MILESTONE="SET_MILESTONE",e.SET_CUSTOM_EID="SET_CUSTOM_EID",e.SET_CUSTOM_RID="SET_CUSTOM_RID",e.FETCH_CUSTOM_ATTRS="FETCH_CUSTOM_ATTRS",e.SET_CUSTOM_ATTRS="SET_CUSTOM_ATTRS",e.SET_CUSTOM_ATTR_E="SET_CUSTOM_ATTR_E",e.SET_CUSTOM_ATTR_R="SET_CUSTOM_ATTR_R",e.SET_BIZ_DAYS="SET_BIZ_DAYS",e.ADD_BIZ_DAY="ADD_BIZ_DAY",e.REMOVE_BIZ_DAY="REMOVE_BIZ_DAY",e.FETCH_TASKS="FETCH_TASKS",e.SET_TASKS="SET_TASKS",e.SET_TASK_ID="SET_TASK_ID",e.RESET_TASK_ID="RESET_TASK_ID",e.SET_TASK="SET_TASK",e.SET_USER_TASKS="SET_USER_TASKS",e.PATCH_TASK="PATCH_TASK",e.FETCH_TASK_STATUSES="FETCH_TASK_STATUSES",e.SET_TASK_STATUSES="SET_TASK_STATUSES",e.SET_ACTIVE_TASK_STATUSES="SET_ACTIVE_TASK_STATUSES",e.FETCH_CUSTOM_VALUE_MAP="FETCH_CUSTOM_VALUE_MAP",e.SET_CUSTOM_VALUE_MAP="SET_CUSTOM_VALUE_MAP",e.PATCH_CUSTOM_VALUE="PATCH_CUSTOM_VALUE",e.FETCH_USER="FETCH_USER",e.SET_USER="SET_USER",e.RESET_USER="RESET_USER",e.SET_REJECT_TASK_STATUS_IDS="SET_REJECT_TASK_STATUS_IDS",e.ADD_REJECT_TASK_STATUS_ID="ADD_REJECT_TASK_STATUS_ID",e.REMOVE_REJECT_TASK_STATUS_ID="REMOVE_REJECT_TASK_STATUS_ID",e.OPEN_CONTROLLER="OPEN_CONTROLLER",e.CLOSE_CONTROLLER="CLOSE_CONTROLLER",e.UPDATE_DATA="UPDATE_DATA",e.ADD_POMODORO="ADD_POMODORO",e.USE_POMODORO="USE_POMODORO",e.RESET_POMODORO="RESET_POMODORO",e.RESTORE_POMODORO="RESTORE_POMODORO",e.CALC_POMODORO_TOTAL="CALC_POMODORO_TOTAL",e.LOAD_POMODORO_TOTALS="LOAD_POMODORO_TOTALS",e.SET_POMODORO_TOTALS="SET_POMODORO_TOTALS",e.LOADED="LOADED",e.SET_POMODORO_STATE="SET_POMODORO_STATE",e.SET_POMODORO_MODE="SET_POMODORO_MODE",e.SET_TIMELIMIT_CLOSE_TASK="SET_TIMELIMIT_CLOSE_TASK",e.SET_IN_PROGRESS_TASK_STATUS_ID="SET_IN_PROGRESS_TASK_STATUS_ID",e.SET_POMODORO_LIVE_COUNT="SET_POMODORO_LIVE_COUNT"}(n||(n={}));var f,S,b,y=a(20),v=a(100),k=a(219),h=a(107),j=a(51),g=a(152),C=a(108),A=a(101);!function(e){e.STOPPED="stopped",e.RUNNING="running",e.PAUSED="paused"}(S||(S={})),function(e){e.FOCUS="Focusing",e.SHORT="Short break",e.LONG="Long break"}(b||(b={}));var D,R=(f={},Object(y.a)(f,b.FOCUS,25),Object(y.a)(f,b.SHORT,5),Object(y.a)(f,b.LONG,15),f);!function(e){e.STATE="pomodoro_state",e.MODE="pomodoro_mode",e.CHECKPOINT_START_AT="pomodoro_checkpoint_start_at",e.CHECKPOINT_ELAPSED="pomodoro_checkpoint_elapsed"}(D||(D={}));var I,M,N=new(function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(h.a)(this,Object(j.a)(t).call(this))).state=S.STOPPED,a.mode=b.FOCUS,a.duration=60*R[b.FOCUS],a.tick=60,a.checkpointStartAt=NaN,a.checkpointElapsed=0,a.expireTimeout=null,a.tickInterval=null,a.tickOffsetTimeout=null,a.restoreExpired=!1,a.estimateCompletedAt=new Date,a.tick=e,a.restoreStorage(),a}return Object(C.a)(t,e),Object(k.a)(t,[{key:"on",value:function(e,a){return Object(g.a)(Object(j.a)(t.prototype),"on",this).call(this,e,a)}},{key:"once",value:function(e,a){return Object(g.a)(Object(j.a)(t.prototype),"once",this).call(this,e,a)}},{key:"start",value:function(){this.isStopped&&(this.setExpireTimeout(this.duration),this.setTickInterval(this.tick),this.state=S.RUNNING,this.checkpointStartAt=Date.now(),this.checkpointElapsed=0,this.emit("start",this.status),this.saveStorage())}},{key:"stop",value:function(){this.isStopped||(this.clearExpireTimeout(),this.clearTickInterval(),this.checkpointStartAt=NaN,this.checkpointElapsed=0,this.state=S.STOPPED,this.emit("stop",this.status),this.saveStorage())}},{key:"pause",value:function(){if(this.isRunning){this.clearExpireTimeout(),this.clearTickInterval();var e=(Date.now()-this.checkpointStartAt)/1e3;this.checkpointElapsed+=e,this.state=S.PAUSED,this.emit("pause",this.status),this.saveStorage()}}},{key:"resume",value:function(){this.isPaused&&(this.setExpireTimeout(this.remaining),this.setTickInterval(this.tick),this.state=S.RUNNING,this.checkpointStartAt=Date.now(),this.emit("resume",this.status),this.saveStorage())}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"changeMode",value:function(e,t){var a=this;this.stop(),this.mode=e,this.duration=60*R[e],this.emit("change_mode",this.status),this.saveStorage(),t&&m.a.defer((function(){a.start()}))}},{key:"setExpireTimeout",value:function(e){var t=this;this.expireTimeout=setTimeout((function(){t.emit("expire",t.status),t.stop()}),1e3*e)}},{key:"clearExpireTimeout",value:function(){this.expireTimeout&&clearTimeout(this.expireTimeout),this.expireTimeout=null}},{key:"setTickInterval",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,r=this.status.remaining;if(r<=n)this.setSecTickInterval();else{var c=r%e;c>1&&!a?this.tickOffsetTimeout=setTimeout((function(){t.emit("tick",t.status),t.setTickInterval(e,!0)}),1e3*c):this.tickInterval=setInterval((function(){var e=t.status;t.emit("tick",e),e.remaining<n&&(t.clearTickInterval(),t.setSecTickInterval())}),1e3*e)}}},{key:"setSecTickInterval",value:function(){var e=this;this.tickInterval=setInterval((function(){e.emit("tick",e.status)}),1e3)}},{key:"clearTickInterval",value:function(){this.tickInterval&&clearInterval(this.tickInterval),this.tickInterval=null,this.tickOffsetTimeout&&clearTimeout(this.tickOffsetTimeout),this.tickOffsetTimeout=null}},{key:"saveStorage",value:function(){localStorage.setItem(D.STATE,this.state),localStorage.setItem(D.MODE,this.mode),localStorage.setItem(D.CHECKPOINT_START_AT,Number.isNaN(this.checkpointStartAt)?"":String(this.checkpointStartAt)),localStorage.setItem(D.CHECKPOINT_ELAPSED,String(this.checkpointElapsed))}},{key:"restoreStorage",value:function(){var e,t=localStorage.getItem(D.STATE),a=localStorage.getItem(D.MODE),n=localStorage.getItem(D.CHECKPOINT_START_AT),r=localStorage.getItem(D.CHECKPOINT_ELAPSED);if(e=t,m.a.includes(m.a.values(S),e)&&function(e){return m.a.includes(m.a.values(b),e)}(a)){var c=t,o=a,s=60*R[o];switch(c){case S.STOPPED:this.changeMode(o);break;case S.PAUSED:var l=Number(r);l<1e3*s&&(this.state=c,this.mode=o,this.duration=s,this.checkpointElapsed=l);break;case S.RUNNING:var i=Number(n),u=Number(r);if(i>0)this.mode=o,this.duration=s,Date.now()-i+1e3*u<1e3*s?(this.state=S.RUNNING,this.checkpointStartAt=i,this.checkpointElapsed=u,this.setExpireTimeout(this.remaining),this.setTickInterval(this.tick)):(this.stop(),this.estimateCompletedAt=new Date(i+1e3*(s-u)),this.restoreExpired=!0)}}}},{key:"isStopped",get:function(){return this.state===S.STOPPED}},{key:"isRunning",get:function(){return this.state===S.RUNNING}},{key:"isPaused",get:function(){return this.state===S.PAUSED}},{key:"remaining",get:function(){return Math.max(this.duration-this.elapsed,0)}},{key:"elapsed",get:function(){var e=0;return this.checkpointStartAt&&this.isRunning&&(e=(Date.now()-this.checkpointStartAt)/1e3),this.checkpointElapsed+e}},{key:"status",get:function(){return{state:this.state,duration:this.duration,elapsed:this.elapsed,remaining:this.remaining,checkpointElapsed:this.checkpointElapsed,checkpointStartAt:this.checkpointStartAt,mode:this.mode}}}]),t}(A.EventEmitter))(60);!function(e){e.URL="taiga_url",e.TIMER_ID="taiga_timer_id",e.PID="taiga_pid",e.MID="taiga_mid",e.TASK_ID="taiga_task_id",e.CUSTOM_EID="taiga_custom_eid",e.CUSTOM_RID="taiga_custom_rid",e.BIZ_DAYS="taiga_biz_days",e.REJECT_TASK_STATUS_IDS="reject_task_status_ids",e.USERNAME="taiga_username",e.PASSWORD="taiga_password",e.POMODORO_DATE="taiga_pomodoro_date",e.POMODORO_NUMBER="taiga_pomodoro_number",e.POMODORO_USED_NUMBER="taiga_pomodoro_used_number",e.TIMELIMIT_CLOSE_TASK="taiga_timelimit_close_task"}(M||(M={}));var x=function(e){return localStorage.getItem(e)||""},U=function(e){return x(e)},P=function(e,t){return t?x("".concat(t,"/").concat(e)):""},L=function(e,t){localStorage.setItem(e,t)},w=function(e,t,a){return t?L("".concat(t,"/").concat(e),a):null},K={token:null,timer_id:null,url:"",auth_token:"",auth_error:!1,username:"",password:"",user:null,projects:[],pid:"",project:{},mid:"",custom_eid:"",custom_rid:"",custom_attrs:[],custom_attr_e:{},custom_attr_r:{},biz_days:[],milestones:[],milestone:{},tasks:[],task_id:"",task:null,user_tasks:[],task_statuses:[],active_task_statuses:[],custom_value_map:new WeakMap,reject_task_status_ids:[],updated_time:0,isOpen:!1,pomodoro_date:"",pomodoro_number:0,pomodoro_used_number:0,loaded:!1,pomodoro_daily_totals:[],pomodoro_state:S.STOPPED,pomodoro_mode:b.FOCUS,timelimit_close_task:"",in_progress_task_status_id:"",pomodoro_live_counts:(I={},Object(y.a)(I,b.FOCUS,0),Object(y.a)(I,b.SHORT,0),Object(y.a)(I,b.LONG,0),I)},F=a(55),H=a(12),B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.SET_TOKEN:var a=t.payload.token;return Object(H.a)({},e,{token:a});case n.SET_TIMER_ID:var r=t.payload.timer_id;return Object(H.a)({},e,{timer_id:r});case n.SET_URL:var c=t.payload.url;return Object(H.a)({},e,{url:c});case n.SET_PROJECTS:var o=t.payload.projects;return Object(H.a)({},e,{projects:o});case n.SET_PID:var s=t.payload.pid;return Object(H.a)({},e,{pid:s,project:{},mid:"",biz_days:[],custom_attrs:[],milestones:[],custom_value_map:new WeakMap});case n.SET_PROJECT:var l=t.payload.project;return Object(H.a)({},e,{project:l});case n.SET_MID:var i=t.payload.mid;return Object(H.a)({},e,{mid:i,milestone:{},tasks:[]});case n.SET_MILESTONES:var u=t.payload.milestones;return Object(H.a)({},e,{milestones:u});case n.SET_MILESTONE:var _=t.payload.milestone;return Object(H.a)({},e,{milestone:_});case n.SET_CUSTOM_EID:var d=t.payload.custom_eid;return Object(H.a)({},e,{custom_eid:d});case n.SET_CUSTOM_ATTRS:var E=t.payload.custom_attrs;return Object(H.a)({},e,{custom_attrs:E});case n.SET_CUSTOM_ATTR_E:var p=t.payload.custom_attr_e;return Object(H.a)({},e,{custom_attr_e:p});case n.SET_CUSTOM_ATTR_R:var O=t.payload.custom_attr_r;return Object(H.a)({},e,{custom_attr_r:O});case n.SET_CUSTOM_RID:var T=t.payload.custom_rid;return Object(H.a)({},e,{custom_rid:T});case n.SET_BIZ_DAYS:var f=t.payload.biz_days;return Object(H.a)({},e,{biz_days:f});case n.ADD_BIZ_DAY:var S=t.payload.biz_day,b=m.a.chain([].concat(Object(F.a)(e.biz_days),[S])).uniq().sort().value();return Object(H.a)({},e,{biz_days:b});case n.REMOVE_BIZ_DAY:var v=t.payload.biz_day,k=m.a.reject(Object(F.a)(e.biz_days),(function(e){return e===v}));return Object(H.a)({},e,{biz_days:k});case n.SET_TASKS:var h=t.payload.tasks;return Object(H.a)({},e,{tasks:h});case n.SET_TASK_ID:var j=t.payload.task_id;return Object(H.a)({},e,{task_id:j,task:null});case n.RESET_TASK_ID:return Object(H.a)({},e,{task_id:"",task:null});case n.SET_TASK:var g=t.payload.task;return Object(H.a)({},e,{task:g});case n.SET_USER_TASKS:var C=t.payload.user_tasks;return Object(H.a)({},e,{user_tasks:C});case n.SET_TASK_STATUSES:var A=t.payload.task_statuses;return Object(H.a)({},e,{task_statuses:A});case n.SET_ACTIVE_TASK_STATUSES:var D=t.payload.active_task_statuses;return Object(H.a)({},e,{active_task_statuses:D});case n.SET_CUSTOM_VALUE_MAP:var R=t.payload.custom_value_map;return Object(H.a)({},e,{custom_value_map:R});case n.SET_USER:var I=t.payload.user;return Object(H.a)({},e,{user:I});case n.RESET_USER:return Object(H.a)({},e,{user:null,user_tasks:[]});case n.SET_REJECT_TASK_STATUS_IDS:var M=t.payload.reject_task_status_ids;return Object(H.a)({},e,{reject_task_status_ids:M});case n.ADD_REJECT_TASK_STATUS_ID:var N=t.payload.reject_task_status_id,x=m.a.chain([].concat(Object(F.a)(e.reject_task_status_ids),[N])).compact().uniq().value();return Object(H.a)({},e,{reject_task_status_ids:x});case n.REMOVE_REJECT_TASK_STATUS_ID:var U=t.payload.reject_task_status_id,P=m.a.reject(Object(F.a)(e.reject_task_status_ids),(function(e){return e===U}));return Object(H.a)({},e,{reject_task_status_ids:P});case n.OPEN_CONTROLLER:return Object(H.a)({},e,{isOpen:!0});case n.CLOSE_CONTROLLER:return Object(H.a)({},e,{isOpen:!1});case n.UPDATE_DATA:return Object(H.a)({},e,{updated_time:Date.now()});case n.SIGN_IN:var L=t.payload,w=L.username,B=L.password;return Object(H.a)({},e,{username:w,password:B,auth_error:!1});case n.SET_AUTH_TOKEN:var Y=t.payload.auth_token;return Object(H.a)({},e,{auth_token:Y});case n.SET_AUTH_ERROR:return Object(H.a)({},e,{auth_error:!0});case n.SIGN_OUT:return Object(H.a)({},e,{auth_token:"",username:"",password:""});case n.ADD_POMODORO:var z=e.pomodoro_number+1;return Object(H.a)({},e,{pomodoro_number:z});case n.USE_POMODORO:var V=t.payload.used_number,G=Math.max(0,e.pomodoro_used_number+V);return Object(H.a)({},e,{pomodoro_used_number:G});case n.RESET_POMODORO:var J=t.payload.pomodoro_date;return Object(H.a)({},e,{pomodoro_number:0,pomodoro_used_number:0,pomodoro_date:J});case n.RESTORE_POMODORO:var Z=t.payload,W=Z.pomodoro_date,q=Z.pomodoro_number,Q=Z.pomodoro_used_number;return Object(H.a)({},e,{pomodoro_date:W,pomodoro_number:q,pomodoro_used_number:Q});case n.SET_POMODORO_TOTALS:var X=t.payload.pomodoro_daily_totals;return Object(H.a)({},e,{pomodoro_daily_totals:X});case n.LOADED:return Object(H.a)({},e,{loaded:!0});case n.SET_POMODORO_STATE:var $=t.payload.pomodoro_state;return Object(H.a)({},e,{pomodoro_state:$});case n.SET_POMODORO_MODE:var ee=t.payload.pomodoro_mode;return Object(H.a)({},e,{pomodoro_mode:ee});case n.SET_TIMELIMIT_CLOSE_TASK:var te=t.payload.timelimit_close_task;return Object(H.a)({},e,{timelimit_close_task:te});case n.SET_IN_PROGRESS_TASK_STATUS_ID:var ae=t.payload.task_status_id;return Object(H.a)({},e,{in_progress_task_status_id:ae});case n.SET_POMODORO_LIVE_COUNT:var ne=t.payload,re=ne.mode,ce=ne.value;return Object(H.a)({},e,{pomodoro_live_counts:Object(H.a)({},e.pomodoro_live_counts,Object(y.a)({},re,ce))});default:return e}},Y=function(e,t,a,n){return function(r){t(r),a(r,n,e)}},z=a(14),V=a(10),G=function(e){var t=e.icon,a=e.message;return c.a.createElement("div",{className:"d-flex"},c.a.createElement("h2",{className:"mr-2"},c.a.createElement(z.a,{icon:t})),c.a.createElement("div",null,a))},J=function(e){var t=e.title,a=e.body,n=e.icon;return c.a.createElement("div",{className:"d-flex"},c.a.createElement("img",{src:n,style:{width:"48px",height:"48px"},alt:""}),c.a.createElement("div",{className:"ml-2"},c.a.createElement("h5",null,t),c.a.createElement("p",null,a)))},Z=function(e){l.b.success(c.a.createElement(G,{icon:V.b,message:e}))},W=function(e){l.b.error(c.a.createElement(G,{icon:V.c,message:e}))},q=function(e){var t=e.title,a=e.body,n=e.icon;Object(l.b)(c.a.createElement(J,{title:t,body:a,icon:n}))},Q=a(45),X=a.n(Q),$=function(e,t,a){m.a.defer((function(){var e=a(),t=e.pomodoro_date,n=e.pomodoro_number,r=e.pomodoro_used_number;L(M.POMODORO_DATE,t),L(M.POMODORO_NUMBER,String(n)),L(M.POMODORO_USED_NUMBER,String(r))}))},ee=new(function(e){function t(){var e;return Object(v.a)(this,t),(e=Object(h.a)(this,Object(j.a)(t).call(this,"TaigaPomodoroDatabase"))).items=void 0,e.totals=void 0,e.version(1).stores({items:"++id, completedAt, duration, pure, dateKey",totals:"++id, date, value, pureValue, &dateKey, dayOfWeek"}),e.items=e.table("items"),e.totals=e.table("totals"),e}return Object(C.a)(t,e),t}(a(220).a)),te=a(221),ae=a.n(te),ne=a(109),re=a.n(ne);a(518),a(309);ae.a.config();var ce=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_apiKey:"AIzaSyDscSWT2haNjkDvdx29dz1mIxX0LX3PLJM",REACT_APP_authDomain:"taiga-ext.firebaseapp.com",REACT_APP_databaseURL:"https://taiga-ext.firebaseio.com",REACT_APP_projectId:"taiga-ext",REACT_APP_storageBucket:"taiga-ext.appspot.com",REACT_APP_messagingSenderId:"670370401412",REACT_APP_appId:"1:670370401412:web:c1a69635a444ff4f",REACT_APP_VapidKey:"BOOlMIIx0P4qjkh4KEwpEunUeeuVvaYelqqcsUGnimb7LBc6GyDECYhUwe7vCdJEDDiNExg-annFh4kXrqiIank"}),oe=ce.REACT_APP_apiKey,se=ce.REACT_APP_VapidKey,le={apiKey:oe,authDomain:ce.REACT_APP_authDomain,databaseURL:ce.REACT_APP_databaseURL,projectId:ce.REACT_APP_projectId,storageBucket:ce.REACT_APP_storageBucket,messagingSenderId:ce.REACT_APP_messagingSenderId,appId:ce.REACT_APP_appId};re.a.initializeApp(le);var ie=null;try{ie=re.a.messaging()}catch(pn){console.log(pn)}var ue=ie;navigator.serviceWorker&&ue&&navigator.serviceWorker.register("./firebase-messaging-sw.js").then((function(e){m.a.get(ue,"registrationToUse")||ue.useServiceWorker(e),ue.usePublicVapidKey(se||""),ue.onTokenRefresh((function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.awrap(ue.getToken());case 2:e.sent;case 3:case"end":return e.stop()}}))})),ue.getToken().then((function(e){e}))}));var me=re.a.firestore().collection("timers");ue&&ue.requestPermission().then((function(){console.log("Notification permission granted.")})).catch((function(e){console.log("Unable to get permission to notify.",e)}));var _e=function(e,t,a,n,r){var c,o;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,p.a.awrap(me.add({title:e,body:t,remaining:a,token:n,icon:"./tomato.png",click_action:window.location.href,mode:r}));case 2:return c=s.sent,o=c.id,s.abrupt("return",o);case 5:case"end":return s.stop()}}))},de=function(e,t,a){if(e.type===n.DEL_FB_TIMER){var r=a().timer_id;r&&(c=r,me.doc(c).delete(),t({type:n.SET_TIMER_ID,payload:{timer_id:null}}))}var c},Ee=function(e,t,a){return X.a.get("".concat(be(e),"/").concat(t),a)},pe=function(e,t,a,n){return X.a.post("".concat(be(e),"/").concat(t),a,n)},Oe=function(e,t,a,n){return X.a.patch("".concat(be(e),"/").concat(t),a,n)},Te=function(e){var t;try{t=e.response?e.response.data._error_message:"error"}catch(pn){t=pn.message||pn}W(t)},fe=function(e,t,a){switch(e.type){case n.FETCH_PROJECTS:return void function(e,t,a){var r,c,o,s;p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=a(),!(c=r.url)){e.next=8;break}return e.next=5,p.a.awrap(Ee(c,"projects"));case 5:o=e.sent,s=o.data,t({type:n.SET_PROJECTS,payload:{projects:s}});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),Te(e.t0);case 13:case"end":return e.stop()}}),null,null,[[0,10]])}(0,t,a);case n.FETCH_PROJECT:return void function(e,t,a){var r,c,o,s,l;p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.type!==n.FETCH_PROJECT){i.next=15;break}if(i.prev=1,r=a(),c=r.url,o=e.payload.pid,!c||!o){i.next=10;break}return i.next=7,p.a.awrap(Ee(c,"projects/".concat(o)));case 7:s=i.sent,l=s.data,t({type:n.SET_PROJECT,payload:{project:l}});case 10:i.next=15;break;case 12:i.prev=12,i.t0=i.catch(1),Te(i.t0);case 15:case"end":return i.stop()}}),null,null,[[1,12]])}(e,t,a);case n.FETCH_MILESTONES:return void function(e,t,a){var r,c,o,s,l;p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.type!==n.FETCH_MILESTONES){i.next=15;break}if(i.prev=1,r=a(),c=r.url,o=e.payload.project,!c||!o){i.next=10;break}return i.next=7,p.a.awrap(Ee(c,"milestones",{params:{project:o}}));case 7:s=i.sent,l=s.data,t({type:n.SET_MILESTONES,payload:{milestones:l}});case 10:i.next=15;break;case 12:i.prev=12,i.t0=i.catch(1),Te(i.t0);case 15:case"end":return i.stop()}}),null,null,[[1,12]])}(e,t,a);case n.FETCH_TASKS:return void function(e,t,a){var r,c,o,s,l,i,u,_,d,E;p.a.async((function(O){for(;;)switch(O.prev=O.next){case 0:if(e.type!==n.FETCH_TASKS){O.next=17;break}if(O.prev=1,r=a(),c=r.url,o=e.payload,s=o.milestone,l=o.reject_task_status_ids,i=o.timelimit_close_task,!(c&&s&&i)){O.next=12;break}return u=T()(i),O.next=8,p.a.awrap(Ee(c,"tasks",{headers:{"x-disable-pagination":!0},params:{milestone:s}}));case 8:_=O.sent,d=_.data,E=m.a.chain(d).reject((function(e){return m.a.includes(l,String(e.status))})).reject((function(e){return e.is_closed&&T()(e.finished_date).diff(u)<0})).value(),t({type:n.SET_TASKS,payload:{tasks:E}});case 12:O.next=17;break;case 14:O.prev=14,O.t0=O.catch(1),Te(O.t0);case 17:case"end":return O.stop()}}),null,null,[[1,14]])}(e,t,a);case n.FETCH_TASK_STATUSES:return void function(e,t,a){var r,c,o,s,l;p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.type!==n.FETCH_TASK_STATUSES){i.next=15;break}if(i.prev=1,r=a(),c=r.url,o=e.payload.project,!c||!o){i.next=10;break}return i.next=7,p.a.awrap(Ee(c,"task-statuses",{params:{project:o}}));case 7:s=i.sent,l=s.data,t({type:n.SET_TASK_STATUSES,payload:{task_statuses:l}});case 10:i.next=15;break;case 12:i.prev=12,i.t0=i.catch(1),Te(i.t0);case 15:case"end":return i.stop()}}),null,null,[[1,12]])}(e,t,a);case n.FETCH_CUSTOM_ATTRS:return void function(e,t,a){var r,c,o,s,l;p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.type!==n.FETCH_CUSTOM_ATTRS){i.next=15;break}if(i.prev=1,r=a(),c=r.url,o=e.payload.project,!c||!o){i.next=10;break}return i.next=7,p.a.awrap(Ee(c,"task-custom-attributes",{params:{project:o}}));case 7:s=i.sent,l=s.data,t({type:n.SET_CUSTOM_ATTRS,payload:{custom_attrs:l}});case 10:i.next=15;break;case 12:i.prev=12,i.t0=i.catch(1),Te(i.t0);case 15:case"end":return i.stop()}}),null,null,[[1,12]])}(e,t,a);case n.FETCH_CUSTOM_VALUE_MAP:return void function(e,t,a){var r,c,o,s,l,i;p.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:if(e.type!==n.FETCH_CUSTOM_VALUE_MAP){u.next=16;break}if(u.prev=1,r=a(),c=r.url,o=r.custom_eid,s=r.custom_rid,l=e.payload.tasks,!(c&&l.length&&o&&s)){u.next=11;break}return u.t0=WeakMap,u.next=8,p.a.awrap(Promise.all(l.map((function(e){var t,a;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(Ee(c,"tasks/custom-attributes-values/".concat(e.id)));case 2:return t=n.sent,a=t.data,n.abrupt("return",[e,a]);case 5:case"end":return n.stop()}}))}))));case 8:u.t1=u.sent,i=new u.t0(u.t1),t({type:n.SET_CUSTOM_VALUE_MAP,payload:{custom_value_map:i}});case 11:u.next=16;break;case 13:u.prev=13,u.t2=u.catch(1),Te(u.t2);case 16:case"end":return u.stop()}}),null,null,[[1,13]])}(e,t,a);case n.FETCH_USER:return void function(e,t,a){var r,c,o,s,l;p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.type!==n.FETCH_USER){i.next=15;break}if(i.prev=1,r=a(),c=r.url,o=e.payload.uid,!c||!o){i.next=10;break}return i.next=7,p.a.awrap(Ee(c,"users/".concat(o)));case 7:s=i.sent,l=s.data,t({type:n.SET_USER,payload:{user:l}});case 10:i.next=15;break;case 12:i.prev=12,i.t0=i.catch(1),Te(i.t0);case 15:case"end":return i.stop()}}),null,null,[[1,12]])}(e,t,a);case n.PATCH_CUSTOM_VALUE:return void function(e,t,a){var r,c,o,s,l,i,u,m,_,d,E,O,T,f;p.a.async((function(S){for(;;)switch(S.prev=S.next){case 0:if(e.type!==n.PATCH_CUSTOM_VALUE){S.next=20;break}if(S.prev=1,r=a(),c=r.url,o=r.custom_value_map,s=r.tasks,l=r.in_progress_task_status_id,i=e.payload,u=i.id,m=i.key,_=i.value,d=i.version,E=s.find((function(e){return e.id===u})),!(c&&u&&m&&E&&o.has(E))){S.next=15;break}if(!(O=o.get(E))){S.next=15;break}return T=O.attributes_values,S.next=11,p.a.awrap(Oe(c,"tasks/custom-attributes-values/".concat(u),{attributes_values:Object(H.a)({},T,Object(y.a)({},m,String(_))),version:d}));case 11:e.meta&&e.meta.update_status&&_>0&&l&&!E.is_closed&&E.status!==Number(l)&&t({type:n.PATCH_TASK,payload:{key:"status",value:l,id:E.id}}),e.meta&&e.meta.use_pomodoro&&(f=e.meta.use_pomodoro.used_number,t({type:n.USE_POMODORO,payload:{used_number:f}})),t({type:n.UPDATE_DATA}),Z("Custom value updated. [".concat(_,"]"));case 15:S.next=20;break;case 17:S.prev=17,S.t0=S.catch(1),Te(S.t0);case 20:case"end":return S.stop()}}),null,null,[[1,17]])}(e,t,a);case n.SIGN_IN:return void function(e,t,a){var r,c,o,s,l,i,u;p.a.async((function(_){for(;;)switch(_.prev=_.next){case 0:if(e.type!==n.SIGN_IN){_.next=20;break}if(_.prev=1,r=a(),c=r.url,o=e.payload,s=o.username,l=o.password,!(c&&s&&l)){_.next=13;break}return _.next=7,p.a.awrap(pe(c,"auth",{username:s,password:l,type:"normal"}));case 7:i=_.sent,u=i.data.auth_token,t({type:n.SET_AUTH_TOKEN,payload:{auth_token:u}}),L(M.USERNAME,s),L(M.PASSWORD,l),Z("".concat(s," signed in."));case 13:_.next=20;break;case 15:_.prev=15,_.t0=_.catch(1),t({type:n.SET_AUTH_ERROR}),m.a.get(_.t0,"response.data._err_message")&&t({type:n.SIGN_OUT}),Te(_.t0);case 20:case"end":return _.stop()}}),null,null,[[1,15]])}(e,t,a);case n.PATCH_TASK:return void function(e,t,a){var r,c,o,s,l,i,u,m,_;p.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:if(e.type!==n.PATCH_TASK){d.next=15;break}if(d.prev=1,r=a(),c=r.url,o=r.tasks,s=e.payload,l=s.id,i=s.key,u=s.value,m=o.find((function(e){return e.id===l})),!(c&&l&&i&&m)){d.next=10;break}return d.next=8,p.a.awrap(Oe(c,"tasks/".concat(l),(_={},Object(y.a)(_,i,u),Object(y.a)(_,"version",m.version),_)));case 8:t({type:n.UPDATE_DATA}),Z("Task updated. [".concat(i,"=").concat(u,"]"));case 10:d.next=15;break;case 12:d.prev=12,d.t0=d.catch(1),Te(d.t0);case 15:case"end":return d.stop()}}),null,null,[[1,12]])}(e,t,a);case n.SIGN_OUT:return localStorage.removeItem(M.USERNAME),localStorage.removeItem(M.PASSWORD),void(X.a.defaults.headers.common.Authorization&&delete X.a.defaults.headers.common.Authorization);case n.SET_AUTH_TOKEN:return void function(e,t,a){if(e.type===n.SET_AUTH_TOKEN){var r=e.payload.auth_token;X.a.defaults.headers.common.Authorization="Bearer ".concat(r)}}(e);case n.SET_URL:return void function(e,t,a){if(e.type===n.SET_URL){var r=e.payload.url;L(M.URL,r)}}(e);case n.SET_PID:!function(e,t,a){if(e.type===n.SET_PID){var r=e.payload.pid;L(M.PID,r),localStorage.removeItem(M.MID);var c=P(M.CUSTOM_EID,r),o=P(M.CUSTOM_RID,r);t({type:n.SET_CUSTOM_EID,payload:{custom_eid:c}}),t({type:n.SET_CUSTOM_RID,payload:{custom_rid:o}})}}(e,t);break;case n.SET_MID:!function(e,t,a){if(e.type===n.SET_MID){var r=e.payload.mid,c=a().mid;L(M.MID,r);var o=m.a.compact(P(M.BIZ_DAYS,r).split(",")).sort();t({type:n.SET_BIZ_DAYS,payload:{biz_days:o}}),c&&r!==c&&t({type:n.RESET_TASK_ID});var s=P(M.TIMELIMIT_CLOSE_TASK,r);t({type:n.SET_TIMELIMIT_CLOSE_TASK,payload:{timelimit_close_task:s}})}}(e,t,a);break;case n.SET_CUSTOM_EID:!function(e,t,a){if(e.type===n.SET_CUSTOM_EID){var r=e.payload.custom_eid,c=U(M.PID);w(M.CUSTOM_EID,c,r)}}(e);break;case n.SET_CUSTOM_RID:!function(e,t,a){if(e.type===n.SET_CUSTOM_RID){var r=e.payload.custom_rid,c=U(M.PID);w(M.CUSTOM_RID,c,r)}}(e);break;case n.SET_BIZ_DAYS:case n.ADD_BIZ_DAY:case n.REMOVE_BIZ_DAY:!function(e,t,a){m.a.defer((function(){var e=a(),t=e.mid,n=e.biz_days;w(M.BIZ_DAYS,t,n.join(","))}))}(0,0,a);break;case n.ADD_REJECT_TASK_STATUS_ID:case n.REMOVE_REJECT_TASK_STATUS_ID:!function(e,t,a){m.a.defer((function(){var e=a(),t=e.pid,n=e.reject_task_status_ids;w(M.REJECT_TASK_STATUS_IDS,t,n.join(","))}))}(0,0,a);break;case n.ADD_POMODORO:!function(e,t,a){var r,c,o,s,l,i,u,_,d,E,O,f,S;p.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(e.type!==n.ADD_POMODORO||!e.meta){b.next=15;break}return r=a(),c=r.url,o=r.task_id,s=r.custom_rid,l=e.meta,i=l.completedAt,u=l.duration,_=l.pure,d=T()(i).format("YYYY-MM-DD"),b.next=6,p.a.awrap(ee.items.put({completedAt:i,duration:u,pure:_,dateKey:d}));case 6:if(t({type:n.CALC_POMODORO_TOTAL,payload:{dateKey:d}}),!o||!s){b.next=15;break}return b.next=10,p.a.awrap(Ee(c,"tasks/custom-attributes-values/".concat(o)));case 10:E=b.sent,O=E.data,f=Number(m.a.get(O,"attributes_values.".concat(s),"0"))+.5,S=O.version,O&&S&&t({type:n.PATCH_CUSTOM_VALUE,payload:{id:Number(o),key:s,value:f,version:S},meta:{use_pomodoro:{used_number:1},update_status:!0}});case 15:case"end":return b.stop()}}))}(e,t,a),$(0,0,a);break;case n.USE_POMODORO:case n.RESET_POMODORO:$(0,0,a);break;case n.CALC_POMODORO_TOTAL:!function(e,t,a){var r,c,o,s,l,i,u;p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.type!==n.CALC_POMODORO_TOTAL){a.next=14;break}return r=e.payload,a.next=4,p.a.awrap(ee.totals.get(r));case 4:return c=a.sent,a.next=7,p.a.awrap(ee.items.where(r).toArray());case 7:o=a.sent,s=o.length,l=m.a.filter(o,{pure:!0}).length,i=T()(r.dateKey,"YYYY-MM-DD").day(),u=T()(r.dateKey,"YYYY-MM-DD").toDate(),ee.totals.put(Object(H.a)({},c,{},r,{date:u,value:s,pureValue:l,dayOfWeek:i})),t({type:n.LOAD_POMODORO_TOTALS});case 14:case"end":return a.stop()}}))}(e,t);break;case n.LOAD_POMODORO_TOTALS:!function(e,t,a){var r;p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.awrap(ee.totals.toArray());case 2:r=e.sent,t({type:n.SET_POMODORO_TOTALS,payload:{pomodoro_daily_totals:r}});case 4:case"end":return e.stop()}}))}(0,t);break;case n.SET_TASK_ID:case n.RESET_TASK_ID:!function(e,t,a){m.a.defer((function(){var e=a().task_id;e?L(M.TASK_ID,e):localStorage.removeItem(M.TASK_ID)}))}(0,0,a);break;case n.SET_TIMELIMIT_CLOSE_TASK:!function(e,t,a){if(e.type===n.SET_TIMELIMIT_CLOSE_TASK){var r=e.payload.timelimit_close_task,c=!!e.meta&&e.meta.customize,o=a().mid;r&&c&&w(M.TIMELIMIT_CLOSE_TASK,o,r)}}(e,0,a);break;case n.ADD_FB_TIMER:!function(e,t,a){var r,c,o,s,l,i,u,m;p.a.async((function(_){for(;;)switch(_.prev=_.next){case 0:if(e.type!==n.ADD_FB_TIMER){_.next=7;break}return r=a(),c=r.token,o=r.pomodoro_mode,s=e.payload,l=s.title,i=s.body,u=s.remaining,_.next=5,p.a.awrap(_e(l,i,u,c,o));case 5:m=_.sent,t({type:n.SET_TIMER_ID,payload:{timer_id:m}});case 7:case"end":return _.stop()}}))}(e,t,a);break;case n.DEL_FB_TIMER:de(e,t,a);break;case n.SET_TIMER_ID:!function(e,t,a){if(e.type===n.SET_TIMER_ID){var r=e.payload.timer_id;r?L(M.TIMER_ID,r):localStorage.removeItem(M.TIMER_ID)}}(e)}},Se=function(e){!function(e){var t=U(M.URL),a=U(M.TIMER_ID),r=U(M.PID),c=U(M.MID),o=P(M.CUSTOM_EID,r),s=P(M.CUSTOM_RID,r),l=m.a.compact(P(M.BIZ_DAYS,c).split(",")).sort(),i=m.a.compact(P(M.REJECT_TASK_STATUS_IDS,r).split(",")),u=!(t&&r&&c&&o&&s),_=U(M.POMODORO_DATE),d=Number(U(M.POMODORO_NUMBER)||"0"),E=Number(U(M.POMODORO_USED_NUMBER)||"0"),p=U(M.TASK_ID);a&&e({type:n.SET_TIMER_ID,payload:{timer_id:a}}),t&&e({type:n.SET_URL,payload:{url:t}}),r&&e({type:n.SET_PID,payload:{pid:r}}),c&&e({type:n.SET_MID,payload:{mid:c}}),o&&e({type:n.SET_CUSTOM_EID,payload:{custom_eid:o}}),s&&e({type:n.SET_CUSTOM_RID,payload:{custom_rid:s}}),l.length&&e({type:n.SET_BIZ_DAYS,payload:{biz_days:l}}),i.length&&e({type:n.SET_REJECT_TASK_STATUS_IDS,payload:{reject_task_status_ids:i}}),p&&e({type:n.SET_TASK_ID,payload:{task_id:p}}),u&&e({type:n.OPEN_CONTROLLER}),_&&e({type:n.RESTORE_POMODORO,payload:{pomodoro_date:_,pomodoro_number:d,pomodoro_used_number:E}}),e({type:n.LOADED}),e({type:n.LOAD_POMODORO_TOTALS})}(e),m.a.defer((function(){!function(e){var t=U(M.USERNAME),a=U(M.PASSWORD);e({type:n.SIGN_IN,payload:{username:t,password:a}})}(e)}))},be=function(e){return"".concat(e.replace(/[\xa5/]$/,""),"/api/v1")},ye=function(e,t){return m.a.find(e,{id:t})},ve=Object(r.createContext)({state:K,dispatch:function(e){}}),ke=function(e){var t=e.children,a=function(e,t){var a=Object(i.a)(e,2),n=a[0],c=a[1],o=null,s=Object(r.useCallback)((function(e){o&&o(e)}),[o]),l=Object(r.useMemo)((function(){return function(){var e;return{getter:function(){return e},setter:function(t){e=t}}}()}),[]);return l.setter(n),[n,o=Object(r.useCallback)(Y(l.getter,c,t,s),[])]}(Object(r.useReducer)(B,K),fe),o=Object(i.a)(a,2),s=o[0],l=o[1],u={state:s,dispatch:l};return Object(r.useEffect)((function(){s.url&&l({type:n.FETCH_PROJECTS})}),[l,s.url]),Object(r.useEffect)((function(){s.url&&s.pid&&(l({type:n.FETCH_MILESTONES,payload:{project:s.pid}}),l({type:n.FETCH_CUSTOM_ATTRS,payload:{project:s.pid}}),l({type:n.FETCH_TASK_STATUSES,payload:{project:s.pid}}),l({type:n.FETCH_PROJECT,payload:{pid:s.pid}}))}),[s.url,s.pid,l]),Object(r.useEffect)((function(){s.url&&s.mid&&s.milestone.id&&s.timelimit_close_task&&l({type:n.FETCH_TASKS,payload:{milestone:s.mid,reject_task_status_ids:s.reject_task_status_ids,timelimit_close_task:s.timelimit_close_task}})}),[s.url,s.mid,s.updated_time,s.reject_task_status_ids,l,s.milestone.id,s.timelimit_close_task]),Object(r.useEffect)((function(){l({type:n.FETCH_CUSTOM_VALUE_MAP,payload:{tasks:s.tasks}})}),[l,s.tasks,s.custom_eid,s.custom_rid]),Object(r.useEffect)((function(){var e=m.a.chain(s.task_statuses).reject((function(e){return m.a.includes(s.reject_task_status_ids,String(e.id))})).orderBy((function(e){return e.order})).value();l({type:n.SET_ACTIVE_TASK_STATUSES,payload:{active_task_statuses:e}})}),[s.task_statuses,s.reject_task_status_ids,l]),Object(r.useEffect)((function(){var e=ye(s.custom_attrs,Number(s.custom_eid));e&&l({type:n.SET_CUSTOM_ATTR_E,payload:{custom_attr_e:e}})}),[l,s.custom_attrs,s.custom_eid]),Object(r.useEffect)((function(){var e=ye(s.custom_attrs,Number(s.custom_rid));e&&l({type:n.SET_CUSTOM_ATTR_R,payload:{custom_attr_r:e}})}),[l,s.custom_attrs,s.custom_rid]),Object(r.useEffect)((function(){var e,t,a=(e=s.milestones,t=s.mid,e.find((function(e){return String(e.id)===t})));a&&l({type:n.SET_MILESTONE,payload:{milestone:a}})}),[l,s.mid,s.milestones]),Object(r.useEffect)((function(){if(s.tasks.length>0&&s.user){var e=(t=s.tasks,a=s.user.id,m.a.chain(t).filter({assigned_to:a}).sortBy("user_story").value());l({type:n.SET_USER_TASKS,payload:{user_tasks:e}})}var t,a}),[l,s.tasks,s.user]),Object(r.useEffect)((function(){Se(l)}),[l]),Object(r.useEffect)((function(){if(s.task_id){var e=s.tasks.find((function(e){return e.id===Number(s.task_id)}));e&&l({type:n.SET_TASK,payload:{task:e}})}}),[l,s.task_id,s.tasks]),Object(r.useEffect)((function(){var e=s.biz_days[0];if(e&&!s.timelimit_close_task){var t="".concat(T()(e).local().startOf("day").format("YYYY-MM-DD"),"T12:00");l({type:n.SET_TIMELIMIT_CLOSE_TASK,payload:{timelimit_close_task:t}})}}),[l,s.biz_days,s.milestone,s.timelimit_close_task]),Object(r.useEffect)((function(){if(s.task_statuses.length>0){var e=s.task_statuses.find((function(e){return"in-progress"===e.slug}));e&&l({type:n.SET_IN_PROGRESS_TASK_STATUS_ID,payload:{task_status_id:String(e.id)}})}}),[l,s.task_statuses,s.task_statuses.length]),Object(r.useEffect)((function(){ue&&(ue.onTokenRefresh((function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ue){t.next=5;break}return t.next=3,p.a.awrap(ue.getToken());case 3:e=t.sent,l({type:n.SET_TOKEN,payload:{token:e}});case 5:case"end":return t.stop()}}))})),ue.getToken().then((function(e){l({type:n.SET_TOKEN,payload:{token:e}})})))}),[l]),Object(r.useEffect)((function(){Object.values(b).forEach((function(e){me.where("mode","==",e).onSnapshot((function(t){l({type:n.SET_POMODORO_LIVE_COUNT,payload:{mode:e,value:t.size}})}))}))}),[l]),c.a.createElement(ve.Provider,{value:u},t)},he=a(533),je=a(534),ge=a(537),Ce=a(538),Ae=a(536),De=a(527),Re=a(528),Ie=a(529),Me=a(225),Ne=function(e){e.preventDefault()},xe=function(e){e.stopPropagation()},Ue=a(106),Pe=function(){return c.a.createElement(Ue.a,{progress:0,buffer:0,className:"my-auto mx-2 border-0 form-control"})},Le=function(){var e=Object(r.useContext)(ve),t=e.state,a=t.pid,o=t.projects,s=e.dispatch,l=Object(r.useCallback)((function(e){var t=e.target.value;t&&s({type:n.SET_PID,payload:{pid:t}})}),[s]);return c.a.createElement(De.a,{className:"col"},c.a.createElement(Re.a,{addonType:"prepend"},"Project"),m.a.isEmpty(o)?c.a.createElement(Pe,null):c.a.createElement(Ie.a,{value:a,type:"select",onChange:l},c.a.createElement("option",{value:""}," --- "),o.map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)}))))},we=function(){var e=Object(r.useContext)(ve),t=e.state,a=t.milestones,o=t.mid,s=e.dispatch,l=Object(r.useCallback)((function(e){var t=e.target.value;t&&s({type:n.SET_MID,payload:{mid:t}})}),[s]);return c.a.createElement(De.a,{className:"col"},c.a.createElement(Re.a,{addonType:"prepend"},"Sprint"),m.a.isEmpty(a)?c.a.createElement(Pe,null):c.a.createElement(Ie.a,{type:"select",value:o,onChange:l},c.a.createElement("option",{value:""}," --- "),a.map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)}))))},Ke=function(){var e=Object(r.useContext)(ve),t=e.state,a=t.custom_attrs,o=t.custom_eid,s=t.custom_rid,l=e.dispatch,i=Object(r.useCallback)((function(e){var t=e.target.value;if(t)switch(e.target.name){case"eid":l({type:n.SET_CUSTOM_EID,payload:{custom_eid:t}});break;case"rid":l({type:n.SET_CUSTOM_RID,payload:{custom_rid:t}})}}),[l]);return c.a.createElement("div",{className:"row"},c.a.createElement(De.a,{className:"col"},c.a.createElement(Re.a,{addonType:"prepend"},"Estimate"),m.a.isEmpty(a)?c.a.createElement(Pe,null):c.a.createElement(Ie.a,{value:o,name:"eid",type:"select",onChange:i},c.a.createElement("option",{value:""}," --- "),a.map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)})))),c.a.createElement(De.a,{className:"col"},c.a.createElement(Re.a,{addonType:"prepend"},"Result"),m.a.isEmpty(a)?c.a.createElement(Pe,null):c.a.createElement(Ie.a,{value:s,name:"rid",type:"select",onChange:i},c.a.createElement("option",null," --- "),a.map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)})))))},Fe=a(530),He=a(531),Be=a(555),Ye=a(532),ze=a(110),Ve=a.n(ze),Ge=function(e,t){return-1===t?"":0===t?"Planning":"Day ".concat(t)},Je=function(e){return e.filter((function(e){return Ve.a.isWeekDay(e)})).map((function(e){return e.format("YYYY-MM-DD")}))},Ze=function(e){return{"text-danger":0===e,"text-info":6===e}},We=function(e){var t=e.item,a=e.idx,o=Object(r.useContext)(ve),s=o.state.biz_days,l=o.dispatch,i=Object(r.useCallback)((function(e){var t=e.target.value;e.target.checked?l({type:n.ADD_BIZ_DAY,payload:{biz_day:t}}):l({type:n.REMOVE_BIZ_DAY,payload:{biz_day:t}})}),[l]);if(!t)return c.a.createElement("td",null,c.a.createElement("br",null));var u=t.format("YYYY-MM-DD"),_=u===s[0],E="biz-day-".concat(u),p=m.a.includes(s,u);return c.a.createElement(c.a.Fragment,null,c.a.createElement("td",{className:d()(Ze(a),{"table-info":_}),id:E},Ve.a.isWeekDay(t)?c.a.createElement(Fe.a,{check:!0,inline:!0},c.a.createElement(He.a,{check:!0},c.a.createElement(Ie.a,{onChange:i,disabled:Ve.a.isWeekendDay(t),value:u,type:"checkbox",checked:p,className:"form-check-input"}),u)):c.a.createElement("span",null,u)),p?c.a.createElement(Be.a,{target:E},function(e,t){var a=t.indexOf(e);return Ge(0,a)}(u,s)):null)},qe=function(){var e=Object(r.useContext)(ve),t=e.state,a=t.biz_days,o=t.milestone,s=e.dispatch,l=Object(r.useState)([]),u=Object(i.a)(l,2),_=u[0],E=u[1],p=Object(r.useState)([]),O=Object(i.a)(p,2),f=O[0],S=O[1];return Object(r.useEffect)((function(){if(o){var e=function(e){var t=T()(e.estimated_start).local(),a=T()(e.estimated_finish).local().diff(t,"days");return m.a.times(a).map((function(e){return t.clone().add(e,"days")}))}(o);E(e),a.length<=1&&s({type:n.SET_BIZ_DAYS,payload:{biz_days:Je(e)}})}}),[o,a,s]),Object(r.useEffect)((function(){if(_.length>0){var e=m.a.chunk([].concat(Object(F.a)(m.a.times(_[0].day(),(function(){return null}))),Object(F.a)(_)),7);S(e)}}),[_]),c.a.createElement(Ye.a,{bordered:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,T.a.weekdays().map((function(e,t){return c.a.createElement("th",{key:t,className:d()("text-center",Ze(t))},e)})))),c.a.createElement("tbody",null,f.map((function(e,t){return c.a.createElement("tr",{key:t},e.map((function(e,t){return c.a.createElement(We,{idx:t,key:t,item:e})})))}))))},Qe=function(){var e=Object(r.useContext)(ve).state.milestone;return c.a.createElement(he.a,null,c.a.createElement(je.a,null,"Business Days"),m.a.isEmpty(e)?c.a.createElement(De.a,null,c.a.createElement(Pe,null)):c.a.createElement(qe,null))},Xe=a(535),$e=function(e){var t=e.item,a=Object(r.useContext)(ve),o=a.state.reject_task_status_ids,s=a.dispatch,l=Object(r.useCallback)((function(e){var t=e.target.value;e.target.checked?s({type:n.REMOVE_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}}):s({type:n.ADD_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}})}),[s]);return c.a.createElement(Fe.a,{check:!0,inline:!0},c.a.createElement(He.a,{check:!0},c.a.createElement(Ie.a,{onChange:l,type:"checkbox",value:t.id,defaultChecked:!m.a.includes(o,String(t.id))}),t.name))},et=function(){var e=Object(r.useContext)(ve).state.task_statuses;return 0===e.length?null:c.a.createElement(he.a,null,c.a.createElement(je.a,null,"Task status"),c.a.createElement(Xe.a,null,e.map((function(e){return c.a.createElement($e,{key:e.id,item:e})}))))},tt=a(223),at=function(){return c.a.createElement(Re.a,{addonType:"append"},c.a.createElement(tt.a,null,c.a.createElement(z.a,{icon:V.D,className:"fa-pulse"})))},nt=function(){var e=Object(r.useContext)(ve),t=e.state.timelimit_close_task,a=e.dispatch,o=Object(r.useState)(""),s=Object(i.a)(o,2),l=s[0],u=s[1],_=Object(r.useState)(!1),d=Object(i.a)(_,2),E=d[0],p=d[1],O=Object(r.useCallback)((function(e){u(e.target.value)}),[]),T=Object(r.useCallback)((function(e){l&&a({type:n.SET_TIMELIMIT_CLOSE_TASK,payload:{timelimit_close_task:l},meta:{customize:!0}}),e.preventDefault()}),[l,a]);return Object(r.useEffect)((function(){t&&(p(!0),m.a.defer(p,!1))}),[t]),c.a.createElement(Ae.a,{onSubmit:T},c.a.createElement(De.a,null,c.a.createElement(Re.a,{addonType:"prepend"},"Timelimit for closing old tasks"),E?c.a.createElement(at,null):c.a.createElement(Ie.a,{defaultValue:t,onChange:O,type:"datetime-local"}),c.a.createElement(Re.a,{addonType:"append"},c.a.createElement(Me.a,null,"Set"))))},rt=a(226),ct=a.n(rt),ot=function(e){var t=e.isOpen?90:void 0;return c.a.createElement(z.a,{className:"text-muted mr-2",rotation:t,icon:V.d})},st=function(){var e=Object(r.useContext)(ve),t=e.state,a=t.url,o=t.isOpen,s=t.biz_days,l=t.milestone,u=e.dispatch,_=Object(r.useState)(""),E=Object(i.a)(_,2),p=E[0],O=E[1],T=Object(r.useCallback)((function(e){O(e.target.value)}),[O]),f=Object(r.useCallback)((function(e){p&&u({type:n.SET_URL,payload:{url:p}}),e.preventDefault()}),[p,u]),S=Object(r.useCallback)((function(){u(o?{type:n.CLOSE_CONTROLLER}:{type:n.OPEN_CONTROLLER})}),[u,o]),b=Object(r.useMemo)((function(){return function(e,t){return e&&t.project_extra_info?"".concat(e,"/project/").concat(t.project_extra_info.slug,"/taskboard/").concat(t.slug):""}(a,l)}),[l,a]),y=l.name,v=Object(r.useMemo)((function(){return function(e){return e.length>1?"[".concat(m.a.head(e)," - ").concat(m.a.last(e),"]"):""}(s)}),[s]);return c.a.createElement(he.a,null,c.a.createElement(je.a,{className:d()(ct.a.header),onClick:S},c.a.createElement(ot,{isOpen:o}),y&&c.a.createElement(ge.a,{color:"primary",pill:!0,className:"p-1 m-1"},c.a.createElement("span",null,y)),v&&c.a.createElement(ge.a,{className:"p-1 m-1"},c.a.createElement("span",null,v)),b?c.a.createElement("a",{target:"_blank",onClick:xe,className:"float-right",href:b,rel:"noopener noreferrer"},c.a.createElement(z.a,{className:"mr-1",icon:V.m}),"Taskboard"):null),c.a.createElement(Ce.a,{isOpen:o},c.a.createElement(Ae.a,{onSubmit:f},c.a.createElement(De.a,null,c.a.createElement(Re.a,{addonType:"prepend"},"URL"),c.a.createElement(Ie.a,{defaultValue:a,onChange:T,placeholder:"http://hostname:port"}),c.a.createElement(Re.a,{addonType:"append"},c.a.createElement(Me.a,null,"Set")))),c.a.createElement("div",{className:"row"},c.a.createElement(Le,null),c.a.createElement(we,null)),c.a.createElement(Ke,null),c.a.createElement(nt,null),c.a.createElement(Qe,null),c.a.createElement(et,null)))},lt=a(70),it=a(52),ut=a(227),mt=a(540),_t=a(541),dt=function(){var e=Object(r.useContext)(ve).dispatch,t=Object(r.useCallback)((function(){e({type:n.UPDATE_DATA})}),[e]);return c.a.createElement(Me.a,{onClick:t},c.a.createElement(z.a,{icon:V.E}))},Et=a(147),pt=a.n(Et),Ot=a(539),Tt=function(){var e=Object(r.useContext)(ve),t=e.state,a=t.auth_token,o=t.auth_error,s=t.username,l=e.dispatch,u=Object(r.useState)(""),m=Object(i.a)(u,2),_=m[0],d=m[1],E=Object(r.useState)(""),p=Object(i.a)(E,2),O=p[0],T=p[1],f=Object(r.useState)(!1),S=Object(i.a)(f,2),b=S[0],y=S[1],v=Object(r.useCallback)((function(e){_&&O&&(y(!0),l({type:n.SIGN_IN,payload:{username:_,password:O}})),e.preventDefault()}),[O,_,l,y]),k=Object(r.useCallback)((function(e){d(e.target.value)}),[d]),h=Object(r.useCallback)((function(e){T(e.target.value)}),[T]),j=Object(r.useCallback)((function(){l({type:n.SIGN_OUT})}),[l]);return Object(r.useEffect)((function(){(o||a)&&y(!1)}),[o,a,y]),c.a.createElement(c.a.Fragment,null,a?c.a.createElement(Ae.a,{inline:!0,onSubmit:Ne,className:"mr-1"},c.a.createElement(De.a,null,c.a.createElement(Re.a,{addonType:"prepend"},c.a.createElement(tt.a,null,c.a.createElement(z.a,{icon:V.H}))),c.a.createElement(Re.a,{addonType:"prepend",className:"border border-success"},c.a.createElement(tt.a,null,s)),c.a.createElement(Re.a,{addonType:"append"},c.a.createElement(Me.a,{title:"Sign out",onClick:j,color:"danger"},c.a.createElement(z.a,{icon:V.C}))))):c.a.createElement(Ae.a,{inline:!0,onSubmit:v,className:"mr-1"},c.a.createElement(De.a,null,c.a.createElement(Re.a,{addonType:"prepend"},c.a.createElement(tt.a,null,c.a.createElement(z.a,{icon:V.H}))),c.a.createElement(Ie.a,{disabled:b,onInput:k,onChange:k,name:"username",placeholder:"username",invalid:o})),c.a.createElement(De.a,null,c.a.createElement(Re.a,{addonType:"prepend"},c.a.createElement(tt.a,null,c.a.createElement(z.a,{icon:V.s}))),c.a.createElement(Ie.a,{disabled:b,onInput:h,onChange:h,name:"password",placeholder:"password",type:"password",invalid:o})),c.a.createElement(Me.a,{color:"info"},b?c.a.createElement(Ot.a,{size:"sm",type:"grow"}):c.a.createElement(z.a,{icon:V.B}))))},ft=["success","warning","info","danger"],St=function(e){return m.a.groupBy(e,"assigned_to")},bt=function(e){var t=e.src||"http://i.pravatar.cc/80?u=".concat(Math.random());return c.a.createElement(ut.a,Object.assign({},e,{src:t,square:!0,className:"mr-1"}))},yt=function(e,t,a){return e.has(t)?(n=m.a.get(e.get(t),"attributes_values.".concat(a),"0"),m.a.chain(n).replace(/[^0-9.+,]/g,"").replace(/[+]/g,",").split(",").compact().map(Number).sum().value()):0;var n},vt=function(e,t,a){return m.a.chain(t).map((function(t){return yt(e,t,a)})).sum().value()},kt=function(e,t,a){return vt(e,t.filter((function(e){return e.is_closed})),a)},ht=function(e,t){return e.has(t)?m.a.get(e.get(t),"version"):void 0},jt=function(e,t,a){return a&&t===e},gt=function(e,t){return t>e},Ct=function(e){var t=e.username,a=e.val,n=e.total,o=e.imgSrc,s=Object(r.useMemo)((function(){var e=n>0?(a-n)/n:0;return e<-.1?[V.o,""]:e<=.1?[V.o,"table-success"]:e<=.2?[V.p,"table-warning"]:[V.h,"table-danger"]}),[n,a]),l=Object(i.a)(s,2),u=l[0],m=l[1];return a?c.a.createElement(c.a.Fragment,null,c.a.createElement("td",{className:m},c.a.createElement(bt,{src:o})," ",t,c.a.createElement(z.a,{className:"mx-1",icon:u})),c.a.createElement("td",{className:d()(m,"text-right")},a)):c.a.createElement(c.a.Fragment,null,c.a.createElement("td",null,c.a.createElement(bt,{src:o})," ",t),c.a.createElement("td",null))},At=function(e){var t=e.e,a=e.r,n=Object(r.useMemo)((function(){return function(e,t){if(m.a.isNumber(e)&&m.a.isNumber(t)&&e>0){var a=Math.abs(e-t)/e;if(a<=.05)return["gold",3];if(a<=.1)return["silver",2];if(a<.2)return["bronze",1]}return[null,0]}(t,a)}),[t,a]),o=Object(i.a)(n,2),s=o[0],l=o[1];return s?c.a.createElement(c.a.Fragment,null,m.a.times(l).map((function(e){return c.a.createElement(z.a,{key:e,className:pt.a[s],icon:V.v})}))):null},Dt=function(e){var t=e.tasks,a=Object(r.useContext)(ve).state,n=a.active_task_statuses,o=a.custom_eid,s=a.custom_value_map,l=Number(o),i=Object(r.useMemo)((function(){return m.a.chain(n).filter({is_closed:!0}).reverse().map((function(e,a){return{status:e.id,total:vt(s,m.a.filter(t,{status:e.id}),l),style:ft[a],label:e.name}})).value()}),[n,s,l,t]),u=Object(r.useMemo)((function(){return vt(s,t,l)}),[s,l,t]);return c.a.createElement(mt.a,{multi:!0},i.map((function(e){return c.a.createElement(mt.a,{key:e.label,bar:!0,max:u,value:e.total,color:e.style},e.label)})))},Rt=function(e){var t=e.item,a=e.sums,n=e.isPast,o=e.total,s=e.hpd,l=e.tasks,u=Object(r.useState)(0),_=Object(i.a)(u,2),d=_[0],E=_[1],p=Object(r.useCallback)((function(e){E(Number(e.target.value)||0)}),[E]),O=m.a.get(a,t.id),T=m.a.get(O,"e"),f=m.a.get(O,"r"),S=d||o,b=String(S);return c.a.createElement("tr",{key:t.id},o>0?c.a.createElement(c.a.Fragment,null,c.a.createElement(Ct,{username:t.username,val:T,total:S,imgSrc:t.photo}),c.a.createElement("td",{className:"text-right"},o),c.a.createElement("td",{className:pt.a.custom_input_td},c.a.createElement(Ie.a,{bsSize:"sm",type:"number",className:"text-right",value:b,step:s,onChange:p}))):c.a.createElement(c.a.Fragment,null,c.a.createElement("td",null,c.a.createElement(bt,{src:t.photo}),c.a.createElement(lt.b,{to:"/".concat(t.id)},t.username)),c.a.createElement("td",{className:"text-right"},t.burn_down||""),c.a.createElement("td",{className:"text-right"},T),c.a.createElement("td",{className:"text-right"},f),c.a.createElement("td",null,m.a.isNumber(T)&&c.a.createElement(Dt,{tasks:l}))),n?c.a.createElement("td",null,c.a.createElement(At,{e:T,r:f})):null)},It=function(){var e=Object(r.useContext)(ve).state,t=e.tasks,a=e.custom_value_map,n=e.custom_eid,o=e.custom_rid,s=e.biz_days,l=e.custom_attr_e,u=e.custom_attr_r,_=e.project.members,d=Object(r.useState)(0),E=Object(i.a)(d,2),p=E[0],O=E[1],f=s.length-1,S=Object(r.useCallback)((function(e){O(Number(e.target.value)||0)}),[O]),b=p*f,y=Object(r.useMemo)((function(){return function(e,t,a,n){var r=Number(a),c=Number(n);return m.a.mapValues(St(e),(function(e){return m.a.chain(e).map((function(e){return{e:yt(t,e,r),r:yt(t,e,c)}})).reduce((function(e,t){return{e:e.e+t.e,r:e.r+t.r}}),{e:0,r:0}).value()}))}(t,a,n,o)}),[n,o,a,t]),v=m.a.get(y,"null.e",0),k=b>0,h=Object(r.useMemo)((function(){return!k&&T()().diff(T()(m.a.last(s)).local().endOf("days"))>0}),[s,k]),j=Object(r.useMemo)((function(){return St(t)}),[t]),g=Object(r.useMemo)((function(){return m.a.chain(_).map((function(e){return Object(H.a)({},e,{burn_down:kt(a,j[e.id]||[],Number(n))})})).sortBy("burn_down").reverse().value()}),[n,a,_,j]);return!l.id||!u.id||s.length<=1?null:c.a.createElement(c.a.Fragment,null,c.a.createElement(_t.a,{color:"light",light:!0},c.a.createElement(Ae.a,{inline:!0,className:"mr-auto",onSubmit:Ne},c.a.createElement(De.a,null,c.a.createElement(Ie.a,{type:"number",step:"0.5",placeholder:"hours / day",className:"text-right",onChange:S}),c.a.createElement(Re.a,{addonType:"append"},c.a.createElement(tt.a,null,c.a.createElement(z.a,{className:"mx-2",icon:V.G}),f," [days]",c.a.createElement(z.a,{className:"mx-2",icon:V.j})),b>0?c.a.createElement(c.a.Fragment,null,c.a.createElement(tt.a,{className:"bg-white"},c.a.createElement("strong",null,b)),c.a.createElement(tt.a,null,"hours / sprint")):null))),c.a.createElement(Tt,null),c.a.createElement(dt,null)),c.a.createElement(Ye.a,{bordered:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Name"),!k&&c.a.createElement("th",{className:"text-success"},"Completed"),c.a.createElement("th",null,l.name),k?c.a.createElement(c.a.Fragment,null,c.a.createElement("th",null,"Total")," ",c.a.createElement("th",null,"Custom")):c.a.createElement(c.a.Fragment,null,c.a.createElement("th",null,u.name),c.a.createElement("th",null,"Progress")),h?c.a.createElement("th",null,"Grade"):null)),c.a.createElement("tbody",null,(g||[]).map((function(e){return c.a.createElement(Rt,{key:e.id,isPast:h,item:e,sums:y,total:b,hpd:p,tasks:j[e.id]||[]})})),c.a.createElement("tr",{key:"null"},c.a.createElement("td",{className:"text-danger"},c.a.createElement(z.a,{icon:V.n,className:"ml-1 mr-2 fa-lg"}),"Not assigned"),!k&&c.a.createElement("td",null),c.a.createElement("td",{className:"text-right text-danger"},v),c.a.createElement("td",null),c.a.createElement("td",null),h?c.a.createElement("td",null):null))))},Mt=a(543),Nt=a(544),xt=a(556),Ut=a(545),Pt=a(546),Lt=a(547),wt=a(548),Kt=a(549),Ft=a(550),Ht=a(551),Bt=a(242),Yt=a(230),zt=a.n(Yt),Vt=function(e){var t=e.label,a=e.value,n=e.onSubmit,o=e.onEditable,s=e.onValueChange,l=e.valid,u=e.invalid,m=e.disabled,_=e.loading,d=e.id,E=e.submitting,p=e.disabledMessage,O=void 0===p?"":p,T=Object(r.useState)(!1),f=Object(i.a)(T,2),S=f[0],b=f[1],y=Object(r.useState)(""),v=Object(i.a)(y,2),k=v[0],h=v[1],j=Object(r.useState)(!1),g=Object(i.a)(j,2),C=g[0],A=g[1],D=Object(r.useCallback)((function(e){b(e.currentTarget.checked)}),[b]),R=Object(r.useCallback)((function(e){var t=e.target.value;h(t),s&&s(Number(t))}),[s]),I=Object(r.useCallback)((function(e){var t=Number(k);S&&""!==k&&t>=0&&n&&(n(t),b(!1),A(!0)),e.preventDefault()}),[S,k,n,b]);return Object(r.useEffect)((function(){m&&b(!1)}),[b,m]),Object(r.useEffect)((function(){A(!1)}),[a]),Object(r.useEffect)((function(){o&&o(S)}),[S,o]),Object(r.useEffect)((function(){E&&(b(!1),A(!0))}),[E]),Object(r.useEffect)((function(){_&&b(!1)}),[_]),c.a.createElement(Ae.a,{inline:!0,onSubmit:I},c.a.createElement(De.a,{className:zt.a.input_group},c.a.createElement(Re.a,{addonType:"prepend"},t),_?c.a.createElement(at,null):c.a.createElement(c.a.Fragment,null,S?c.a.createElement(c.a.Fragment,null,c.a.createElement(Re.a,{addonType:"prepend"},c.a.createElement(tt.a,null,a)),c.a.createElement(Re.a,{addonType:"prepend"},c.a.createElement(tt.a,null,c.a.createElement(z.a,{className:"text-info",icon:V.q}))),c.a.createElement(Ie.a,{onInput:R,onChange:R,defaultValue:String(a),type:"number",step:"0.5",min:"0",id:d}),c.a.createElement(Re.a,{addonType:"append"},c.a.createElement(Me.a,{color:"info"},c.a.createElement(z.a,{icon:V.e})))):c.a.createElement(c.a.Fragment,null,C?c.a.createElement(at,null):c.a.createElement(Ie.a,{valid:l,invalid:u,readOnly:!0,value:a,className:"text-right"})),c.a.createElement(Re.a,{addonType:"append",title:m?O:""},c.a.createElement(Bt.a,{disabled:m,checked:S,onChange:D},c.a.createElement(z.a,{className:"text-info",icon:V.i}))))))};function Gt(){return(Gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Jt(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Zt,Wt=c.a.createElement("g",null,c.a.createElement("path",{fill:"currentColor",className:"leaf",d:"M115.343,123.839c0.814,1.256,3.343,2.605,7.23,4.014c7.586-1.069,14.943-1.586,21.885-1.586 c15.579,0,30.166,2.469,42.438,7.145c17.87-5.567,43.412-11.694,69.108-11.694c25.694,0,51.228,6.126,69.108,11.694 c12.262-4.676,26.848-7.145,42.42-7.145c7.001,0,14.418,0.518,22.063,1.604c3.471-1.341,6.296-2.699,8.325-4.031 c42.2-28.139,53.036-81.183,47.41-69.931c-4.218,8.418-60.309,35.581-100.004,52.222c14.68-17.769,31.677-44.134,43.438-80.309 c0,0-60.978,52.382-98.867,74.887c-11.974-20.816-33.892-86.589-33.892-86.589s-18.567,49.515-20.358,81.412 c-30.21-16.929-63.354-51.474-72.485-74.538c-10.752-27.189-13.78,53.545,15.436,89.396c-1.095,0.162-2.206,0.315-3.344,0.476 c-39.111-16.072-100.454-47.91-104.926-54.86C64.708,47.255,73.143,101.954,115.343,123.839z M290.531,107.181l0.747,0.857 l-3.098-0.746L290.531,107.181z"}),c.a.createElement("path",{fill:"currentColor",className:"tomato",d:"M485.83,198.564c-38.169-57.253-117.544-70.584-160.338-52.195c-18.27-5.906-43.872-12.27-69.49-12.27 c-25.619,0-51.228,6.364-69.499,12.27c-42.794-18.388-122.168-5.058-160.338,52.195c-64.136,96.203-18.711,299.318,229.836,299.318 C504.541,497.882,549.974,294.767,485.83,198.564z M101.172,262.929c-17.099,0-30.947-13.857-30.947-30.948 c0-17.09,13.848-30.947,30.947-30.947c17.082,0,30.947,13.857,30.947,30.947C132.119,249.071,118.253,262.929,101.172,262.929z"})),qt=function(e){var t=e.svgRef,a=e.title,n=Jt(e,["svgRef","title"]);return c.a.createElement("svg",Gt({id:"_x32_",x:"0px",y:"0px",viewBox:"0 0 512 512",xmlSpace:"preserve",ref:t},n),a?c.a.createElement("title",null,a):null,Wt)},Qt=c.a.forwardRef((function(e,t){return c.a.createElement(qt,Gt({svgRef:t},e))})),Xt=(a.p,a(84)),$t=a.n(Xt);!function(e){e.FRESH="fresh",e.STALE="stale"}(Zt||(Zt={}));var ea=function(e){var t,a=e.state,n=e.bl,r=e.br;return c.a.createElement(Qt,{className:d()("fa-fw","svg-inline--fa",(t={},Object(y.a)(t,$t.a.fresh,a===Zt.FRESH),Object(y.a)(t,$t.a.stale,a===Zt.STALE),Object(y.a)(t,$t.a.bl,n),Object(y.a)(t,$t.a.br,r),t))})},ta=a(111),aa=a.n(ta),na=function(e){var t=e.item,a=Object(r.useContext)(ve),o=a.state,s=o.task_id,l=o.pomodoro_mode,i=o.pomodoro_state,u=a.dispatch,m=Object(r.useCallback)((function(){Number(s)!==t.id&&u({type:n.SET_TASK_ID,payload:{task_id:String(t.id)}}),i===S.STOPPED?N.changeMode(b.FOCUS,!0):l===b.FOCUS?N.resume():N.changeMode(b.FOCUS,!0)}),[u,t.id,l,i,s]),_=Object(r.useCallback)((function(){N.pause()}),[]);return Number(s)===t.id?l===b.FOCUS&&i===S.RUNNING?c.a.createElement(Me.a,{className:d()("mr-2",aa.a.btn),color:"danger",onClick:_},c.a.createElement(z.a,{icon:V.x}),c.a.createElement(ea,null)):c.a.createElement(Me.a,{onClick:m,color:"primary",className:d()("mr-2",aa.a.btn)},c.a.createElement(z.a,{icon:V.y}),c.a.createElement(ea,null)):""===s?l===b.FOCUS&&i!==S.STOPPED?null:c.a.createElement(Me.a,{onClick:m,color:"primary",className:d()("mr-2",aa.a.btn)},c.a.createElement(z.a,{icon:V.y}),c.a.createElement(ea,null)):null},ra=function(e){var t=e.label,a=e.value,n=e.loading,r=e.size,o=e.invalid,s=e.valid;return c.a.createElement(De.a,{size:r,className:"my-n1"},c.a.createElement(Re.a,{addonType:"prepend"},t),n?c.a.createElement(at,null):c.a.createElement(Ie.a,{invalid:o,valid:s,readOnly:!0,value:a,className:"text-right"}))},ca=a(113),oa=a.n(ca),sa=a(112),la=a.n(sa),ia=a(85),ua=a.n(ia),ma=a(231),_a=a.n(ma),da=function(e){return m.a.chain(e).groupBy("user_story").map((function(e,t){return{user_story:Number(t),user_story_extra_info:e[0].user_story_extra_info,project_extra_info:e[0].project_extra_info,tasks:e,is_closed:e.every((function(e){return e.is_closed}))}})).value()},Ea=function(e){return e?"Need sign in!":""},pa=function(e){var t=e.user_story_extra_info,a=e.project_extra_info,n=Object(r.useContext)(ve).state.url,o=a.slug,s=t?"#".concat(t.ref," ").concat(t.subject):void 0,l=t?"".concat(n,"/project/").concat(o,"/us/").concat(t.ref):"#";return s?c.a.createElement("a",{href:l,onClick:xe,target:"_blank",rel:"noopener noreferrer",title:s},c.a.createElement(z.a,{icon:V.m})," ",s):c.a.createElement(c.a.Fragment,null,"(Unassigned tasks)")},Oa=function(e){var t=e.item,a=Object(r.useContext)(ve).state.url,n="#".concat(t.ref," ").concat(t.subject),o="".concat(a,"/project/").concat(t.project_extra_info.slug,"/task/").concat(t.ref);return c.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer",title:n},c.a.createElement(z.a,{icon:V.m})," ",n)},Ta=function(e){var t=e.e,a=e.r;return c.a.createElement(De.a,{className:ua.a.display_medal},c.a.createElement(Re.a,{addonType:"prepend"},"Grade"),c.a.createElement(_a.a,{className:ua.a.medal},c.a.createElement(At,{e:t,r:a})))},fa=function(e){var t=e.item,a=e.task,o=e.onSelect,s=Object(r.useContext)(ve).dispatch,l=Object(r.useCallback)((function(){s({type:n.PATCH_TASK,payload:{key:"status",value:t.id,id:a.id}}),o&&o(t.id)}),[s,t.id,a.id,o]);return c.a.createElement(Mt.a,{onClick:l},t.name)},Sa=function(e){var t=e.task,a=e.disabled,n=Object(r.useState)(!1),o=Object(i.a)(n,2),s=o[0],l=o[1],u=Object(r.useContext)(ve).state.active_task_statuses,m=Object(r.useCallback)((function(){l(!0)}),[l]);return Object(r.useEffect)((function(){l(!1)}),[t.version,l]),c.a.createElement(c.a.Fragment,null,s?c.a.createElement(Ot.a,{type:"grow",color:"info"}):c.a.createElement(Nt.a,null,c.a.createElement(xt.a,{title:Ea(a),disabled:a,caret:!a},t.status_extra_info.name),c.a.createElement(Ut.a,null,u.map((function(e){return c.a.createElement(fa,{item:e,key:e.id,task:t,onSelect:m})})))))},ba=function(e){var t=e.item,a=e.onSelect,n=Object(r.useCallback)((function(){a&&a(t.id)}),[t.id,a]);return c.a.createElement(Mt.a,{onClick:n},c.a.createElement(bt,{src:t.photo}),t.username)},ya=function(e){var t=e.task,a=e.disabled,o=Object(r.useState)(!1),s=Object(i.a)(o,2),l=s[0],u=s[1],m=Object(r.useContext)(ve),_=m.state.project.members,d=m.dispatch,E=Object(r.useCallback)((function(e){u(!0),d({type:n.PATCH_TASK,payload:{key:"assigned_to",value:e,id:t.id}})}),[d,t.id]);return Object(r.useEffect)((function(){u(!1)}),[t.version,u]),c.a.createElement(c.a.Fragment,null,l?c.a.createElement(Ot.a,{type:"grow",color:"info"}):c.a.createElement(Nt.a,null,c.a.createElement(xt.a,{title:Ea(a),size:"sm",disabled:a,caret:!a},"Assign To"),c.a.createElement(Ut.a,null,(_||[]).map((function(e){return c.a.createElement(ba,{item:e,onSelect:E,key:e.id})})))))},va=function(e){var t=e.task,a=Object(r.useState)(!1),o=Object(i.a)(a,2),s=o[0],l=o[1],u=Object(r.useContext)(ve).dispatch,m=Object(r.useCallback)((function(){l(!0),u({type:n.PATCH_TASK,payload:{key:"assigned_to",value:null,id:t.id}})}),[u,t.id]);return Object(r.useEffect)((function(){l(!1)}),[t.version,l]),c.a.createElement(c.a.Fragment,null,s?c.a.createElement(Ot.a,{type:"grow",color:"danger"}):c.a.createElement(Me.a,{className:"mr-2",title:"Not assigned",color:"danger",onClick:m},c.a.createElement(z.a,{icon:V.J})))},ka=function(e){var t=e.item,a=Object(r.useContext)(ve),o=a.state,s=o.custom_eid,l=o.custom_value_map,i=o.auth_token,u=o.custom_attr_e,m=a.dispatch,_=ht(l,t),d=Object(r.useCallback)((function(e){_&&m({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:s,value:e,version:_}})}),[m,t.id,s,_]),E=Object(r.useMemo)((function(){return yt(l,t,u.id)}),[u.id,l,t]);if(!u.id)return null;var p=!E,O=""===i,T=!_;return c.a.createElement(Vt,{onSubmit:d,label:u.name,value:E,invalid:p,disabled:O,loading:T,disabledMessage:"Need sign in!"})},ha=function(e){var t=e.item,a=Object(r.useState)(!1),o=Object(i.a)(a,2),s=o[0],l=o[1],u=Object(r.useState)(0),_=Object(i.a)(u,2),E=_[0],p=_[1],O=Object(r.useState)(!1),T=Object(i.a)(O,2),f=T[0],S=T[1],b=Object(r.useState)(!1),y=Object(i.a)(b,2),v=y[0],k=y[1],h=Object(r.useContext)(ve),j=h.state,g=j.custom_rid,C=j.custom_value_map,A=j.custom_attr_e,D=j.custom_attr_r,R=j.auth_token,I=j.pomodoro_number,M=j.pomodoro_used_number,N=h.dispatch,x=ht(C,t),U=Object(r.useCallback)((function(){l(!s)}),[s]),P=Object(r.useCallback)((function(e,a){var r=e>0,c=a?{used_number:a}:void 0;x&&(N({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:g,value:e,version:x},meta:{use_pomodoro:c,update_status:r}}),k(!0))}),[g,N,t.id,x]),L=Object(r.useCallback)((function(){p(E+1)}),[E]),w=Object(r.useCallback)((function(){p(E-1)}),[E]),K=Object(r.useCallback)((function(){p(0)}),[]),F=Object(r.useCallback)((function(e){S(e)}),[]),H=Object(r.useMemo)((function(){return yt(C,t,A.id)}),[A.id,C,t]),B=Object(r.useMemo)((function(){return yt(C,t,D.id)}),[D.id,C,t]),Y=Object(r.useCallback)((function(e){S(B===e)}),[B]),G=Object(r.useCallback)((function(){P(B+E/2,E),l(!1),p(0)}),[P,B,E]),J=Object(r.useMemo)((function(){return jt(H,B,t.is_closed)}),[H,t.is_closed,B]),Z=Object(r.useMemo)((function(){return gt(H,B)}),[H,B]);if(Object(r.useEffect)((function(){x||k(!1)}),[x]),Object(r.useEffect)((function(){p(0)}),[M]),!D.id)return null;var W=""===R,q=!x,Q="rusult-input-".concat(t.id),X=I-M,$=E>0,ee=E===X;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Vt,{onSubmit:P,onEditable:F,onValueChange:Y,label:D.name,value:B,valid:J,invalid:Z,disabled:W,loading:q,id:Q,submitting:v}),f&&X>0&&c.a.createElement(Pt.a,{className:d()("popover-wide"),target:Q,placement:"top",isOpen:s,toggle:U,trigger:"click hover"},c.a.createElement(Lt.a,null,"Pomodoro"),c.a.createElement(wt.a,null,c.a.createElement(Kt.a,null,c.a.createElement(Me.a,{disabled:ee,onClick:L},c.a.createElement(z.a,{icon:V.z})),c.a.createElement(Me.a,{disabled:!$,onClick:w},c.a.createElement(z.a,{icon:V.w})),c.a.createElement(Me.a,{disabled:!0,className:"bg-light"},m.a.times(X).map((function(e){return c.a.createElement(ea,{key:e,state:e>=E?Zt.FRESH:Zt.STALE})}))),c.a.createElement(Me.a,{disabled:!$,onClick:G},c.a.createElement(z.a,{icon:V.e})),c.a.createElement(Me.a,{disabled:!$,onClick:K},c.a.createElement(z.a,{icon:V.k}))))))},ja=function(e){var t=e.item,a=Object(r.useContext)(ve).state,n=a.custom_value_map,o=a.custom_attr_e,s=a.custom_attr_r,l=a.auth_token,i=Object(r.useMemo)((function(){return ht(n,t)}),[n,t]),u=Object(r.useMemo)((function(){return yt(n,t,o.id)}),[o.id,n,t]),m=Object(r.useMemo)((function(){return yt(n,t,s.id)}),[s.id,n,t]);if(!o.id||!s.id)return null;var _=""===l,E=!i,p=0===m&&!t.is_closed&&!_&&!E;return c.a.createElement(la.a,{className:d()(Object(y.a)({},ua.a.is_closed,t.is_closed))},c.a.createElement("div",{className:"d-flex mb-1"},c.a.createElement("div",{className:"mr-auto text-truncate"},c.a.createElement(Oa,{item:t})),p&&c.a.createElement(va,{task:t}),c.a.createElement(na,{item:t}),c.a.createElement(Sa,{task:t,disabled:_})),c.a.createElement(Ft.a,null,c.a.createElement(Ht.a,null,c.a.createElement(ka,{item:t})),c.a.createElement(Ht.a,null,c.a.createElement(ha,{item:t})),c.a.createElement(Ht.a,null,c.a.createElement(Ta,{e:u,r:m}))))},ga=function(e){var t=e.item;return c.a.createElement(he.a,null,c.a.createElement(je.a,{className:"text-truncate"},c.a.createElement(pa,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),c.a.createElement(oa.a,null,t.tasks.map((function(e){return c.a.createElement(la.a,{key:e.id,className:"text-truncate"},c.a.createElement("div",{className:"d-flex"},c.a.createElement("div",{className:"mr-auto text-truncate"},c.a.createElement(Oa,{item:e})),c.a.createElement(ka,{item:e})))}))))},Ca=function(e){var t=e.item,a=""===Object(r.useContext)(ve).state.auth_token;return c.a.createElement(he.a,null,c.a.createElement(je.a,{className:"text-truncate"},c.a.createElement(pa,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),c.a.createElement(Ce.a,{isOpen:!0},c.a.createElement(oa.a,null,t.tasks.map((function(e){return c.a.createElement(la.a,{key:e.id},c.a.createElement("div",{className:"d-flex"},c.a.createElement("div",{className:"mr-auto text-truncate"},c.a.createElement(Oa,{item:e})),c.a.createElement(ya,{task:e,disabled:a})))})))))},Aa=function(e){var t=e.item,a=Object(r.useState)(!1),n=Object(i.a)(a,2),o=n[0],s=n[1],l=Object(r.useContext)(ve).state,u=l.custom_value_map,m=l.custom_attr_e,_=l.custom_attr_r,E=Object(r.useCallback)((function(){s(!o)}),[o,s]);Object(r.useEffect)((function(){s(!t.is_closed)}),[t.is_closed,s]);var p=Object(r.useMemo)((function(){return vt(u,t.tasks,m.id)}),[m.id,u,t.tasks]),O=Object(r.useMemo)((function(){return vt(u,t.tasks,_.id)}),[_.id,u,t.tasks]),T=!u.has(t.tasks[0]);return c.a.createElement(he.a,null,c.a.createElement(je.a,{className:d()(ua.a.header,"text-truncate",{"alert-primary":t.is_closed}),onClick:E},c.a.createElement(Ft.a,null,c.a.createElement(Ht.a,{xs:12,md:8,className:"text-truncate"},c.a.createElement(ot,{isOpen:o}),c.a.createElement(pa,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),c.a.createElement(Ht.a,{xs:6,md:2},c.a.createElement(ra,{label:m.name,loading:T,value:p,size:"sm"})),c.a.createElement(Ht.a,{xs:6,md:2},c.a.createElement(ra,{label:_.name,loading:T,value:O,size:"sm"})))),c.a.createElement(Ce.a,{isOpen:o},c.a.createElement(oa.a,null,t.tasks.map((function(e){return c.a.createElement(ja,{item:e,key:e.id})})))))},Da=function(){var e=Object(r.useContext)(ve).state,t=e.tasks,a=e.custom_value_map,n=e.custom_eid,o=Object(r.useMemo)((function(){return Number(n)}),[n]),s=Object(r.useMemo)((function(){return o?t.filter((function(e){return ht(a,e)&&0===yt(a,e,o)})):[]}),[a,o,t]),l=Object(r.useMemo)((function(){return da(s)}),[s]);return 0===s.length?null:c.a.createElement(he.a,null,c.a.createElement(je.a,{className:"alert-danger"},"Un estimated tasks"),c.a.createElement(Xe.a,null,l.map((function(e){return c.a.createElement(ga,{item:e,key:e.user_story})}))))},Ra=function(){var e=Object(r.useContext)(ve).state.tasks,t=Object(r.useMemo)((function(){return m.a.filter(e,{assigned_to:null})}),[e]),a=Object(r.useMemo)((function(){return da(t)}),[t]);return 0===t.length?null:c.a.createElement(he.a,null,c.a.createElement(je.a,{className:"alert-danger"},"Not assigned tasks"),c.a.createElement(Xe.a,null,a.map((function(e){return c.a.createElement(Ca,{item:e,key:e.user_story})}))))},Ia=a(557),Ma=a(25),Na=function(e){var t=e.tasks,a=Object(r.useState)([]),n=Object(i.a)(a,2),o=n[0],s=n[1],l=Object(r.useContext)(ve).state,u=l.biz_days,_=l.custom_value_map,d=l.custom_eid,E=l.custom_rid;Object(r.useEffect)((function(){var e=u.length,a=Number(d),n=Number(E);if(e>0&&t.length>0&&d&&E){var r=vt(_,t,a),c=u.map((function(c,o){var s=Ge(0,o),l=r*o/(e-1),i=vt(_,La(t,c),a);return T()().local().endOf("days").diff(T()(c))>0?{label:s,ideal:l,completed:vt(_,Ua(t,c),a),actual:vt(_,Ua(t,c),n),total:i}:{label:s,ideal:l,total:i}}));s(c)}else s([])}),[t,u,d,E,_,s]);var p=Object(r.useCallback)((function(e,t){return[Number(e).toFixed(1),m.a.upperFirst(t)]}),[]);return 0===o.length?null:c.a.createElement(Ma.b,{data:o,width:800,height:400},c.a.createElement(Ma.g,null),c.a.createElement(Ma.f,{dataKey:"label"}),c.a.createElement(Ma.e,{formatter:p}),c.a.createElement(Ma.c,{formatter:m.a.upperFirst}),c.a.createElement(Ma.a,{dataKey:"completed",fill:"#28a745"}),c.a.createElement(Ma.a,{dataKey:"actual",fill:"#17a2b8"}),c.a.createElement(Ma.d,{dataKey:"ideal",stroke:"#007bff",strokeDasharray:"5 5"}),c.a.createElement(Ma.d,{dataKey:"total",stroke:"#dc3545"}))},xa=function(e){var t=e.tasks,a=Object(r.useState)([]),n=Object(i.a)(a,2),o=n[0],s=n[1],l=Object(r.useContext)(ve).state,u=l.biz_days,_=l.custom_value_map,d=l.custom_eid;Object(r.useEffect)((function(){var e=u.length,a=Number(d);if(e>0&&t.length>0&&d){var n=vt(_,La(t,u[0]),a),r=u.map((function(r,c){var o=Ge(0,c),s=n-n*c/(e-1);if(T()().local().endOf("days").diff(T()(r))>0){var l=0===c?0:vt(_,Pa(t,r),a);return{label:o,ideal:s,remaining:Math.max(vt(_,La(t,r),a)-l-vt(_,Ua(t,r),a),0),add:l}}return{label:o,ideal:s}}));s(r)}else s([])}),[t,u,d,_,s]);var E=Object(r.useCallback)((function(e,t){return[Number(e).toFixed(1),m.a.upperFirst(t)]}),[]);return 0===o.length?null:c.a.createElement(Ma.b,{data:o,width:800,height:400},c.a.createElement(Ma.g,null),c.a.createElement(Ma.f,{dataKey:"label"}),c.a.createElement(Ma.e,{formatter:E}),c.a.createElement(Ma.c,{formatter:m.a.upperFirst}),c.a.createElement(Ma.a,{dataKey:"remaining",fill:"#8884d8",stackId:"a"}),c.a.createElement(Ma.a,{dataKey:"add",fill:"#82ca9d",stackId:"a"}),c.a.createElement(Ma.d,{dataKey:"ideal"}))},Ua=function(e,t){return e.filter((function(e){return!!e.finished_date&&T()(t).local().endOf("days").diff(T()(e.finished_date))>0}))},Pa=function(e,t){return e.filter((function(e){return T()(t).local().format("YYYY-MM-DD")===T()(e.created_date).local().format("YYYY-MM-DD")}))},La=function(e,t){return e.filter((function(e){return T()(t).local().endOf("days").diff(T()(e.created_date))>0}))},wa=function(e){var t=e.type,a="Burn down"===t?V.t:V.u;return c.a.createElement("span",null,t,c.a.createElement(z.a,{className:"fa-fw",icon:a}))},Ka=function(e){var t=e.type,a=e.onSelect,n=Object(r.useCallback)((function(){a(t)}),[a,t]);return c.a.createElement(Mt.a,{onClick:n},c.a.createElement(wa,{type:t}))},Fa=function(e){var t=e.tasks,a=Object(r.useState)("Burn up"),n=Object(i.a)(a,2),o=n[0],s=n[1],l=Object(r.useCallback)((function(e){s(e)}),[]);return 0===t.length?null:c.a.createElement(he.a,{className:"mb-2"},c.a.createElement(je.a,{className:"d-flex"},c.a.createElement("div",{className:"mr-auto"},"Chart"),c.a.createElement(Ia.a,null,c.a.createElement(xt.a,{className:"my-n1",size:"sm",caret:!0},c.a.createElement(wa,{type:o})),c.a.createElement(Ut.a,null,c.a.createElement(Ka,{type:"Burn up",onSelect:l}),c.a.createElement(Ka,{type:"Burn down",onSelect:l})))),"Burn down"===o?c.a.createElement(xa,{tasks:t}):c.a.createElement(Na,{tasks:t}))},Ha=function(){var e=Object(r.useContext)(ve).state.tasks;return c.a.createElement(c.a.Fragment,null,c.a.createElement(It,null),c.a.createElement(Fa,{tasks:e}),c.a.createElement(Ra,null),c.a.createElement("br",null),c.a.createElement(Da,null))},Ba=a(553),Ya=a(552),za=function(){var e=Object(r.useContext)(ve).state,t=e.custom_value_map,a=e.biz_days,n=e.user_tasks,o=e.custom_attr_e,s=e.custom_attr_r,l=Object(r.useMemo)((function(){return da(n)}),[n]),i=Object(r.useMemo)((function(){return vt(t,n,o.id)}),[o.id,t,n]),u=Object(r.useMemo)((function(){return vt(t,n,s.id)}),[s.id,t,n]),m=Object(r.useMemo)((function(){return jt(i,u,l.every((function(e){return e.is_closed})))}),[i,u,l]),_=Object(r.useMemo)((function(){return gt(i,u)}),[i,u]),E=Object(r.useMemo)((function(){return n.some((function(e){return!ht(t,e)}))}),[t,n]);return!o.id||!s.id||a.length<=1?null:c.a.createElement(c.a.Fragment,null,l.map((function(e){return c.a.createElement(Aa,{item:e,key:e.user_story})})),c.a.createElement(he.a,null,c.a.createElement(je.a,{className:d()("alert-info")},"Total"),c.a.createElement(Xe.a,null,c.a.createElement(Ft.a,null,c.a.createElement(Ht.a,null,c.a.createElement(ra,{label:o.name,value:i,loading:E})),c.a.createElement(Ht.a,null,c.a.createElement(ra,{label:s.name,value:u,invalid:_,valid:m,loading:E})),c.a.createElement(Ht.a,null,c.a.createElement(Ta,{e:i,r:u})))),c.a.createElement(Ya.a,null,c.a.createElement(Dt,{tasks:n}))))},Va=function(){var e=Object(r.useContext)(ve).state.user;return c.a.createElement(he.a,null,e&&c.a.createElement(je.a,null,c.a.createElement(bt,{src:e.photo,size:"xlarge"}),e.username," 's task"))},Ga=function(){var e=Object(r.useContext)(ve),t=e.state,a=t.user,o=t.user_tasks,s=t.url,l=e.dispatch,i=Object(it.e)().uid;return Object(r.useEffect)((function(){return i&&s&&l({type:n.FETCH_USER,payload:{uid:i}}),function(){l({type:n.RESET_USER})}}),[l,i,s]),c.a.createElement(c.a.Fragment,null,c.a.createElement(_t.a,{color:"light",light:!0},c.a.createElement(Me.a,{tag:lt.b,to:"/",className:"mr-auto"},c.a.createElement(z.a,{icon:V.a})," Go back"),c.a.createElement(Tt,null),c.a.createElement(dt,null)),a?c.a.createElement(c.a.Fragment,null,c.a.createElement(Va,null),c.a.createElement("br",null),c.a.createElement(za,null),c.a.createElement("br",null),c.a.createElement(Fa,{tasks:o})):c.a.createElement(Ba.a,{color:"danger"},"This user does not exist."))},Ja=a(243),Za=a(151),Wa=a(554),qa=a(56),Qa=a.n(qa),Xa=a(239),$a=a.n(Xa),en=a(240),tn=a.n(en),an=a(241),nn=a.n(an),rn=function(){var e=Object(r.useContext)(ve).state.pomodoro_daily_totals,t=Object(r.useMemo)((function(){return e.map((function(e){return{date:e.dateKey,value:e.value,pureValue:e.pureValue}}))}),[e]),a=(m.a.maxBy(t,"value")||{value:1}).value,n=Object(r.useCallback)((function(e){return e?"style-pomodoro color-pomodoro-".concat(Math.ceil(8*(e.value||0)/a)):"style-pomodoro empty-pomodoro"}),[a]),o=Object(r.useCallback)((function(e){return e&&e.date?{"data-tip":"".concat(e.value," Pomodoros on ").concat(e.date)}:null}),[]),s=Object(r.useMemo)((function(){return T()().subtract(12,"month").toDate()}),[]);return 0===e.length?c.a.createElement(Ba.a,{color:"warning"},"No pomodoro history!"):c.a.createElement(c.a.Fragment,null,c.a.createElement(nn.a,{startDate:s,showWeekdayLabels:!0,values:t,classForValue:n,tooltipDataAttrs:o}),c.a.createElement(tn.a,null))},cn=new(a(516))({type:"rectangle"}),on=function(e){return Math.ceil(e/60)},sn=function(e){switch(e.mode){case b.SHORT:return c.a.createElement(z.a,{className:d()("fa-fw",Qa.a.short_break_icon),icon:V.f});case b.LONG:return c.a.createElement(z.a,{className:d()("fa-fw",Qa.a.long_break_icon),icon:V.g});default:return c.a.createElement(ea,{state:Zt.FRESH})}},ln=function(e){var t=e.mode,a=e.onSelect,n=Object(r.useCallback)((function(){a(t)}),[t,a]);return c.a.createElement(Mt.a,{onClick:n},c.a.createElement(sn,{mode:t}),t)},un=function(e){N.start(),e()},mn=function(e){N.start(),e(2)},_n=function(e){N.changeMode(b.FOCUS),N.start(),e()},dn=function(){var e=Object(r.useContext)(ve),t=e.state,a=t.loaded,o=t.pomodoro_date,s=t.pomodoro_number,l=t.pomodoro_used_number,u=t.task_id,_=t.task,E=t.auth_token,p=t.pomodoro_live_counts,O=e.dispatch,f=Object(r.useState)(!1),y=Object(i.a)(f,2),v=y[0],k=y[1],h=Object(r.useState)(!1),j=Object(i.a)(h,2),g=j[0],C=j[1],A=Object(r.useState)(R[b.FOCUS]),D=Object(i.a)(A,2),I=D[0],M=D[1],x=Object(r.useState)(S.STOPPED),U=Object(i.a)(x,2),P=U[0],L=U[1],w=Object(r.useState)(b.FOCUS),K=Object(i.a)(w,2),F=K[0],H=K[1],B=Object(r.useState)(0),Y=Object(i.a)(B,2),G=Y[0],J=Y[1],Z=Object(r.useState)("min"),W=Object(i.a)(Z,2),Q=W[0],X=W[1],$=Object(r.useCallback)((function(){C((function(e){return!e}))}),[]),ee=Object(r.useCallback)((function(e){N.changeMode(e)}),[]),te=Object(r.useCallback)((function(){switch(P){case S.RUNNING:N.pause();break;case S.PAUSED:N.resume();break;case S.STOPPED:N.start()}}),[P]),ae=Object(r.useCallback)((function(e){var t=function(e){return e>=60?[on(e),"min"]:[Math.ceil(e),"sec"]}(e),a=Object(i.a)(t,2),n=a[0],r=a[1];M(n),X(r)}),[]),ne=Object(r.useCallback)((function(e){L(e.state),ae(e.remaining)}),[ae]),re=Object(r.useCallback)((function(e){H(e.mode),ae(e.duration)}),[ae]),ce=Object(r.useCallback)((function(e){ae(e.remaining)}),[ae]),oe=Object(r.useCallback)((function(e,t){var a=s;ne(e),e.mode===b.FOCUS?(O({type:n.ADD_POMODORO,meta:{completedAt:t||new Date,duration:e.duration,pure:0===e.checkpointElapsed}}),++a%4===0?N.changeMode(b.LONG):N.changeMode(b.SHORT)):N.changeMode(b.FOCUS);var r,c="",o=void 0,l=un,i=void 0;switch(r="".concat(a," Pomodoros today!"),N.mode){case b.FOCUS:c="Start Focusing.";break;case b.SHORT:c="Take a Short Break.",o="Retry focusing if double click.",l=mn,i=_n;break;case b.LONG:c="Take a Long Break.",o="Retry focusing if double click.",l=mn,i=_n}!function(e){var t=e.title,a=e.body,n=e.option,r=void 0===n?"":n,c=e.icon,o=e.onClick,s=e.onDblclick,l=0,i=null;if("granted"===Notification.permission){var u=new Notification(t,{body:"".concat(a," ").concat(r),icon:c}),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?i=setTimeout((function(){u.close(),i=null}),1e3*e):u.close()};u.onclick=function(){0===l?(l++,o(m)):(i&&clearTimeout(i),s&&s(m))}}else q({title:t,body:a,icon:c})}({title:c,body:r,option:o,icon:$a.a,onClick:l,onDblclick:i})}),[O,ne,s]),se=Object(r.useCallback)((function(){N.changeMode(b.FOCUS,!0)}),[]),le=Object(r.useCallback)((function(){O({type:n.RESET_TASK_ID})}),[O]),ie=Object(r.useCallback)((function(e){var t=" from firebase!",a=s,r=e.remaining;t=e.mode===b.FOCUS?++a%4===0?"Take a Long Break ".concat(t):"Take a Short Break ".concat(t):"Start Focusing ".concat(t);var c="".concat(a," Pomodoros today!");O({type:n.ADD_FB_TIMER,payload:{title:t,body:c,remaining:r}})}),[O,s]),ue=Object(r.useCallback)((function(e){O({type:n.DEL_FB_TIMER})}),[O]);Object(r.useEffect)((function(){return N.on("tick",ce),N.on("start",ne),N.on("start",ie),N.on("stop",ne),N.on("stop",ue),N.on("pause",ne),N.on("pause",ue),N.on("resume",ne),N.on("resume",ie),N.on("expire",oe),N.on("change_mode",re),function(){N.removeAllListeners()}}),[oe,re,ne,ce,ie,ue]),Object(r.useEffect)((function(){H(N.mode),L(N.state),ae(N.remaining),N.restoreExpired&&E&&(m.a.defer((function(){oe(N.status)})),N.restoreExpired=!1)}),[E,oe,ae]),Object(r.useEffect)((function(){var e=T()().format("YYYY-MM-DD");a&&o!==e&&(O({type:n.RESET_POMODORO,payload:{pomodoro_date:e}}),N.changeMode(b.FOCUS))}),[O,a,o]),Object(r.useEffect)((function(){"denied"!==Notification.permission&&Notification.requestPermission()}),[O]),Object(r.useEffect)((function(){var e=F===b.FOCUS?"#f00":"#0f0",t=F===b.FOCUS?"#fff":"#000",a="fade";if("sec"===Q){var n=[t,e];e=n[0],t=n[1],a="none"}switch(P){case S.RUNNING:cn.badge(I,{bgColor:e,textColor:t,animation:a});break;case S.PAUSED:cn.badge("-",{bgColor:e,textColor:t,animation:a});break;default:cn.reset()}}),[F,I,P,Q]),Object(r.useEffect)((function(){var e=60*R[F];J(.01+99*(e-("min"===Q?60*I:I))/e/100)}),[F,I,Q]),Object(r.useEffect)((function(){O({type:n.SET_POMODORO_STATE,payload:{pomodoro_state:P}})}),[O,P]),Object(r.useEffect)((function(){O({type:n.SET_POMODORO_MODE,payload:{pomodoro_mode:F}})}),[O,F]);var me=Object(r.useCallback)((function(){k((function(e){return!e}))}),[]),_e=P===S.RUNNING?G:1;if(!E)return null;var de=_?"#".concat(_.ref," ").concat(m.a.get(_,"user_story_extra_info.subject","Unassigned tasks")," / ").concat(_.subject):"",Ee=_?m.a.truncate("#".concat(_.ref," ").concat(_.subject),{length:10}):"",pe=Object.values(p).some((function(e){return e>0}));return c.a.createElement(he.a,{className:d()(Qa.a.top,"sticky-top")},c.a.createElement(Ja.a,{options:{primary:F===b.FOCUS?"red":"green"}},c.a.createElement(Ue.a,{buffer:_e,progress:G,closed:P===S.STOPPED})),c.a.createElement(je.a,{onClick:me},c.a.createElement("div",{className:"d-flex"},c.a.createElement(ot,{isOpen:v}),c.a.createElement(De.a,{className:d()(Qa.a.button_group,"ml-1")},c.a.createElement(Wa.a,{onClick:xe,isOpen:g,toggle:$,addonType:"prepend"},c.a.createElement(xt.a,{color:"light",size:"sm",caret:!0},c.a.createElement(sn,{mode:F})),c.a.createElement(Ut.a,null,c.a.createElement(ln,{mode:b.FOCUS,onSelect:ee}),c.a.createElement(ln,{mode:b.SHORT,onSelect:ee}),c.a.createElement(ln,{mode:b.LONG,onSelect:ee}))),c.a.createElement(Re.a,{addonType:"prepend",onClick:xe},c.a.createElement(tt.a,{className:d()(Qa.a.fix_w,{"font-weight-bold":P===S.RUNNING})},I)),c.a.createElement(Re.a,{onClick:xe,addonType:"prepend"},Q),c.a.createElement(Re.a,{addonType:"append",onClick:xe},P===S.RUNNING?c.a.createElement(Me.a,{color:"danger",onClick:te},c.a.createElement(z.a,{icon:V.x})):c.a.createElement(Me.a,{color:"primary",onClick:te},c.a.createElement(z.a,{icon:V.y}))),F!==b.FOCUS&&c.a.createElement(Re.a,{addonType:"append",onClick:xe},c.a.createElement(Me.a,{color:"light",onClick:se,title:"Retry focusing"},c.a.createElement(z.a,{icon:V.A,className:"text-muted"}),c.a.createElement(ea,{state:Zt.STALE}))),u&&c.a.createElement(Za.b,{onClick:xe,className:d()(Qa.a.chip_set)},c.a.createElement(Za.a,{icon:c.a.createElement(z.a,{icon:V.F}),onRemove:le,title:de,trailingIcon:c.a.createElement(z.a,{icon:V.G})},Ee||c.a.createElement(Ot.a,{type:"grow"}))),pe&&c.a.createElement("div",{className:"ml-1"},c.a.createElement("div",{className:d()("w-100","text-light","bg-danger","text-center","rounded","shadow","font-weight-bold",Qa.a.live)},c.a.createElement(z.a,{className:"ml-1",icon:V.I}),c.a.createElement("span",{className:"mx-1"},"LIVE")),c.a.createElement("div",null,Object.entries(p).filter((function(e){var t=Object(i.a)(e,2);t[0];return t[1]>0})).map((function(e){var t=Object(i.a)(e,2),a=t[0],n=t[1];return c.a.createElement(ge.a,{key:a,color:"light",className:"border"},c.a.createElement(sn,{mode:a}),":",n)}))))),s>0&&c.a.createElement(ge.a,{color:"danger",className:"mr-2"},c.a.createElement(ea,null)," ",c.a.createElement(z.a,{icon:V.G})," ",s),m.a.times(s).map((function(e){return c.a.createElement(ea,{key:e,state:e<l?Zt.STALE:Zt.FRESH,br:e%2!==s%2&&e<s-1})})))),c.a.createElement(Ce.a,{isOpen:v},c.a.createElement(Xe.a,{className:"bg-grass"},c.a.createElement(rn,null))))},En=function(){return c.a.createElement("div",{className:"container"},c.a.createElement(l.a,{className:"toast-top"}),c.a.createElement(lt.a,null,c.a.createElement(ke,null,c.a.createElement(dn,null),c.a.createElement(st,null),c.a.createElement(it.a,{exact:!0,path:"/",component:Ha}),c.a.createElement(it.a,{exact:!0,path:"/:uid",component:Ga}))))};s.a.render(c.a.createElement(En,null),document.getElementById("root"))},56:function(e,t,a){e.exports={top:"Pomodoro_top__2KPBC",button_group:"Pomodoro_button_group__25QhE",chip_set:"Pomodoro_chip_set__UcFix",fix_w:"Pomodoro_fix_w__26hsb",short_break_icon:"Pomodoro_short_break_icon__3e20m",long_break_icon:"Pomodoro_long_break_icon__1CgqS",live:"Pomodoro_live__293Tt"}},84:function(e,t,a){e.exports={fresh:"Tomato_fresh__2s5Ye",stale:"Tomato_stale__3bjHh",bl:"Tomato_bl__2-LRw",br:"Tomato_br__2_ZQQ"}},85:function(e,t,a){e.exports={header:"UserStory_header__3lGFX",display_medal:"UserStory_display_medal__3t53K",medal:"UserStory_medal__2Zi1f",is_closed:"UserStory_is_closed__2ABQp"}}},[[271,1,2]]]);
//# sourceMappingURL=main.3234c71e.chunk.js.map