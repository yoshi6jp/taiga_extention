(this["webpackJsonptaiga-extention"]=this["webpackJsonptaiga-extention"]||[]).push([[0],{114:function(e,t,a){e.exports={btn:"TaskTimerButton_btn__3yv2h"}},118:function(e,t,a){e.exports={gold:"Hero_gold__22tvr",silver:"Hero_silver__3VD88",bronze:"Hero_bronze__2KzSy"}},147:function(e,t,a){e.exports={gold:"UserTasks_gold__1MP40",silver:"UserTasks_silver__GpK9Y",bronze:"UserTasks_bronze__1aHZc",custom_input_td:"UserTasks_custom_input_td__1JWmj"}},221:function(e,t,a){e.exports={header:"Controller_header__33lvE"}},225:function(e,t,a){e.exports={input_group:"ToggleNumberInput_input_group__1wkB8"}},236:function(e,t,a){e.exports=a.p+"static/media/tomato.c392a271.png"},265:function(e,t,a){e.exports=a(499)},270:function(e,t,a){},280:function(e,t,a){},499:function(e,t,a){"use strict";a.r(t);var n,r=a(1),c=a.n(r),o=a(36),s=a.n(o),l=(a(270),a(271),a(272),a(273),a(274),a(275),a(276),a(277),a(278),a(279),a(280),a(55)),i=a(13),u=a(6),m=a.n(u),_=a(2),d=a.n(_),E=a(12),p=a.n(E),f=a(18),O=a(17),T=a.n(O);!function(e){e.SET_TOKEN="SET_TOKEN",e.SET_TIMER_ID="SET_TIMER_ID",e.ADD_FB_TIMER="ADD_FB_TIMER",e.DEL_FB_TIMER="DEL_FB_TIMER",e.SET_URL="SET_URL",e.SIGN_IN="SIGN_IN",e.SET_AUTH_TOKEN="SET_AUTH_TOKEN",e.SET_AUTH_ERROR="SET_AUTH_ERROR",e.SIGN_OUT="SIGN_OUT",e.FETCH_PROJECTS="FETCH_PROJECTS",e.SET_PROJECTS="SET_PROJECTS",e.SET_PID="SET_PID",e.FETCH_PROJECT="FETCH_PROJECT",e.SET_PROJECT="SET_PROJECT",e.FETCH_MILESTONES="FETCH_MILESTONES",e.SET_MID="SET_MID",e.SET_MILESTONES="SET_MILESTONES",e.SET_MILESTONE="SET_MILESTONE",e.SET_CUSTOM_EID="SET_CUSTOM_EID",e.SET_CUSTOM_RID="SET_CUSTOM_RID",e.FETCH_CUSTOM_ATTRS="FETCH_CUSTOM_ATTRS",e.SET_CUSTOM_ATTRS="SET_CUSTOM_ATTRS",e.SET_CUSTOM_ATTR_E="SET_CUSTOM_ATTR_E",e.SET_CUSTOM_ATTR_R="SET_CUSTOM_ATTR_R",e.SET_BIZ_DAYS="SET_BIZ_DAYS",e.ADD_BIZ_DAY="ADD_BIZ_DAY",e.REMOVE_BIZ_DAY="REMOVE_BIZ_DAY",e.FETCH_TASKS="FETCH_TASKS",e.SET_TASKS="SET_TASKS",e.SET_TASK_ID="SET_TASK_ID",e.RESET_TASK_ID="RESET_TASK_ID",e.SET_TASK="SET_TASK",e.SET_USER_TASKS="SET_USER_TASKS",e.PATCH_TASK="PATCH_TASK",e.FETCH_TASK_STATUSES="FETCH_TASK_STATUSES",e.SET_TASK_STATUSES="SET_TASK_STATUSES",e.SET_ACTIVE_TASK_STATUSES="SET_ACTIVE_TASK_STATUSES",e.FETCH_CUSTOM_VALUE_MAP="FETCH_CUSTOM_VALUE_MAP",e.SET_CUSTOM_VALUE_MAP="SET_CUSTOM_VALUE_MAP",e.PATCH_CUSTOM_VALUE="PATCH_CUSTOM_VALUE",e.FETCH_USER="FETCH_USER",e.SET_USER="SET_USER",e.RESET_USER="RESET_USER",e.SET_REJECT_TASK_STATUS_IDS="SET_REJECT_TASK_STATUS_IDS",e.ADD_REJECT_TASK_STATUS_ID="ADD_REJECT_TASK_STATUS_ID",e.REMOVE_REJECT_TASK_STATUS_ID="REMOVE_REJECT_TASK_STATUS_ID",e.OPEN_CONTROLLER="OPEN_CONTROLLER",e.CLOSE_CONTROLLER="CLOSE_CONTROLLER",e.UPDATE_DATA="UPDATE_DATA",e.ADD_POMODORO="ADD_POMODORO",e.USE_POMODORO="USE_POMODORO",e.RESET_POMODORO="RESET_POMODORO",e.RESTORE_POMODORO="RESTORE_POMODORO",e.CALC_POMODORO_TOTAL="CALC_POMODORO_TOTAL",e.LOAD_POMODORO_TOTALS="LOAD_POMODORO_TOTALS",e.SET_POMODORO_TOTALS="SET_POMODORO_TOTALS",e.LOADED="LOADED",e.SET_POMODORO_STATE="SET_POMODORO_STATE",e.SET_POMODORO_MODE="SET_POMODORO_MODE",e.SET_TIMELIMIT_CLOSE_TASK="SET_TIMELIMIT_CLOSE_TASK",e.SET_IN_PROGRESS_TASK_STATUS_ID="SET_IN_PROGRESS_TASK_STATUS_ID",e.SET_POMODORO_LIVE_COUNT="SET_POMODORO_LIVE_COUNT"}(n||(n={}));var S,b,v,y=a(19),k=a(102),h=a(214),g=a(110),j=a(53),C=a(154),A=a(111),D=a(103);!function(e){e.STOPPED="stopped",e.RUNNING="running",e.PAUSED="paused"}(b||(b={})),function(e){e.FOCUS="Focusing",e.SHORT="Short break",e.LONG="Long break"}(v||(v={}));var R,M=(S={},Object(y.a)(S,v.FOCUS,25),Object(y.a)(S,v.SHORT,5),Object(y.a)(S,v.LONG,15),S);!function(e){e.STATE="pomodoro_state",e.MODE="pomodoro_mode",e.CHECKPOINT_START_AT="pomodoro_checkpoint_start_at",e.CHECKPOINT_ELAPSED="pomodoro_checkpoint_elapsed"}(R||(R={}));var I,N,P=new(function(e){function t(e){var a;return Object(k.a)(this,t),(a=Object(g.a)(this,Object(j.a)(t).call(this))).state=b.STOPPED,a.mode=v.FOCUS,a.duration=60*M[v.FOCUS],a.tick=60,a.checkpointStartAt=NaN,a.checkpointElapsed=0,a.expireTimeout=null,a.tickInterval=null,a.tickOffsetTimeout=null,a.restoreExpired=!1,a.estimateCompletedAt=new Date,a.tick=e,a.restoreStorage(),a}return Object(A.a)(t,e),Object(h.a)(t,[{key:"on",value:function(e,a){return Object(C.a)(Object(j.a)(t.prototype),"on",this).call(this,e,a)}},{key:"once",value:function(e,a){return Object(C.a)(Object(j.a)(t.prototype),"once",this).call(this,e,a)}},{key:"start",value:function(){this.isStopped&&(this.setExpireTimeout(this.duration),this.setTickInterval(this.tick),this.state=b.RUNNING,this.checkpointStartAt=Date.now(),this.checkpointElapsed=0,this.emit("start",this.status),this.saveStorage())}},{key:"stop",value:function(){this.isStopped||(this.clearExpireTimeout(),this.clearTickInterval(),this.checkpointStartAt=NaN,this.checkpointElapsed=0,this.state=b.STOPPED,this.emit("stop",this.status),this.saveStorage())}},{key:"pause",value:function(){if(this.isRunning){this.clearExpireTimeout(),this.clearTickInterval();var e=(Date.now()-this.checkpointStartAt)/1e3;this.checkpointElapsed+=e,this.state=b.PAUSED,this.emit("pause",this.status),this.saveStorage()}}},{key:"resume",value:function(){this.isPaused&&(this.setExpireTimeout(this.remaining),this.setTickInterval(this.tick),this.state=b.RUNNING,this.checkpointStartAt=Date.now(),this.emit("resume",this.status),this.saveStorage())}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"changeMode",value:function(e,t){var a=this;this.stop(),this.mode=e,this.duration=60*M[e],this.emit("change_mode",this.status),this.saveStorage(),t&&m.a.defer((function(){a.start()}))}},{key:"setExpireTimeout",value:function(e){var t=this;this.expireTimeout=setTimeout((function(){t.emit("expire",t.status),t.stop()}),1e3*e)}},{key:"clearExpireTimeout",value:function(){this.expireTimeout&&clearTimeout(this.expireTimeout),this.expireTimeout=null}},{key:"setTickInterval",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,r=this.status.remaining;if(r<=n)this.setSecTickInterval();else{var c=r%e;c>1&&!a?this.tickOffsetTimeout=setTimeout((function(){t.emit("tick",t.status),t.setTickInterval(e,!0)}),1e3*c):this.tickInterval=setInterval((function(){var e=t.status;t.emit("tick",e),e.remaining<n&&(t.clearTickInterval(),t.setSecTickInterval())}),1e3*e)}}},{key:"setSecTickInterval",value:function(){var e=this;this.tickInterval=setInterval((function(){e.emit("tick",e.status)}),1e3)}},{key:"clearTickInterval",value:function(){this.tickInterval&&clearInterval(this.tickInterval),this.tickInterval=null,this.tickOffsetTimeout&&clearTimeout(this.tickOffsetTimeout),this.tickOffsetTimeout=null}},{key:"saveStorage",value:function(){localStorage.setItem(R.STATE,this.state),localStorage.setItem(R.MODE,this.mode),localStorage.setItem(R.CHECKPOINT_START_AT,Number.isNaN(this.checkpointStartAt)?"":String(this.checkpointStartAt)),localStorage.setItem(R.CHECKPOINT_ELAPSED,String(this.checkpointElapsed))}},{key:"restoreStorage",value:function(){var e,t=localStorage.getItem(R.STATE),a=localStorage.getItem(R.MODE),n=localStorage.getItem(R.CHECKPOINT_START_AT),r=localStorage.getItem(R.CHECKPOINT_ELAPSED);if(e=t,m.a.includes(m.a.values(b),e)&&function(e){return m.a.includes(m.a.values(v),e)}(a)){var c=t,o=a,s=60*M[o];switch(c){case b.STOPPED:this.changeMode(o);break;case b.PAUSED:var l=Number(r);l<1e3*s&&(this.state=c,this.mode=o,this.duration=s,this.checkpointElapsed=l);break;case b.RUNNING:var i=Number(n),u=Number(r);if(i>0)this.mode=o,this.duration=s,Date.now()-i+1e3*u<1e3*s?(this.state=b.RUNNING,this.checkpointStartAt=i,this.checkpointElapsed=u,this.setExpireTimeout(this.remaining),this.setTickInterval(this.tick)):(this.stop(),this.estimateCompletedAt=new Date(i+1e3*(s-u)),this.restoreExpired=!0)}}}},{key:"isStopped",get:function(){return this.state===b.STOPPED}},{key:"isRunning",get:function(){return this.state===b.RUNNING}},{key:"isPaused",get:function(){return this.state===b.PAUSED}},{key:"remaining",get:function(){return Math.max(this.duration-this.elapsed,0)}},{key:"elapsed",get:function(){var e=0;return this.checkpointStartAt&&this.isRunning&&(e=(Date.now()-this.checkpointStartAt)/1e3),this.checkpointElapsed+e}},{key:"status",get:function(){return{state:this.state,duration:this.duration,elapsed:this.elapsed,remaining:this.remaining,checkpointElapsed:this.checkpointElapsed,checkpointStartAt:this.checkpointStartAt,mode:this.mode}}}]),t}(D.EventEmitter))(60);!function(e){e.URL="taiga_url",e.TIMER_ID="taiga_timer_id",e.PID="taiga_pid",e.MID="taiga_mid",e.TASK_ID="taiga_task_id",e.CUSTOM_EID="taiga_custom_eid",e.CUSTOM_RID="taiga_custom_rid",e.BIZ_DAYS="taiga_biz_days",e.REJECT_TASK_STATUS_IDS="reject_task_status_ids",e.USERNAME="taiga_username",e.PASSWORD="taiga_password",e.POMODORO_DATE="taiga_pomodoro_date",e.POMODORO_NUMBER="taiga_pomodoro_number",e.POMODORO_USED_NUMBER="taiga_pomodoro_used_number",e.TIMELIMIT_CLOSE_TASK="taiga_timelimit_close_task"}(N||(N={}));var x=function(e){return localStorage.getItem(e)||""},U=function(e){return x(e)},w=function(e,t){return t?x("".concat(t,"/").concat(e)):""},L=function(e,t){localStorage.setItem(e,t)},K=function(e,t,a){return t?L("".concat(t,"/").concat(e),a):null},F={token:null,timer_id:null,url:"",auth_token:"",auth_error:!1,username:"",password:"",user:null,projects:[],pid:"",project:{},mid:"",custom_eid:"",custom_rid:"",custom_attrs:[],custom_attr_e:{},custom_attr_r:{},biz_days:[],milestones:[],milestone:{},tasks:[],task_id:"",task:null,user_tasks:[],task_statuses:[],active_task_statuses:[],custom_value_map:new WeakMap,reject_task_status_ids:[],updated_time:0,isOpen:!1,pomodoro_date:"",pomodoro_number:0,pomodoro_used_number:0,loaded:!1,pomodoro_daily_totals:[],pomodoro_state:b.STOPPED,pomodoro_mode:v.FOCUS,timelimit_close_task:"",in_progress_task_status_id:"",pomodoro_live_counts:(I={},Object(y.a)(I,v.FOCUS,0),Object(y.a)(I,v.SHORT,0),Object(y.a)(I,v.LONG,0),I)},H=a(38);function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.SET_TOKEN:var a=t.payload.token;return Y({},e,{token:a});case n.SET_TIMER_ID:var r=t.payload.timer_id;return Y({},e,{timer_id:r});case n.SET_URL:var c=t.payload.url;return Y({},e,{url:c});case n.SET_PROJECTS:var o=t.payload.projects;return Y({},e,{projects:o});case n.SET_PID:var s=t.payload.pid;return Y({},e,{pid:s,project:{},mid:"",biz_days:[],custom_attrs:[],milestones:[],custom_value_map:new WeakMap});case n.SET_PROJECT:var l=t.payload.project;return Y({},e,{project:l});case n.SET_MID:var i=t.payload.mid;return Y({},e,{mid:i,milestone:{},tasks:[]});case n.SET_MILESTONES:var u=t.payload.milestones;return Y({},e,{milestones:u});case n.SET_MILESTONE:var _=t.payload.milestone;return Y({},e,{milestone:_});case n.SET_CUSTOM_EID:var d=t.payload.custom_eid;return Y({},e,{custom_eid:d});case n.SET_CUSTOM_ATTRS:var E=t.payload.custom_attrs;return Y({},e,{custom_attrs:E});case n.SET_CUSTOM_ATTR_E:var p=t.payload.custom_attr_e;return Y({},e,{custom_attr_e:p});case n.SET_CUSTOM_ATTR_R:var f=t.payload.custom_attr_r;return Y({},e,{custom_attr_r:f});case n.SET_CUSTOM_RID:var O=t.payload.custom_rid;return Y({},e,{custom_rid:O});case n.SET_BIZ_DAYS:var T=t.payload.biz_days;return Y({},e,{biz_days:T});case n.ADD_BIZ_DAY:var S=t.payload.biz_day,b=m.a.chain([].concat(Object(H.a)(e.biz_days),[S])).uniq().sort().value();return Y({},e,{biz_days:b});case n.REMOVE_BIZ_DAY:var v=t.payload.biz_day,k=m.a.reject(Object(H.a)(e.biz_days),(function(e){return e===v}));return Y({},e,{biz_days:k});case n.SET_TASKS:var h=t.payload.tasks;return Y({},e,{tasks:h});case n.SET_TASK_ID:var g=t.payload.task_id;return Y({},e,{task_id:g,task:null});case n.RESET_TASK_ID:return Y({},e,{task_id:"",task:null});case n.SET_TASK:var j=t.payload.task;return Y({},e,{task:j});case n.SET_USER_TASKS:var C=t.payload.user_tasks;return Y({},e,{user_tasks:C});case n.SET_TASK_STATUSES:var A=t.payload.task_statuses;return Y({},e,{task_statuses:A});case n.SET_ACTIVE_TASK_STATUSES:var D=t.payload.active_task_statuses;return Y({},e,{active_task_statuses:D});case n.SET_CUSTOM_VALUE_MAP:var R=t.payload.custom_value_map;return Y({},e,{custom_value_map:R});case n.SET_USER:var M=t.payload.user;return Y({},e,{user:M});case n.RESET_USER:return Y({},e,{user:null,user_tasks:[]});case n.SET_REJECT_TASK_STATUS_IDS:var I=t.payload.reject_task_status_ids;return Y({},e,{reject_task_status_ids:I});case n.ADD_REJECT_TASK_STATUS_ID:var N=t.payload.reject_task_status_id,P=m.a.chain([].concat(Object(H.a)(e.reject_task_status_ids),[N])).compact().uniq().value();return Y({},e,{reject_task_status_ids:P});case n.REMOVE_REJECT_TASK_STATUS_ID:var x=t.payload.reject_task_status_id,U=m.a.reject(Object(H.a)(e.reject_task_status_ids),(function(e){return e===x}));return Y({},e,{reject_task_status_ids:U});case n.OPEN_CONTROLLER:return Y({},e,{isOpen:!0});case n.CLOSE_CONTROLLER:return Y({},e,{isOpen:!1});case n.UPDATE_DATA:return Y({},e,{updated_time:Date.now()});case n.SIGN_IN:var w=t.payload,L=w.username,K=w.password;return Y({},e,{username:L,password:K,auth_error:!1});case n.SET_AUTH_TOKEN:var B=t.payload.auth_token;return Y({},e,{auth_token:B});case n.SET_AUTH_ERROR:return Y({},e,{auth_error:!0});case n.SIGN_OUT:return Y({},e,{auth_token:"",username:"",password:""});case n.ADD_POMODORO:var z=e.pomodoro_number+1;return Y({},e,{pomodoro_number:z});case n.USE_POMODORO:var V=t.payload.used_number,G=Math.max(0,e.pomodoro_used_number+V);return Y({},e,{pomodoro_used_number:G});case n.RESET_POMODORO:var J=t.payload.pomodoro_date;return Y({},e,{pomodoro_number:0,pomodoro_used_number:0,pomodoro_date:J});case n.RESTORE_POMODORO:var Z=t.payload,W=Z.pomodoro_date,q=Z.pomodoro_number,Q=Z.pomodoro_used_number;return Y({},e,{pomodoro_date:W,pomodoro_number:q,pomodoro_used_number:Q});case n.SET_POMODORO_TOTALS:var X=t.payload.pomodoro_daily_totals;return Y({},e,{pomodoro_daily_totals:X});case n.LOADED:return Y({},e,{loaded:!0});case n.SET_POMODORO_STATE:var $=t.payload.pomodoro_state;return Y({},e,{pomodoro_state:$});case n.SET_POMODORO_MODE:var ee=t.payload.pomodoro_mode;return Y({},e,{pomodoro_mode:ee});case n.SET_TIMELIMIT_CLOSE_TASK:var te=t.payload.timelimit_close_task;return Y({},e,{timelimit_close_task:te});case n.SET_IN_PROGRESS_TASK_STATUS_ID:var ae=t.payload.task_status_id;return Y({},e,{in_progress_task_status_id:ae});case n.SET_POMODORO_LIVE_COUNT:var ne=t.payload,re=ne.mode,ce=ne.value;return Y({},e,{pomodoro_live_counts:Y({},e.pomodoro_live_counts,Object(y.a)({},re,ce))});default:return e}},V=function(e,t,a,n){return function(r){t(r),a(r,n,e)}},G=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c=r(),!(o=c.url)){e.next=8;break}return e.next=5,xe(o,"projects");case 5:s=e.sent,l=s.data,a({type:n.SET_PROJECTS,payload:{projects:l}});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),Le(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a,n){return e.apply(this,arguments)}}(),J=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_PROJECT){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.pid,!o||!s){e.next=10;break}return e.next=7,xe(o,"projects/".concat(s));case 7:l=e.sent,i=l.data,a({type:n.SET_PROJECT,payload:{project:i}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Le(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,a,n){return e.apply(this,arguments)}}(),Z=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_MILESTONES){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.project,!o||!s){e.next=10;break}return e.next=7,xe(o,"milestones",{params:{project:s}});case 7:l=e.sent,i=l.data,a({type:n.SET_MILESTONES,payload:{milestones:i}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Le(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,a,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i,u,_,d,E,f;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_TASKS){e.next=17;break}if(e.prev=1,c=r(),o=c.url,s=t.payload,l=s.milestone,i=s.reject_task_status_ids,u=s.timelimit_close_task,!(o&&l&&u)){e.next=12;break}return _=T()(u),e.next=8,xe(o,"tasks",{headers:{"x-disable-pagination":!0},params:{milestone:l}});case 8:d=e.sent,E=d.data,f=m.a.chain(E).reject((function(e){return m.a.includes(i,String(e.status))})).reject((function(e){return e.is_closed&&T()(e.finished_date).diff(_)<0})).value(),a({type:n.SET_TASKS,payload:{tasks:f}});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),Le(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,a,n){return e.apply(this,arguments)}}(),q=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_TASK_STATUSES){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.project,!o||!s){e.next=10;break}return e.next=7,xe(o,"task-statuses",{params:{project:s}});case 7:l=e.sent,i=l.data,a({type:n.SET_TASK_STATUSES,payload:{task_statuses:i}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Le(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,a,n){return e.apply(this,arguments)}}(),Q=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_CUSTOM_ATTRS){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.project,!o||!s){e.next=10;break}return e.next=7,xe(o,"task-custom-attributes",{params:{project:s}});case 7:l=e.sent,i=l.data,a({type:n.SET_CUSTOM_ATTRS,payload:{custom_attrs:i}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Le(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,a,n){return e.apply(this,arguments)}}(),X=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_CUSTOM_VALUE_MAP){e.next=16;break}if(e.prev=1,c=r(),o=c.url,s=c.custom_eid,l=c.custom_rid,i=t.payload.tasks,!(o&&i.length&&s&&l)){e.next=11;break}return e.t0=WeakMap,e.next=8,Promise.all(i.map(function(){var e=Object(f.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe(o,"tasks/custom-attributes-values/".concat(t.id));case 2:return a=e.sent,n=a.data,e.abrupt("return",[t,n]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:e.t1=e.sent,u=new e.t0(e.t1),a({type:n.SET_CUSTOM_VALUE_MAP,payload:{custom_value_map:u}});case 11:e.next=16;break;case 13:e.prev=13,e.t2=e.catch(1),Le(e.t2);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,a,n){return e.apply(this,arguments)}}(),$=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.FETCH_USER){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=t.payload.uid,!o||!s){e.next=10;break}return e.next=7,xe(o,"users/".concat(s));case 7:l=e.sent,i=l.data,a({type:n.SET_USER,payload:{user:i}});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Le(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,a,n){return e.apply(this,arguments)}}(),ee=a(11),te=a(10),ae=function(e){var t=e.icon,a=e.message;return c.a.createElement("div",{className:"d-flex"},c.a.createElement("h2",{className:"mr-2"},c.a.createElement(ee.a,{icon:t})),c.a.createElement("div",null,a))},ne=function(e){var t=e.title,a=e.body,n=e.icon;return c.a.createElement("div",{className:"d-flex"},c.a.createElement("img",{src:n,style:{width:"48px",height:"48px"},alt:""}),c.a.createElement("div",{className:"ml-2"},c.a.createElement("h5",null,t),c.a.createElement("p",null,a)))},re=function(e){l.b.success(c.a.createElement(ae,{icon:te.d,message:e}))},ce=function(e){l.b.error(c.a.createElement(ae,{icon:te.e,message:e}))},oe=function(e){var t=e.title,a=e.body,n=e.icon;Object(l.b)(c.a.createElement(ne,{title:t,body:a,icon:n}))};function se(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function le(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?se(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):se(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ie=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i,u,m,_,d,E,f,O,T,S;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.PATCH_CUSTOM_VALUE){e.next=20;break}if(e.prev=1,c=r(),o=c.url,s=c.custom_value_map,l=c.tasks,i=c.in_progress_task_status_id,u=t.payload,m=u.id,_=u.key,d=u.value,E=u.version,f=l.find((function(e){return e.id===m})),!(o&&m&&_&&f&&s.has(f))){e.next=15;break}if(!(O=s.get(f))){e.next=15;break}return T=O.attributes_values,e.next=11,we(o,"tasks/custom-attributes-values/".concat(m),{attributes_values:le({},T,Object(y.a)({},_,String(d))),version:E});case 11:t.meta&&t.meta.update_status&&d>0&&i&&!f.is_closed&&f.status!==Number(i)&&a({type:n.PATCH_TASK,payload:{key:"status",value:i,id:f.id}}),t.meta&&t.meta.use_pomodoro&&(S=t.meta.use_pomodoro.used_number,a({type:n.USE_POMODORO,payload:{used_number:S}})),a({type:n.UPDATE_DATA}),re("Custom value updated. [".concat(d,"]"));case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),Le(e.t0);case 20:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t,a,n){return e.apply(this,arguments)}}(),ue=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i,u,m,_,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.PATCH_TASK){e.next=15;break}if(e.prev=1,c=r(),o=c.url,s=c.tasks,l=t.payload,i=l.id,u=l.key,m=l.value,_=s.find((function(e){return e.id===i})),!(o&&i&&u&&_)){e.next=10;break}return e.next=8,we(o,"tasks/".concat(i),(d={},Object(y.a)(d,u,m),Object(y.a)(d,"version",_.version),d));case 8:a({type:n.UPDATE_DATA}),re("Task updated. [".concat(u,"=").concat(m,"]"));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Le(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,a,n){return e.apply(this,arguments)}}(),me=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i,u,_;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.SIGN_IN){e.next=20;break}if(e.prev=1,c=r(),o=c.url,s=t.payload,l=s.username,i=s.password,!(o&&l&&i)){e.next=13;break}return e.next=7,Ue(o,"auth",{username:l,password:i,type:"normal"});case 7:u=e.sent,_=u.data.auth_token,a({type:n.SET_AUTH_TOKEN,payload:{auth_token:_}}),L(N.USERNAME,l),L(N.PASSWORD,i),re("".concat(l," signed in."));case 13:e.next=20;break;case 15:e.prev=15,e.t0=e.catch(1),a({type:n.SET_AUTH_ERROR}),m.a.get(e.t0,"response.data._err_message")&&a({type:n.SIGN_OUT}),Le(e.t0);case 20:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t,a,n){return e.apply(this,arguments)}}(),_e=a(46),de=a.n(_e),Ee=function(e,t,a){m.a.defer((function(){var e=a(),t=e.pomodoro_date,n=e.pomodoro_number,r=e.pomodoro_used_number;L(N.POMODORO_DATE,t),L(N.POMODORO_NUMBER,String(n)),L(N.POMODORO_USED_NUMBER,String(r))}))},pe=new(function(e){function t(){var e;return Object(k.a)(this,t),(e=Object(g.a)(this,Object(j.a)(t).call(this,"TaigaPomodoroDatabase"))).items=void 0,e.totals=void 0,e.version(1).stores({items:"++id, completedAt, duration, pure, dateKey",totals:"++id, date, value, pureValue, &dateKey, dayOfWeek"}),e.items=e.table("items"),e.totals=e.table("totals"),e}return Object(A.a)(t,e),t}(a(215).a)),fe=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i,u,_,d,E,f,O,S,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.ADD_POMODORO||!t.meta){e.next=15;break}return c=r(),o=c.url,s=c.task_id,l=c.custom_rid,i=t.meta,u=i.completedAt,_=i.duration,d=i.pure,E=T()(u).format("YYYY-MM-DD"),e.next=6,pe.items.put({completedAt:u,duration:_,pure:d,dateKey:E});case 6:if(a({type:n.CALC_POMODORO_TOTAL,payload:{dateKey:E}}),!s||!l){e.next=15;break}return e.next=10,xe(o,"tasks/custom-attributes-values/".concat(s));case 10:f=e.sent,O=f.data,S=Number(m.a.get(O,"attributes_values.".concat(l),"0"))+.5,b=O.version,O&&b&&a({type:n.PATCH_CUSTOM_VALUE,payload:{id:Number(s),key:l,value:S,version:b},meta:{use_pomodoro:{used_number:1},update_status:!0}});case 15:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}();function Oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Te(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Oe(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Oe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Se=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i,u,_;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.CALC_POMODORO_TOTAL){e.next=14;break}return c=t.payload,e.next=4,pe.totals.get(c);case 4:return o=e.sent,e.next=7,pe.items.where(c).toArray();case 7:s=e.sent,l=s.length,i=m.a.filter(s,{pure:!0}).length,u=T()(c.dateKey,"YYYY-MM-DD").day(),_=T()(c.dateKey,"YYYY-MM-DD").toDate(),pe.totals.put(Te({},o,{},c,{date:_,value:l,pureValue:i,dayOfWeek:u})),a({type:n.LOAD_POMODORO_TOTALS});case 14:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),be=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.totals.toArray();case 2:c=e.sent,a({type:n.SET_POMODORO_TOTALS,payload:{pomodoro_daily_totals:c}});case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),ve=a(216),ye=a.n(ve),ke=a(112),he=a.n(ke);a(500),a(304);ye.a.config();var ge=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_apiKey:"AIzaSyDscSWT2haNjkDvdx29dz1mIxX0LX3PLJM",REACT_APP_authDomain:"taiga-ext.firebaseapp.com",REACT_APP_databaseURL:"https://taiga-ext.firebaseio.com",REACT_APP_projectId:"taiga-ext",REACT_APP_storageBucket:"taiga-ext.appspot.com",REACT_APP_messagingSenderId:"670370401412",REACT_APP_appId:"1:670370401412:web:c1a69635a444ff4f",REACT_APP_VapidKey:"BOOlMIIx0P4qjkh4KEwpEunUeeuVvaYelqqcsUGnimb7LBc6GyDECYhUwe7vCdJEDDiNExg-annFh4kXrqiIank"}),je=ge.REACT_APP_apiKey,Ce=ge.REACT_APP_VapidKey,Ae={apiKey:je,authDomain:ge.REACT_APP_authDomain,databaseURL:ge.REACT_APP_databaseURL,projectId:ge.REACT_APP_projectId,storageBucket:ge.REACT_APP_storageBucket,messagingSenderId:ge.REACT_APP_messagingSenderId,appId:ge.REACT_APP_appId};he.a.initializeApp(Ae);var De=null;try{De=he.a.messaging()}catch(Bn){console.log(Bn)}var Re=De;navigator.serviceWorker&&Re&&navigator.serviceWorker.register("./firebase-messaging-sw.js").then((function(e){m.a.get(Re,"registrationToUse")||Re.useServiceWorker(e),Re.usePublicVapidKey(Ce||""),Re.onTokenRefresh(Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re.getToken();case 2:e.sent;case 3:case"end":return e.stop()}}),e)})))),Re.getToken().then((function(e){e}))}));var Me=he.a.firestore().collection("timers");Re&&Re.requestPermission().then((function(){console.log("Notification permission granted.")})).catch((function(e){console.log("Unable to get permission to notify.",e)}));var Ie=function(){var e=Object(f.a)(p.a.mark((function e(t,a,n,r,c){var o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Me.add({title:t,body:a,remaining:n,token:r,icon:"./tomato.png",click_action:window.location.href,mode:c});case 2:return o=e.sent,s=o.id,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)})));return function(t,a,n,r,c){return e.apply(this,arguments)}}(),Ne=function(){var e=Object(f.a)(p.a.mark((function e(t,a,r){var c,o,s,l,i,u,m,_;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type!==n.ADD_FB_TIMER){e.next=7;break}return c=r(),o=c.token,s=c.pomodoro_mode,l=t.payload,i=l.title,u=l.body,m=l.remaining,e.next=5,Ie(i,u,m,o,s);case 5:_=e.sent,a({type:n.SET_TIMER_ID,payload:{timer_id:_}});case 7:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Pe=function(e,t,a){if(e.type===n.DEL_FB_TIMER){var r=a().timer_id;r&&(c=r,Me.doc(c).delete(),t({type:n.SET_TIMER_ID,payload:{timer_id:null}}))}var c},xe=function(e,t,a){return de.a.get("".concat(He(e),"/").concat(t),a)},Ue=function(e,t,a,n){return de.a.post("".concat(He(e),"/").concat(t),a,n)},we=function(e,t,a,n){return de.a.patch("".concat(He(e),"/").concat(t),a,n)},Le=function(e){var t;try{t=e.response?e.response.data._error_message:"error"}catch(Bn){t=Bn.message||Bn}ce(t)},Ke=function(e,t,a){switch(e.type){case n.FETCH_PROJECTS:return void G(e,t,a);case n.FETCH_PROJECT:return void J(e,t,a);case n.FETCH_MILESTONES:return void Z(e,t,a);case n.FETCH_TASKS:return void W(e,t,a);case n.FETCH_TASK_STATUSES:return void q(e,t,a);case n.FETCH_CUSTOM_ATTRS:return void Q(e,t,a);case n.FETCH_CUSTOM_VALUE_MAP:return void X(e,t,a);case n.FETCH_USER:return void $(e,t,a);case n.PATCH_CUSTOM_VALUE:return void ie(e,t,a);case n.SIGN_IN:return void me(e,t,a);case n.PATCH_TASK:return void ue(e,t,a);case n.SIGN_OUT:return localStorage.removeItem(N.USERNAME),localStorage.removeItem(N.PASSWORD),void(de.a.defaults.headers.common.Authorization&&delete de.a.defaults.headers.common.Authorization);case n.SET_AUTH_TOKEN:return void function(e,t,a){if(e.type===n.SET_AUTH_TOKEN){var r=e.payload.auth_token;de.a.defaults.headers.common.Authorization="Bearer ".concat(r)}}(e);case n.SET_URL:return void function(e,t,a){if(e.type===n.SET_URL){var r=e.payload.url;L(N.URL,r)}}(e);case n.SET_PID:!function(e,t,a){if(e.type===n.SET_PID){var r=e.payload.pid;L(N.PID,r),localStorage.removeItem(N.MID);var c=w(N.CUSTOM_EID,r),o=w(N.CUSTOM_RID,r);t({type:n.SET_CUSTOM_EID,payload:{custom_eid:c}}),t({type:n.SET_CUSTOM_RID,payload:{custom_rid:o}})}}(e,t);break;case n.SET_MID:!function(e,t,a){if(e.type===n.SET_MID){var r=e.payload.mid,c=a().mid;L(N.MID,r);var o=m.a.compact(w(N.BIZ_DAYS,r).split(",")).sort();t({type:n.SET_BIZ_DAYS,payload:{biz_days:o}}),c&&r!==c&&t({type:n.RESET_TASK_ID});var s=w(N.TIMELIMIT_CLOSE_TASK,r);t({type:n.SET_TIMELIMIT_CLOSE_TASK,payload:{timelimit_close_task:s}})}}(e,t,a);break;case n.SET_CUSTOM_EID:!function(e,t,a){if(e.type===n.SET_CUSTOM_EID){var r=e.payload.custom_eid,c=U(N.PID);K(N.CUSTOM_EID,c,r)}}(e);break;case n.SET_CUSTOM_RID:!function(e,t,a){if(e.type===n.SET_CUSTOM_RID){var r=e.payload.custom_rid,c=U(N.PID);K(N.CUSTOM_RID,c,r)}}(e);break;case n.SET_BIZ_DAYS:case n.ADD_BIZ_DAY:case n.REMOVE_BIZ_DAY:!function(e,t,a){m.a.defer((function(){var e=a(),t=e.mid,n=e.biz_days;K(N.BIZ_DAYS,t,n.join(","))}))}(0,0,a);break;case n.ADD_REJECT_TASK_STATUS_ID:case n.REMOVE_REJECT_TASK_STATUS_ID:!function(e,t,a){m.a.defer((function(){var e=a(),t=e.pid,n=e.reject_task_status_ids;K(N.REJECT_TASK_STATUS_IDS,t,n.join(","))}))}(0,0,a);break;case n.ADD_POMODORO:fe(e,t,a),Ee(0,0,a);break;case n.USE_POMODORO:case n.RESET_POMODORO:Ee(0,0,a);break;case n.CALC_POMODORO_TOTAL:Se(e,t,a);break;case n.LOAD_POMODORO_TOTALS:be(e,t,a);break;case n.SET_TASK_ID:case n.RESET_TASK_ID:!function(e,t,a){m.a.defer((function(){var e=a().task_id;e?L(N.TASK_ID,e):localStorage.removeItem(N.TASK_ID)}))}(0,0,a);break;case n.SET_TIMELIMIT_CLOSE_TASK:!function(e,t,a){if(e.type===n.SET_TIMELIMIT_CLOSE_TASK){var r=e.payload.timelimit_close_task,c=!!e.meta&&e.meta.customize,o=a().mid;r&&c&&K(N.TIMELIMIT_CLOSE_TASK,o,r)}}(e,0,a);break;case n.ADD_FB_TIMER:Ne(e,t,a);break;case n.DEL_FB_TIMER:Pe(e,t,a);break;case n.SET_TIMER_ID:!function(e,t,a){if(e.type===n.SET_TIMER_ID){var r=e.payload.timer_id;r?L(N.TIMER_ID,r):localStorage.removeItem(N.TIMER_ID)}}(e)}},Fe=function(e){!function(e){var t=U(N.URL),a=U(N.TIMER_ID),r=U(N.PID),c=U(N.MID),o=w(N.CUSTOM_EID,r),s=w(N.CUSTOM_RID,r),l=m.a.compact(w(N.BIZ_DAYS,c).split(",")).sort(),i=m.a.compact(w(N.REJECT_TASK_STATUS_IDS,r).split(",")),u=!(t&&r&&c&&o&&s),_=U(N.POMODORO_DATE),d=Number(U(N.POMODORO_NUMBER)||"0"),E=Number(U(N.POMODORO_USED_NUMBER)||"0"),p=U(N.TASK_ID);a&&e({type:n.SET_TIMER_ID,payload:{timer_id:a}}),t&&e({type:n.SET_URL,payload:{url:t}}),r&&e({type:n.SET_PID,payload:{pid:r}}),c&&e({type:n.SET_MID,payload:{mid:c}}),o&&e({type:n.SET_CUSTOM_EID,payload:{custom_eid:o}}),s&&e({type:n.SET_CUSTOM_RID,payload:{custom_rid:s}}),l.length&&e({type:n.SET_BIZ_DAYS,payload:{biz_days:l}}),i.length&&e({type:n.SET_REJECT_TASK_STATUS_IDS,payload:{reject_task_status_ids:i}}),p&&e({type:n.SET_TASK_ID,payload:{task_id:p}}),u&&e({type:n.OPEN_CONTROLLER}),_&&e({type:n.RESTORE_POMODORO,payload:{pomodoro_date:_,pomodoro_number:d,pomodoro_used_number:E}}),e({type:n.LOADED}),e({type:n.LOAD_POMODORO_TOTALS})}(e),m.a.defer((function(){!function(e){var t=U(N.USERNAME),a=U(N.PASSWORD);e({type:n.SIGN_IN,payload:{username:t,password:a}})}(e)}))},He=function(e){return"".concat(e.replace(/[\xa5/]$/,""),"/api/v1")},Be=function(e,t){return m.a.find(e,{id:t})},Ye=Object(r.createContext)({state:F,dispatch:function(e){}}),ze=function(e){var t=e.children,a=function(e,t){var a=Object(i.a)(e,2),n=a[0],c=a[1],o=null,s=Object(r.useCallback)((function(e){o&&o(e)}),[o]),l=Object(r.useMemo)((function(){return function(){var e;return{getter:function(){return e},setter:function(t){e=t}}}()}),[]);return l.setter(n),[n,o=Object(r.useCallback)(V(l.getter,c,t,s),[])]}(Object(r.useReducer)(z,F),Ke),o=Object(i.a)(a,2),s=o[0],l=o[1],u={state:s,dispatch:l};return Object(r.useEffect)((function(){s.url&&l({type:n.FETCH_PROJECTS})}),[l,s.url]),Object(r.useEffect)((function(){s.url&&s.pid&&(l({type:n.FETCH_MILESTONES,payload:{project:s.pid}}),l({type:n.FETCH_CUSTOM_ATTRS,payload:{project:s.pid}}),l({type:n.FETCH_TASK_STATUSES,payload:{project:s.pid}}),l({type:n.FETCH_PROJECT,payload:{pid:s.pid}}))}),[s.url,s.pid,l]),Object(r.useEffect)((function(){s.url&&s.mid&&s.milestone.id&&s.timelimit_close_task&&l({type:n.FETCH_TASKS,payload:{milestone:s.mid,reject_task_status_ids:s.reject_task_status_ids,timelimit_close_task:s.timelimit_close_task}})}),[s.url,s.mid,s.updated_time,s.reject_task_status_ids,l,s.milestone.id,s.timelimit_close_task]),Object(r.useEffect)((function(){l({type:n.FETCH_CUSTOM_VALUE_MAP,payload:{tasks:s.tasks}})}),[l,s.tasks,s.custom_eid,s.custom_rid]),Object(r.useEffect)((function(){var e=m.a.chain(s.task_statuses).reject((function(e){return m.a.includes(s.reject_task_status_ids,String(e.id))})).orderBy((function(e){return e.order})).value();l({type:n.SET_ACTIVE_TASK_STATUSES,payload:{active_task_statuses:e}})}),[s.task_statuses,s.reject_task_status_ids,l]),Object(r.useEffect)((function(){var e=Be(s.custom_attrs,Number(s.custom_eid));e&&l({type:n.SET_CUSTOM_ATTR_E,payload:{custom_attr_e:e}})}),[l,s.custom_attrs,s.custom_eid]),Object(r.useEffect)((function(){var e=Be(s.custom_attrs,Number(s.custom_rid));e&&l({type:n.SET_CUSTOM_ATTR_R,payload:{custom_attr_r:e}})}),[l,s.custom_attrs,s.custom_rid]),Object(r.useEffect)((function(){var e,t,a=(e=s.milestones,t=s.mid,e.find((function(e){return String(e.id)===t})));a&&l({type:n.SET_MILESTONE,payload:{milestone:a}})}),[l,s.mid,s.milestones]),Object(r.useEffect)((function(){if(s.tasks.length>0&&s.user){var e=(t=s.tasks,a=s.user.id,m.a.chain(t).filter({assigned_to:a}).sortBy("user_story").value());l({type:n.SET_USER_TASKS,payload:{user_tasks:e}})}var t,a}),[l,s.tasks,s.user]),Object(r.useEffect)((function(){Fe(l)}),[l]),Object(r.useEffect)((function(){if(s.task_id){var e=s.tasks.find((function(e){return e.id===Number(s.task_id)}));e&&l({type:n.SET_TASK,payload:{task:e}})}}),[l,s.task_id,s.tasks]),Object(r.useEffect)((function(){var e=s.biz_days[0];if(e&&!s.timelimit_close_task){var t="".concat(T()(e).local().startOf("day").format("YYYY-MM-DD"),"T12:00");l({type:n.SET_TIMELIMIT_CLOSE_TASK,payload:{timelimit_close_task:t}})}}),[l,s.biz_days,s.milestone,s.timelimit_close_task]),Object(r.useEffect)((function(){if(s.task_statuses.length>0){var e=s.task_statuses.find((function(e){return"in-progress"===e.slug}));e&&l({type:n.SET_IN_PROGRESS_TASK_STATUS_ID,payload:{task_status_id:String(e.id)}})}}),[l,s.task_statuses,s.task_statuses.length]),Object(r.useEffect)((function(){Re&&(Re.onTokenRefresh(Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Re){e.next=5;break}return e.next=3,Re.getToken();case 3:t=e.sent,l({type:n.SET_TOKEN,payload:{token:t}});case 5:case"end":return e.stop()}}),e)})))),Re.getToken().then((function(e){l({type:n.SET_TOKEN,payload:{token:e}})})))}),[l]),Object(r.useEffect)((function(){Object.values(v).forEach((function(e){Me.where("mode","==",e).onSnapshot((function(t){l({type:n.SET_POMODORO_LIVE_COUNT,payload:{mode:e,value:t.size}})}))}))}),[l]),c.a.createElement(Ye.Provider,{value:u},t)},Ve=a(512),Ge=a(513),Je=a(516),Ze=a(517),We=a(515),qe=a(506),Qe=a(507),Xe=a(508),$e=a(220),et=function(e){e.preventDefault()},tt=function(e){e.stopPropagation()},at=a(109),nt=function(){return c.a.createElement(at.a,{progress:0,buffer:0,className:"my-auto mx-2 border-0 form-control"})},rt=function(){var e=Object(r.useContext)(Ye),t=e.state,a=t.pid,o=t.projects,s=e.dispatch,l=Object(r.useCallback)((function(e){var t=e.target.value;t&&s({type:n.SET_PID,payload:{pid:t}})}),[s]);return c.a.createElement(qe.a,{className:"col"},c.a.createElement(Qe.a,{addonType:"prepend"},"Project"),m.a.isEmpty(o)?c.a.createElement(nt,null):c.a.createElement(Xe.a,{value:a,type:"select",onChange:l},c.a.createElement("option",{value:""}," --- "),o.map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)}))))},ct=function(){var e=Object(r.useContext)(Ye),t=e.state,a=t.milestones,o=t.mid,s=e.dispatch,l=Object(r.useCallback)((function(e){var t=e.target.value;t&&s({type:n.SET_MID,payload:{mid:t}})}),[s]);return c.a.createElement(qe.a,{className:"col"},c.a.createElement(Qe.a,{addonType:"prepend"},"Sprint"),m.a.isEmpty(a)?c.a.createElement(nt,null):c.a.createElement(Xe.a,{type:"select",value:o,onChange:l},c.a.createElement("option",{value:""}," --- "),a.map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)}))))},ot=function(){var e=Object(r.useContext)(Ye),t=e.state,a=t.custom_attrs,o=t.custom_eid,s=t.custom_rid,l=e.dispatch,i=Object(r.useCallback)((function(e){var t=e.target.value;if(t)switch(e.target.name){case"eid":l({type:n.SET_CUSTOM_EID,payload:{custom_eid:t}});break;case"rid":l({type:n.SET_CUSTOM_RID,payload:{custom_rid:t}})}}),[l]);return c.a.createElement("div",{className:"row"},c.a.createElement(qe.a,{className:"col"},c.a.createElement(Qe.a,{addonType:"prepend"},"Estimate"),m.a.isEmpty(a)?c.a.createElement(nt,null):c.a.createElement(Xe.a,{value:o,name:"eid",type:"select",onChange:i},c.a.createElement("option",{value:""}," --- "),a.map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)})))),c.a.createElement(qe.a,{className:"col"},c.a.createElement(Qe.a,{addonType:"prepend"},"Result"),m.a.isEmpty(a)?c.a.createElement(nt,null):c.a.createElement(Xe.a,{value:s,name:"rid",type:"select",onChange:i},c.a.createElement("option",null," --- "),a.map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)})))))},st=a(509),lt=a(510),it=a(536),ut=a(511),mt=a(113),_t=a.n(mt),dt=function(e,t){return-1===t?"":0===t?"Planning":"Day ".concat(t)},Et=function(e){return e.filter((function(e){return _t.a.isWeekDay(e)})).map((function(e){return e.format("YYYY-MM-DD")}))},pt=function(e){return{"text-danger":0===e,"text-info":6===e}},ft=function(e){var t=e.item,a=e.idx,o=Object(r.useContext)(Ye),s=o.state.biz_days,l=o.dispatch,i=Object(r.useCallback)((function(e){var t=e.target.value;e.target.checked?l({type:n.ADD_BIZ_DAY,payload:{biz_day:t}}):l({type:n.REMOVE_BIZ_DAY,payload:{biz_day:t}})}),[l]);if(!t)return c.a.createElement("td",null,c.a.createElement("br",null));var u=t.format("YYYY-MM-DD"),_=u===s[0],E="biz-day-".concat(u),p=m.a.includes(s,u);return c.a.createElement(c.a.Fragment,null,c.a.createElement("td",{className:d()(pt(a),{"table-info":_}),id:E},_t.a.isWeekDay(t)?c.a.createElement(st.a,{check:!0,inline:!0},c.a.createElement(lt.a,{check:!0},c.a.createElement(Xe.a,{onChange:i,disabled:_t.a.isWeekendDay(t),value:u,type:"checkbox",checked:p,className:"form-check-input"}),u)):c.a.createElement("span",null,u)),p?c.a.createElement(it.a,{target:E},function(e,t){var a=t.indexOf(e);return dt(0,a)}(u,s)):null)},Ot=function(){var e=Object(r.useContext)(Ye),t=e.state,a=t.biz_days,o=t.milestone,s=e.dispatch,l=Object(r.useState)([]),u=Object(i.a)(l,2),_=u[0],E=u[1],p=Object(r.useState)([]),f=Object(i.a)(p,2),O=f[0],S=f[1];return Object(r.useEffect)((function(){if(o){var e=function(e){var t=T()(e.estimated_start).local(),a=T()(e.estimated_finish).local().diff(t,"days");return m.a.times(a).map((function(e){return t.clone().add(e,"days")}))}(o);E(e),a.length<=1&&s({type:n.SET_BIZ_DAYS,payload:{biz_days:Et(e)}})}}),[o,a,s]),Object(r.useEffect)((function(){if(_.length>0){var e=m.a.chunk([].concat(Object(H.a)(m.a.times(_[0].day(),(function(){return null}))),Object(H.a)(_)),7);S(e)}}),[_]),c.a.createElement(ut.a,{bordered:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,T.a.weekdays().map((function(e,t){return c.a.createElement("th",{key:t,className:d()("text-center",pt(t))},e)})))),c.a.createElement("tbody",null,O.map((function(e,t){return c.a.createElement("tr",{key:t},e.map((function(e,t){return c.a.createElement(ft,{idx:t,key:t,item:e})})))}))))},Tt=function(){var e=Object(r.useContext)(Ye).state.milestone;return c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,null,"Business Days"),m.a.isEmpty(e)?c.a.createElement(qe.a,null,c.a.createElement(nt,null)):c.a.createElement(Ot,null))},St=a(514),bt=function(e){var t=e.item,a=Object(r.useContext)(Ye),o=a.state.reject_task_status_ids,s=a.dispatch,l=Object(r.useCallback)((function(e){var t=e.target.value;e.target.checked?s({type:n.REMOVE_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}}):s({type:n.ADD_REJECT_TASK_STATUS_ID,payload:{reject_task_status_id:t}})}),[s]);return c.a.createElement(st.a,{check:!0,inline:!0},c.a.createElement(lt.a,{check:!0},c.a.createElement(Xe.a,{onChange:l,type:"checkbox",value:t.id,defaultChecked:!m.a.includes(o,String(t.id))}),t.name))},vt=function(){var e=Object(r.useContext)(Ye).state.task_statuses;return 0===e.length?null:c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,null,"Task status"),c.a.createElement(St.a,null,e.map((function(e){return c.a.createElement(bt,{key:e.id,item:e})}))))},yt=a(218),kt=function(){return c.a.createElement(Qe.a,{addonType:"append"},c.a.createElement(yt.a,null,c.a.createElement(ee.a,{icon:te.G,className:"fa-pulse"})))},ht=function(){var e=Object(r.useContext)(Ye),t=e.state.timelimit_close_task,a=e.dispatch,o=Object(r.useState)(""),s=Object(i.a)(o,2),l=s[0],u=s[1],_=Object(r.useState)(!1),d=Object(i.a)(_,2),E=d[0],p=d[1],f=Object(r.useCallback)((function(e){u(e.target.value)}),[]),O=Object(r.useCallback)((function(e){l&&a({type:n.SET_TIMELIMIT_CLOSE_TASK,payload:{timelimit_close_task:l},meta:{customize:!0}}),e.preventDefault()}),[l,a]);return Object(r.useEffect)((function(){t&&(p(!0),m.a.defer(p,!1))}),[t]),c.a.createElement(We.a,{onSubmit:O},c.a.createElement(qe.a,null,c.a.createElement(Qe.a,{addonType:"prepend"},"Timelimit for closing old tasks"),E?c.a.createElement(kt,null):c.a.createElement(Xe.a,{defaultValue:t,onChange:f,type:"datetime-local"}),c.a.createElement(Qe.a,{addonType:"append"},c.a.createElement($e.a,null,"Set"))))},gt=a(221),jt=a.n(gt),Ct=function(e){var t=e.isOpen?90:void 0;return c.a.createElement(ee.a,{className:"text-muted mr-2",rotation:t,icon:te.f})},At=function(){var e=Object(r.useContext)(Ye),t=e.state,a=t.url,o=t.isOpen,s=t.biz_days,l=t.milestone,u=e.dispatch,_=Object(r.useState)(""),E=Object(i.a)(_,2),p=E[0],f=E[1],O=Object(r.useCallback)((function(e){f(e.target.value)}),[f]),T=Object(r.useCallback)((function(e){p&&u({type:n.SET_URL,payload:{url:p}}),e.preventDefault()}),[p,u]),S=Object(r.useCallback)((function(){u(o?{type:n.CLOSE_CONTROLLER}:{type:n.OPEN_CONTROLLER})}),[u,o]),b=Object(r.useMemo)((function(){return function(e,t){return e&&t.project_extra_info?"".concat(e,"/project/").concat(t.project_extra_info.slug,"/taskboard/").concat(t.slug):""}(a,l)}),[l,a]),v=l.name,y=Object(r.useMemo)((function(){return function(e){return e.length>1?"[".concat(m.a.head(e)," - ").concat(m.a.last(e),"]"):""}(s)}),[s]);return c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,{className:d()(jt.a.header),onClick:S},c.a.createElement(Ct,{isOpen:o}),v&&c.a.createElement(Je.a,{color:"primary",pill:!0,className:"p-1 m-1"},c.a.createElement("span",null,v)),y&&c.a.createElement(Je.a,{className:"p-1 m-1"},c.a.createElement("span",null,y)),b?c.a.createElement("a",{target:"_blank",onClick:tt,className:"float-right",href:b,rel:"noopener noreferrer"},c.a.createElement(ee.a,{className:"mr-1",icon:te.q}),"Taskboard"):null),c.a.createElement(Ze.a,{isOpen:o},c.a.createElement(We.a,{onSubmit:T},c.a.createElement(qe.a,null,c.a.createElement(Qe.a,{addonType:"prepend"},"URL"),c.a.createElement(Xe.a,{defaultValue:a,onChange:O,placeholder:"http://hostname:port"}),c.a.createElement(Qe.a,{addonType:"append"},c.a.createElement($e.a,null,"Set")))),c.a.createElement("div",{className:"row"},c.a.createElement(rt,null),c.a.createElement(ct,null)),c.a.createElement(ot,null),c.a.createElement(ht,null),c.a.createElement(Tt,null),c.a.createElement(vt,null)))},Dt=a(68),Rt=a(54),Mt=a(222),It=a(519),Nt=a(520),Pt=function(){var e=Object(r.useContext)(Ye).dispatch,t=Object(r.useCallback)((function(){e({type:n.UPDATE_DATA})}),[e]);return c.a.createElement($e.a,{onClick:t},c.a.createElement(ee.a,{icon:te.H}))},xt=a(147),Ut=a.n(xt),wt=a(518),Lt=function(){var e=Object(r.useContext)(Ye),t=e.state,a=t.auth_token,o=t.auth_error,s=t.username,l=e.dispatch,u=Object(r.useState)(""),m=Object(i.a)(u,2),_=m[0],d=m[1],E=Object(r.useState)(""),p=Object(i.a)(E,2),f=p[0],O=p[1],T=Object(r.useState)(!1),S=Object(i.a)(T,2),b=S[0],v=S[1],y=Object(r.useCallback)((function(e){_&&f&&(v(!0),l({type:n.SIGN_IN,payload:{username:_,password:f}})),e.preventDefault()}),[f,_,l,v]),k=Object(r.useCallback)((function(e){d(e.target.value)}),[d]),h=Object(r.useCallback)((function(e){O(e.target.value)}),[O]),g=Object(r.useCallback)((function(){l({type:n.SIGN_OUT})}),[l]);return Object(r.useEffect)((function(){(o||a)&&v(!1)}),[o,a,v]),c.a.createElement(c.a.Fragment,null,a?c.a.createElement(We.a,{inline:!0,onSubmit:et,className:"mr-1"},c.a.createElement(qe.a,null,c.a.createElement(Qe.a,{addonType:"prepend"},c.a.createElement(yt.a,null,c.a.createElement(ee.a,{icon:te.K}))),c.a.createElement(Qe.a,{addonType:"prepend",className:"border border-success"},c.a.createElement(yt.a,null,s)),c.a.createElement(Qe.a,{addonType:"append"},c.a.createElement($e.a,{title:"Sign out",onClick:g,color:"danger"},c.a.createElement(ee.a,{icon:te.F}))))):c.a.createElement(We.a,{inline:!0,onSubmit:y,className:"mr-1"},c.a.createElement(qe.a,null,c.a.createElement(Qe.a,{addonType:"prepend"},c.a.createElement(yt.a,null,c.a.createElement(ee.a,{icon:te.K}))),c.a.createElement(Xe.a,{disabled:b,onInput:k,onChange:k,name:"username",placeholder:"username",invalid:o})),c.a.createElement(qe.a,null,c.a.createElement(Qe.a,{addonType:"prepend"},c.a.createElement(yt.a,null,c.a.createElement(ee.a,{icon:te.w}))),c.a.createElement(Xe.a,{disabled:b,onInput:h,onChange:h,name:"password",placeholder:"password",type:"password",invalid:o})),c.a.createElement($e.a,{color:"info"},b?c.a.createElement(wt.a,{size:"sm",type:"grow"}):c.a.createElement(ee.a,{icon:te.E}))))};function Kt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Ft=["success","warning","info","danger"],Ht=function(e){return m.a.groupBy(e,"assigned_to")},Bt=function(e){var t=e.src||"http://i.pravatar.cc/80?u=".concat(Math.random());return c.a.createElement(Mt.a,Object.assign({},e,{src:t,square:!0,className:"mr-1"}))},Yt=function(e,t,a){return e.has(t)?(n=m.a.get(e.get(t),"attributes_values.".concat(a),"0"),m.a.chain(n).replace(/[^0-9.+,]/g,"").replace(/[+]/g,",").split(",").compact().map(Number).sum().value()):0;var n},zt=function(e,t,a){return m.a.chain(t).map((function(t){return Yt(e,t,a)})).sum().value()},Vt=function(e,t,a){return zt(e,t.filter((function(e){return e.is_closed})),a)},Gt=function(e,t){return e.has(t)?m.a.get(e.get(t),"version"):void 0},Jt=function(e,t,a){return a&&t===e},Zt=function(e,t){return t>e},Wt=function(e){var t=e.username,a=e.val,n=e.total,o=e.imgSrc,s=Object(r.useMemo)((function(){var e=n>0?(a-n)/n:0;return e<-.1?[te.s,""]:e<=.1?[te.s,"table-success"]:e<=.2?[te.t,"table-warning"]:[te.j,"table-danger"]}),[n,a]),l=Object(i.a)(s,2),u=l[0],m=l[1];return a?c.a.createElement(c.a.Fragment,null,c.a.createElement("td",{className:m},c.a.createElement(Bt,{src:o})," ",t,c.a.createElement(ee.a,{className:"mx-1",icon:u})),c.a.createElement("td",{className:d()(m,"text-right")},a)):c.a.createElement(c.a.Fragment,null,c.a.createElement("td",null,c.a.createElement(Bt,{src:o})," ",t),c.a.createElement("td",null))},qt=function(e){var t=e.e,a=e.r,n=Object(r.useMemo)((function(){return function(e,t){if(m.a.isNumber(e)&&m.a.isNumber(t)&&e>0){var a=Math.abs(e-t)/e;if(a<=.05)return["gold",3];if(a<=.1)return["silver",2];if(a<.2)return["bronze",1]}return[null,0]}(t,a)}),[t,a]),o=Object(i.a)(n,2),s=o[0],l=o[1];return s?c.a.createElement(c.a.Fragment,null,m.a.times(l).map((function(e){return c.a.createElement(ee.a,{key:e,className:Ut.a[s],icon:te.y})}))):null},Qt=function(e){var t=e.tasks,a=Object(r.useContext)(Ye).state,n=a.active_task_statuses,o=a.custom_eid,s=a.custom_value_map,l=Number(o),i=Object(r.useMemo)((function(){return m.a.chain(n).filter({is_closed:!0}).reverse().map((function(e,a){return{status:e.id,total:zt(s,m.a.filter(t,{status:e.id}),l),style:Ft[a],label:e.name}})).value()}),[n,s,l,t]),u=Object(r.useMemo)((function(){return zt(s,t,l)}),[s,l,t]);return c.a.createElement(It.a,{multi:!0},i.map((function(e){return c.a.createElement(It.a,{key:e.label,bar:!0,max:u,value:e.total,color:e.style},e.label)})))},Xt=function(e){var t=e.item,a=e.sums,n=e.isPast,o=e.total,s=e.hpd,l=e.tasks,u=Object(r.useState)(0),_=Object(i.a)(u,2),d=_[0],E=_[1],p=Object(r.useCallback)((function(e){E(Number(e.target.value)||0)}),[E]),f=m.a.get(a,t.id),O=m.a.get(f,"e"),T=m.a.get(f,"r"),S=d||o,b=String(S);return c.a.createElement("tr",{key:t.id},o>0?c.a.createElement(c.a.Fragment,null,c.a.createElement(Wt,{username:t.username,val:O,total:S,imgSrc:t.photo}),c.a.createElement("td",{className:"text-right"},o),c.a.createElement("td",{className:Ut.a.custom_input_td},c.a.createElement(Xe.a,{bsSize:"sm",type:"number",className:"text-right",value:b,step:s,onChange:p}))):c.a.createElement(c.a.Fragment,null,c.a.createElement("td",null,c.a.createElement(Bt,{src:t.photo}),c.a.createElement(Dt.b,{to:"/".concat(t.id)},t.username)),c.a.createElement("td",{className:"text-right"},t.burn_down||""),c.a.createElement("td",{className:"text-right"},O),c.a.createElement("td",{className:"text-right"},T),c.a.createElement("td",null,m.a.isNumber(O)&&c.a.createElement(Qt,{tasks:l}))),n?c.a.createElement("td",null,c.a.createElement(qt,{e:O,r:T})):null)},$t=function(e,t,a,n){var r=Number(a),c=Number(n);return m.a.mapValues(Ht(e),(function(e){return m.a.chain(e).map((function(e){return{e:Yt(t,e,r),r:Yt(t,e,c)}})).reduce((function(e,t){return{e:e.e+t.e,r:e.r+t.r}}),{e:0,r:0}).value()}))},ea=function(){var e=Object(r.useContext)(Ye).state,t=e.tasks,a=e.custom_value_map,n=e.custom_eid,o=e.custom_rid,s=e.biz_days,l=e.custom_attr_e,u=e.custom_attr_r,_=e.project.members,d=Object(r.useState)(0),E=Object(i.a)(d,2),p=E[0],f=E[1],O=s.length-1,S=Object(r.useCallback)((function(e){f(Number(e.target.value)||0)}),[f]),b=p*O,v=Object(r.useMemo)((function(){return $t(t,a,n,o)}),[n,o,a,t]),k=m.a.get(v,"null.e",0),h=b>0,g=Object(r.useMemo)((function(){return!h&&T()().diff(T()(m.a.last(s)).local().endOf("days"))>0}),[s,h]),j=Object(r.useMemo)((function(){return Ht(t)}),[t]),C=Object(r.useMemo)((function(){return m.a.chain(_).map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Kt(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Kt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{burn_down:Vt(a,j[e.id]||[],Number(n))})})).sortBy("burn_down").reverse().value()}),[n,a,_,j]);return!l.id||!u.id||s.length<=1?null:c.a.createElement(c.a.Fragment,null,c.a.createElement(Nt.a,{color:"light",light:!0},c.a.createElement(We.a,{inline:!0,className:"mr-auto",onSubmit:et},c.a.createElement(qe.a,null,c.a.createElement(Xe.a,{type:"number",step:"0.5",placeholder:"hours / day",className:"text-right",onChange:S}),c.a.createElement(Qe.a,{addonType:"append"},c.a.createElement(yt.a,null,c.a.createElement(ee.a,{className:"mx-2",icon:te.J}),O," [days]",c.a.createElement(ee.a,{className:"mx-2",icon:te.n})),b>0?c.a.createElement(c.a.Fragment,null,c.a.createElement(yt.a,{className:"bg-white"},c.a.createElement("strong",null,b)),c.a.createElement(yt.a,null,"hours / sprint")):null))),c.a.createElement(Lt,null),c.a.createElement(Pt,null)),c.a.createElement(ut.a,{bordered:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Name"),!h&&c.a.createElement("th",{className:"text-danger"},c.a.createElement(ee.a,{icon:te.x}),c.a.createElement(ee.a,{icon:te.c})),c.a.createElement("th",null,l.name),h?c.a.createElement(c.a.Fragment,null,c.a.createElement("th",null,"Total")," ",c.a.createElement("th",null,"Custom")):c.a.createElement(c.a.Fragment,null,c.a.createElement("th",null,u.name),c.a.createElement("th",null,"Progress")),g?c.a.createElement("th",null,"Grade"):null)),c.a.createElement("tbody",null,(C||[]).map((function(e){return c.a.createElement(Xt,{key:e.id,isPast:g,item:e,sums:v,total:b,hpd:p,tasks:j[e.id]||[]})})),c.a.createElement("tr",{key:"null"},c.a.createElement("td",{className:"text-danger"},c.a.createElement(ee.a,{icon:te.r,className:"ml-1 mr-2 fa-lg"}),"Not assigned"),!h&&c.a.createElement("td",null),c.a.createElement("td",{className:"text-right text-danger"},k),c.a.createElement("td",null),c.a.createElement("td",null),g?c.a.createElement("td",null):null))))},ta=a(522),aa=a(523),na=a(524),ra=a(525),ca=a(526),oa=a(527),sa=a(528),la=a(529),ia=a(530),ua=a(531),ma=a(239),_a=a(225),da=a.n(_a),Ea=function(e){var t=e.label,a=e.value,n=e.onSubmit,o=e.onEditable,s=e.onValueChange,l=e.valid,u=e.invalid,m=e.disabled,_=e.loading,d=e.id,E=e.submitting,p=e.disabledMessage,f=void 0===p?"":p,O=Object(r.useState)(!1),T=Object(i.a)(O,2),S=T[0],b=T[1],v=Object(r.useState)(""),y=Object(i.a)(v,2),k=y[0],h=y[1],g=Object(r.useState)(!1),j=Object(i.a)(g,2),C=j[0],A=j[1],D=Object(r.useCallback)((function(e){b(e.currentTarget.checked)}),[b]),R=Object(r.useCallback)((function(e){var t=e.target.value;h(t),s&&s(Number(t))}),[s]),M=Object(r.useCallback)((function(e){var t=Number(k);S&&""!==k&&t>=0&&n&&(n(t),b(!1),A(!0)),e.preventDefault()}),[S,k,n,b]);return Object(r.useEffect)((function(){m&&b(!1)}),[b,m]),Object(r.useEffect)((function(){A(!1)}),[a]),Object(r.useEffect)((function(){o&&o(S)}),[S,o]),Object(r.useEffect)((function(){E&&(b(!1),A(!0))}),[E]),Object(r.useEffect)((function(){_&&b(!1)}),[_]),c.a.createElement(We.a,{inline:!0,onSubmit:M},c.a.createElement(qe.a,{className:da.a.input_group},c.a.createElement(Qe.a,{addonType:"prepend"},t),_?c.a.createElement(kt,null):c.a.createElement(c.a.Fragment,null,S?c.a.createElement(c.a.Fragment,null,c.a.createElement(Qe.a,{addonType:"prepend"},c.a.createElement(yt.a,null,a)),c.a.createElement(Qe.a,{addonType:"prepend"},c.a.createElement(yt.a,null,c.a.createElement(ee.a,{className:"text-info",icon:te.u}))),c.a.createElement(Xe.a,{onInput:R,onChange:R,defaultValue:String(a),type:"number",step:"0.5",min:"0",id:d}),c.a.createElement(Qe.a,{addonType:"append"},c.a.createElement($e.a,{color:"info"},c.a.createElement(ee.a,{icon:te.g})))):c.a.createElement(c.a.Fragment,null,C?c.a.createElement(kt,null):c.a.createElement(Xe.a,{valid:l,invalid:u,readOnly:!0,value:a,className:"text-right"})),c.a.createElement(Qe.a,{addonType:"append",title:m?f:""},c.a.createElement(ma.a,{disabled:m,checked:S,onChange:D},c.a.createElement(ee.a,{className:"text-info",icon:te.k}))))))};function pa(){return(pa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function fa(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Oa,Ta=c.a.createElement("g",null,c.a.createElement("path",{fill:"currentColor",className:"leaf",d:"M115.343,123.839c0.814,1.256,3.343,2.605,7.23,4.014c7.586-1.069,14.943-1.586,21.885-1.586 c15.579,0,30.166,2.469,42.438,7.145c17.87-5.567,43.412-11.694,69.108-11.694c25.694,0,51.228,6.126,69.108,11.694 c12.262-4.676,26.848-7.145,42.42-7.145c7.001,0,14.418,0.518,22.063,1.604c3.471-1.341,6.296-2.699,8.325-4.031 c42.2-28.139,53.036-81.183,47.41-69.931c-4.218,8.418-60.309,35.581-100.004,52.222c14.68-17.769,31.677-44.134,43.438-80.309 c0,0-60.978,52.382-98.867,74.887c-11.974-20.816-33.892-86.589-33.892-86.589s-18.567,49.515-20.358,81.412 c-30.21-16.929-63.354-51.474-72.485-74.538c-10.752-27.189-13.78,53.545,15.436,89.396c-1.095,0.162-2.206,0.315-3.344,0.476 c-39.111-16.072-100.454-47.91-104.926-54.86C64.708,47.255,73.143,101.954,115.343,123.839z M290.531,107.181l0.747,0.857 l-3.098-0.746L290.531,107.181z"}),c.a.createElement("path",{fill:"currentColor",className:"tomato",d:"M485.83,198.564c-38.169-57.253-117.544-70.584-160.338-52.195c-18.27-5.906-43.872-12.27-69.49-12.27 c-25.619,0-51.228,6.364-69.499,12.27c-42.794-18.388-122.168-5.058-160.338,52.195c-64.136,96.203-18.711,299.318,229.836,299.318 C504.541,497.882,549.974,294.767,485.83,198.564z M101.172,262.929c-17.099,0-30.947-13.857-30.947-30.948 c0-17.09,13.848-30.947,30.947-30.947c17.082,0,30.947,13.857,30.947,30.947C132.119,249.071,118.253,262.929,101.172,262.929z"})),Sa=function(e){var t=e.svgRef,a=e.title,n=fa(e,["svgRef","title"]);return c.a.createElement("svg",pa({id:"_x32_",x:"0px",y:"0px",viewBox:"0 0 512 512",xmlSpace:"preserve",ref:t},n),a?c.a.createElement("title",null,a):null,Ta)},ba=c.a.forwardRef((function(e,t){return c.a.createElement(Sa,pa({svgRef:t},e))})),va=(a.p,a(83)),ya=a.n(va);!function(e){e.FRESH="fresh",e.STALE="stale"}(Oa||(Oa={}));var ka=function(e){var t,a=e.state,n=e.bl,r=e.br;return c.a.createElement(ba,{className:d()("fa-fw","svg-inline--fa",(t={},Object(y.a)(t,ya.a.fresh,a===Oa.FRESH),Object(y.a)(t,ya.a.stale,a===Oa.STALE),Object(y.a)(t,ya.a.bl,n),Object(y.a)(t,ya.a.br,r),t))})},ha=a(114),ga=a.n(ha),ja=function(e){var t=e.item,a=Object(r.useContext)(Ye),o=a.state,s=o.task_id,l=o.pomodoro_mode,i=o.pomodoro_state,u=a.dispatch,m=Object(r.useCallback)((function(){Number(s)!==t.id&&u({type:n.SET_TASK_ID,payload:{task_id:String(t.id)}}),i===b.STOPPED?P.changeMode(v.FOCUS,!0):l===v.FOCUS?P.resume():P.changeMode(v.FOCUS,!0)}),[u,t.id,l,i,s]),_=Object(r.useCallback)((function(){P.pause()}),[]);return Number(s)===t.id?l===v.FOCUS&&i===b.RUNNING?c.a.createElement($e.a,{className:d()("mr-2",ga.a.btn),color:"danger",onClick:_},c.a.createElement(ee.a,{icon:te.A}),c.a.createElement(ka,null)):c.a.createElement($e.a,{onClick:m,color:"primary",className:d()("mr-2",ga.a.btn)},c.a.createElement(ee.a,{icon:te.B}),c.a.createElement(ka,null)):""===s?l===v.FOCUS&&i!==b.STOPPED?null:c.a.createElement($e.a,{onClick:m,color:"primary",className:d()("mr-2",ga.a.btn)},c.a.createElement(ee.a,{icon:te.B}),c.a.createElement(ka,null)):null},Ca=function(e){var t=e.label,a=e.value,n=e.loading,r=e.size,o=e.invalid,s=e.valid;return c.a.createElement(qe.a,{size:r,className:"my-n1"},c.a.createElement(Qe.a,{addonType:"prepend"},t),n?c.a.createElement(kt,null):c.a.createElement(Xe.a,{invalid:o,valid:s,readOnly:!0,value:a,className:"text-right"}))},Aa=a(116),Da=a.n(Aa),Ra=a(115),Ma=a.n(Ra),Ia=a(84),Na=a.n(Ia),Pa=a(226),xa=a.n(Pa),Ua=function(e){return m.a.chain(e).groupBy("user_story").map((function(e,t){return{user_story:Number(t),user_story_extra_info:e[0].user_story_extra_info,project_extra_info:e[0].project_extra_info,tasks:e,is_closed:e.every((function(e){return e.is_closed}))}})).value()},wa=function(e){return e?"Need sign in!":""},La=function(e){var t=e.user_story_extra_info,a=e.project_extra_info,n=Object(r.useContext)(Ye).state.url,o=a.slug,s=t?"#".concat(t.ref," ").concat(t.subject):void 0,l=t?"".concat(n,"/project/").concat(o,"/us/").concat(t.ref):"#";return s?c.a.createElement("a",{href:l,onClick:tt,target:"_blank",rel:"noopener noreferrer",title:s},c.a.createElement(ee.a,{icon:te.q})," ",s):c.a.createElement(c.a.Fragment,null,"(Unassigned tasks)")},Ka=function(e){var t=e.item,a=Object(r.useContext)(Ye).state.url,n="#".concat(t.ref," ").concat(t.subject),o="".concat(a,"/project/").concat(t.project_extra_info.slug,"/task/").concat(t.ref);return c.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer",title:n},c.a.createElement(ee.a,{icon:te.q})," ",n)},Fa=function(e){var t=e.e,a=e.r;return c.a.createElement(qe.a,{className:Na.a.display_medal},c.a.createElement(Qe.a,{addonType:"prepend"},"Grade"),c.a.createElement(xa.a,{className:Na.a.medal},c.a.createElement(qt,{e:t,r:a})))},Ha=function(e){var t=e.item,a=e.task,o=e.onSelect,s=Object(r.useContext)(Ye).dispatch,l=Object(r.useCallback)((function(){s({type:n.PATCH_TASK,payload:{key:"status",value:t.id,id:a.id}}),o&&o(t.id)}),[s,t.id,a.id,o]);return c.a.createElement(ta.a,{onClick:l},t.name)},Ba=function(e){var t=e.task,a=e.disabled,n=Object(r.useState)(!1),o=Object(i.a)(n,2),s=o[0],l=o[1],u=Object(r.useContext)(Ye).state.active_task_statuses,m=Object(r.useCallback)((function(){l(!0)}),[l]);return Object(r.useEffect)((function(){l(!1)}),[t.version,l]),c.a.createElement(c.a.Fragment,null,s?c.a.createElement(wt.a,{type:"grow",color:"info"}):c.a.createElement(aa.a,null,c.a.createElement(na.a,{title:wa(a),disabled:a,caret:!a},t.status_extra_info.name),c.a.createElement(ra.a,null,u.map((function(e){return c.a.createElement(Ha,{item:e,key:e.id,task:t,onSelect:m})})))))},Ya=function(e){var t=e.item,a=e.onSelect,n=Object(r.useCallback)((function(){a&&a(t.id)}),[t.id,a]);return c.a.createElement(ta.a,{onClick:n},c.a.createElement(Bt,{src:t.photo}),t.username)},za=function(e){var t=e.task,a=e.disabled,o=Object(r.useState)(!1),s=Object(i.a)(o,2),l=s[0],u=s[1],m=Object(r.useContext)(Ye),_=m.state.project.members,d=m.dispatch,E=Object(r.useCallback)((function(e){u(!0),d({type:n.PATCH_TASK,payload:{key:"assigned_to",value:e,id:t.id}})}),[d,t.id]);return Object(r.useEffect)((function(){u(!1)}),[t.version,u]),c.a.createElement(c.a.Fragment,null,l?c.a.createElement(wt.a,{type:"grow",color:"info"}):c.a.createElement(aa.a,null,c.a.createElement(na.a,{title:wa(a),size:"sm",disabled:a,caret:!a},"Assign To"),c.a.createElement(ra.a,null,(_||[]).map((function(e){return c.a.createElement(Ya,{item:e,onSelect:E,key:e.id})})))))},Va=function(e){var t=e.task,a=Object(r.useState)(!1),o=Object(i.a)(a,2),s=o[0],l=o[1],u=Object(r.useContext)(Ye).dispatch,m=Object(r.useCallback)((function(){l(!0),u({type:n.PATCH_TASK,payload:{key:"assigned_to",value:null,id:t.id}})}),[u,t.id]);return Object(r.useEffect)((function(){l(!1)}),[t.version,l]),c.a.createElement(c.a.Fragment,null,s?c.a.createElement(wt.a,{type:"grow",color:"danger"}):c.a.createElement($e.a,{className:"mr-2",title:"Not assigned",color:"danger",onClick:m},c.a.createElement(ee.a,{icon:te.M})))},Ga=function(e){var t=e.item,a=Object(r.useContext)(Ye),o=a.state,s=o.custom_eid,l=o.custom_value_map,i=o.auth_token,u=o.custom_attr_e,m=a.dispatch,_=Gt(l,t),d=Object(r.useCallback)((function(e){_&&m({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:s,value:e,version:_}})}),[m,t.id,s,_]),E=Object(r.useMemo)((function(){return Yt(l,t,u.id)}),[u.id,l,t]);if(!u.id)return null;var p=!E,f=""===i,O=!_;return c.a.createElement(Ea,{onSubmit:d,label:u.name,value:E,invalid:p,disabled:f,loading:O,disabledMessage:"Need sign in!"})},Ja=function(e){var t=e.item,a=Object(r.useState)(!1),o=Object(i.a)(a,2),s=o[0],l=o[1],u=Object(r.useState)(0),_=Object(i.a)(u,2),E=_[0],p=_[1],f=Object(r.useState)(!1),O=Object(i.a)(f,2),T=O[0],S=O[1],b=Object(r.useState)(!1),v=Object(i.a)(b,2),y=v[0],k=v[1],h=Object(r.useContext)(Ye),g=h.state,j=g.custom_rid,C=g.custom_value_map,A=g.custom_attr_e,D=g.custom_attr_r,R=g.auth_token,M=g.pomodoro_number,I=g.pomodoro_used_number,N=h.dispatch,P=Gt(C,t),x=Object(r.useCallback)((function(){l(!s)}),[s]),U=Object(r.useCallback)((function(e,a){var r=e>0,c=a?{used_number:a}:void 0;P&&(N({type:n.PATCH_CUSTOM_VALUE,payload:{id:t.id,key:j,value:e,version:P},meta:{use_pomodoro:c,update_status:r}}),k(!0))}),[j,N,t.id,P]),w=Object(r.useCallback)((function(){p(E+1)}),[E]),L=Object(r.useCallback)((function(){p(E-1)}),[E]),K=Object(r.useCallback)((function(){p(0)}),[]),F=Object(r.useCallback)((function(e){S(e)}),[]),H=Object(r.useMemo)((function(){return Yt(C,t,A.id)}),[A.id,C,t]),B=Object(r.useMemo)((function(){return Yt(C,t,D.id)}),[D.id,C,t]),Y=Object(r.useCallback)((function(e){S(B===e)}),[B]),z=Object(r.useCallback)((function(){U(B+E/2,E),l(!1),p(0)}),[U,B,E]),V=Object(r.useMemo)((function(){return Jt(H,B,t.is_closed)}),[H,t.is_closed,B]),G=Object(r.useMemo)((function(){return Zt(H,B)}),[H,B]);if(Object(r.useEffect)((function(){P||k(!1)}),[P]),Object(r.useEffect)((function(){p(0)}),[I]),!D.id)return null;var J=""===R,Z=!P,W="rusult-input-".concat(t.id),q=M-I,Q=E>0,X=E===q;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ea,{onSubmit:U,onEditable:F,onValueChange:Y,label:D.name,value:B,valid:V,invalid:G,disabled:J,loading:Z,id:W,submitting:y}),T&&q>0&&c.a.createElement(ca.a,{className:d()("popover-wide"),target:W,placement:"top",isOpen:s,toggle:x,trigger:"click hover"},c.a.createElement(oa.a,null,"Pomodoro"),c.a.createElement(sa.a,null,c.a.createElement(la.a,null,c.a.createElement($e.a,{disabled:X,onClick:w},c.a.createElement(ee.a,{icon:te.C})),c.a.createElement($e.a,{disabled:!Q,onClick:L},c.a.createElement(ee.a,{icon:te.z})),c.a.createElement($e.a,{disabled:!0,className:"bg-light"},m.a.times(q).map((function(e){return c.a.createElement(ka,{key:e,state:e>=E?Oa.FRESH:Oa.STALE})}))),c.a.createElement($e.a,{disabled:!Q,onClick:z},c.a.createElement(ee.a,{icon:te.g})),c.a.createElement($e.a,{disabled:!Q,onClick:K},c.a.createElement(ee.a,{icon:te.o}))))))},Za=function(e){var t=e.item,a=Object(r.useContext)(Ye).state,n=a.custom_value_map,o=a.custom_attr_e,s=a.custom_attr_r,l=a.auth_token,i=Object(r.useMemo)((function(){return Gt(n,t)}),[n,t]),u=Object(r.useMemo)((function(){return Yt(n,t,o.id)}),[o.id,n,t]),m=Object(r.useMemo)((function(){return Yt(n,t,s.id)}),[s.id,n,t]);if(!o.id||!s.id)return null;var _=""===l,E=!i,p=0===m&&!t.is_closed&&!_&&!E;return c.a.createElement(Ma.a,{className:d()(Object(y.a)({},Na.a.is_closed,t.is_closed))},c.a.createElement("div",{className:"d-flex mb-1"},c.a.createElement("div",{className:"mr-auto text-truncate"},c.a.createElement(Ka,{item:t})),p&&c.a.createElement(Va,{task:t}),c.a.createElement(ja,{item:t}),c.a.createElement(Ba,{task:t,disabled:_})),c.a.createElement(ia.a,null,c.a.createElement(ua.a,null,c.a.createElement(Ga,{item:t})),c.a.createElement(ua.a,null,c.a.createElement(Ja,{item:t})),c.a.createElement(ua.a,null,c.a.createElement(Fa,{e:u,r:m}))))},Wa=function(e){var t=e.item;return c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,{className:"text-truncate"},c.a.createElement(La,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),c.a.createElement(Da.a,null,t.tasks.map((function(e){return c.a.createElement(Ma.a,{key:e.id,className:"text-truncate"},c.a.createElement("div",{className:"d-flex"},c.a.createElement("div",{className:"mr-auto text-truncate"},c.a.createElement(Ka,{item:e})),c.a.createElement(Ga,{item:e})))}))))},qa=function(e){var t=e.item,a=""===Object(r.useContext)(Ye).state.auth_token;return c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,{className:"text-truncate"},c.a.createElement(La,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),c.a.createElement(Ze.a,{isOpen:!0},c.a.createElement(Da.a,null,t.tasks.map((function(e){return c.a.createElement(Ma.a,{key:e.id},c.a.createElement("div",{className:"d-flex"},c.a.createElement("div",{className:"mr-auto text-truncate"},c.a.createElement(Ka,{item:e})),c.a.createElement(za,{task:e,disabled:a})))})))))},Qa=function(e){var t=e.item,a=Object(r.useState)(!1),n=Object(i.a)(a,2),o=n[0],s=n[1],l=Object(r.useContext)(Ye).state,u=l.custom_value_map,m=l.custom_attr_e,_=l.custom_attr_r,E=Object(r.useCallback)((function(){s(!o)}),[o,s]);Object(r.useEffect)((function(){s(!t.is_closed)}),[t.is_closed,s]);var p=Object(r.useMemo)((function(){return zt(u,t.tasks,m.id)}),[m.id,u,t.tasks]),f=Object(r.useMemo)((function(){return zt(u,t.tasks,_.id)}),[_.id,u,t.tasks]),O=!u.has(t.tasks[0]);return c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,{className:d()(Na.a.header,"text-truncate",{"alert-primary":t.is_closed}),onClick:E},c.a.createElement(ia.a,null,c.a.createElement(ua.a,{xs:12,md:8,className:"text-truncate"},c.a.createElement(Ct,{isOpen:o}),c.a.createElement(La,{user_story_extra_info:t.user_story_extra_info,project_extra_info:t.project_extra_info})),c.a.createElement(ua.a,{xs:6,md:2},c.a.createElement(Ca,{label:m.name,loading:O,value:p,size:"sm"})),c.a.createElement(ua.a,{xs:6,md:2},c.a.createElement(Ca,{label:_.name,loading:O,value:f,size:"sm"})))),c.a.createElement(Ze.a,{isOpen:o},c.a.createElement(Da.a,null,t.tasks.map((function(e){return c.a.createElement(Za,{item:e,key:e.id})})))))},Xa=function(){var e=Object(r.useContext)(Ye).state,t=e.tasks,a=e.custom_value_map,n=e.custom_eid,o=Object(r.useMemo)((function(){return Number(n)}),[n]),s=Object(r.useMemo)((function(){return o?t.filter((function(e){return Gt(a,e)&&0===Yt(a,e,o)})):[]}),[a,o,t]),l=Object(r.useMemo)((function(){return Ua(s)}),[s]);return 0===s.length?null:c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,{className:"alert-danger"},"Un estimated tasks"),c.a.createElement(St.a,null,l.map((function(e){return c.a.createElement(Wa,{item:e,key:e.user_story})}))))},$a=function(){var e=Object(r.useContext)(Ye).state.tasks,t=Object(r.useMemo)((function(){return m.a.filter(e,{assigned_to:null})}),[e]),a=Object(r.useMemo)((function(){return Ua(t)}),[t]);return 0===t.length?null:c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,{className:"alert-danger"},"Not assigned tasks"),c.a.createElement(St.a,null,a.map((function(e){return c.a.createElement(qa,{item:e,key:e.user_story})}))))},en=a(48),tn=function(e,t){return e.filter((function(e){return T()(t).local().endOf("days").diff(T()(e.created_date))>0}))},an=function(e){var t=e.tasks,a=Object(r.useState)([]),n=Object(i.a)(a,2),o=n[0],s=n[1],l=Object(r.useContext)(Ye).state,u=l.biz_days,m=l.custom_value_map,_=l.custom_eid,d=l.custom_attr_e,E=l.custom_attr_r;Object(r.useEffect)((function(){var e=u.length,a=Number(_);if(e>0&&t.length>0&&_){var n=zt(m,tn(t,u[0]),a),r=u.map((function(r,c){var o=dt(0,c),s=n-n*c/(e-1);if(T()().local().endOf("days").diff(T()(r))>0){var l=0===c?0:zt(m,function(e,t){return e.filter((function(e){return T()(t).local().format("YYYY-MM-DD")===T()(e.created_date).local().format("YYYY-MM-DD")}))}(t,r),a);return{label:o,estimate:s,result:zt(m,tn(t,r),a)-l-zt(m,function(e,t){return e.filter((function(e){return!!e.finished_date&&T()(t).local().endOf("days").diff(T()(e.finished_date))>0}))}(t,r),a),add:l}}return{label:o,estimate:s}}));s(r)}else s([])}),[t,u,_,m,s]);var p=Object(r.useCallback)((function(e){switch(e){case"estimate":return d.name||e;case"result":return E.name||e;default:return e}}),[d.name,E.name]),f=Object(r.useCallback)((function(e,t){return[Number(e).toFixed(1),p(t)]}),[p]);return 0===o.length?null:c.a.createElement(Ve.a,{className:"mb-2"},c.a.createElement(Ge.a,null,"Burn down chart"),c.a.createElement(en.b,{data:o,width:800,height:400},c.a.createElement(en.g,null),c.a.createElement(en.f,{dataKey:"label"}),c.a.createElement(en.e,{formatter:f}),c.a.createElement(en.c,{formatter:p}),c.a.createElement(en.a,{dataKey:"result",fill:"#8884d8",stackId:"a"}),c.a.createElement(en.a,{dataKey:"add",fill:"#82ca9d",stackId:"a"}),c.a.createElement(en.d,{dataKey:"estimate"})))},nn=a(532),rn=a(235),cn=a(234),on=a.n(cn),sn=a(118),ln=a.n(sn);function un(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function mn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?un(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):un(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _n=function(e,t){var a=m.a.last(e),n=mn({},t,{ranking:a&&a.ranking?a.e===t.e?a.ranking:a.ranking+1:1});return[].concat(Object(H.a)(e),[n])},dn=function(e){var t=e.name,a=e.src,n=e.value,r=e.ranking;return c.a.createElement(ua.a,{sm:4},c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,{className:d()(Object(y.a)({},ln.a.gold,1===r),Object(y.a)({},ln.a.silver,2===r),Object(y.a)({},ln.a.bronze,3===r))},c.a.createElement(ee.a,{icon:te.b})," Top ",r),c.a.createElement(St.a,null,c.a.createElement(nn.a,null,c.a.createElement("h2",{className:"text-truncate",title:t},c.a.createElement(Bt,{src:a,size:"xlarge"}),t)),c.a.createElement(ia.a,null,c.a.createElement(ua.a,{className:"my-auto text-danger text-right"},c.a.createElement("h4",null,c.a.createElement(ee.a,{icon:te.x}),c.a.createElement(ee.a,{icon:te.c}))),c.a.createElement(ua.a,null,c.a.createElement(rn.a,{z:6},c.a.createElement("h1",{className:"text-center"},c.a.createElement(on.a,{start:0,delay:3,duration:n,end:n}))))))))},En=function(){var e=Object(r.useContext)(Ye).state,t=e.project.members,a=e.tasks,n=e.custom_value_map,o=e.custom_eid,s=e.custom_rid,l=e.biz_days,u=T()().format("YYYY-MM-DD"),_=Object(r.useMemo)((function(){return function(e,t,a){var n=a.indexOf(t);if(n<1)return[];var r=T()(a[n-1]).local().startOf("day"),c=T()(t).local().startOf("day");return e.filter((function(e){var t=T()(e.finished_date);return t.diff(r)>=0&&t.diff(c)<0}))}(a,u,l)}),[l,a,u]),d=Object(r.useMemo)((function(){return $t(_,n,o,s)}),[o,s,n,_]),E=Object(r.useMemo)((function(){return m.a.chain(t).map((function(e){return[e,d[e.id]||{e:0,r:0}]})).map((function(e){var t=Object(i.a)(e,2),a=t[0],n=t[1];return mn({},a,{e:n.e,r:n.r})})).sortBy((function(e){return e.e+e.r/100})).reverse().filter((function(e){return e.e>0})).take(3).reduce(_n,[]).value()}),[t,d]),p=l.indexOf(u)-1;return p<1||0===E.length?null:c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,null,"Day ",p," Hero"),c.a.createElement(St.a,null,c.a.createElement(ia.a,null,E.map((function(e){return c.a.createElement(dn,{key:e.id,name:e.username,value:e.e,src:e.photo,ranking:e.ranking})})),m.a.times(3-E.length).map((function(e){return c.a.createElement(ua.a,{key:e},c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,null,c.a.createElement(ee.a,{icon:te.l})),c.a.createElement(St.a,{className:"text-center"},c.a.createElement(ee.a,{icon:te.m}))))})))))},pn=function(){var e=Object(r.useContext)(Ye).state.tasks;return c.a.createElement(c.a.Fragment,null,c.a.createElement(ea,null),c.a.createElement(an,{tasks:e}),c.a.createElement(En,null),c.a.createElement($a,null),c.a.createElement("br",null),c.a.createElement(Xa,null))},fn=a(534),On=a(533),Tn=function(){var e=Object(r.useContext)(Ye).state,t=e.custom_value_map,a=e.biz_days,n=e.user_tasks,o=e.custom_attr_e,s=e.custom_attr_r,l=Object(r.useMemo)((function(){return Ua(n)}),[n]),i=Object(r.useMemo)((function(){return zt(t,n,o.id)}),[o.id,t,n]),u=Object(r.useMemo)((function(){return zt(t,n,s.id)}),[s.id,t,n]),m=Object(r.useMemo)((function(){return Jt(i,u,l.every((function(e){return e.is_closed})))}),[i,u,l]),_=Object(r.useMemo)((function(){return Zt(i,u)}),[i,u]),E=Object(r.useMemo)((function(){return n.some((function(e){return!Gt(t,e)}))}),[t,n]);return!o.id||!s.id||a.length<=1?null:c.a.createElement(c.a.Fragment,null,l.map((function(e){return c.a.createElement(Qa,{item:e,key:e.user_story})})),c.a.createElement(Ve.a,null,c.a.createElement(Ge.a,{className:d()("alert-info")},"Total"),c.a.createElement(St.a,null,c.a.createElement(ia.a,null,c.a.createElement(ua.a,null,c.a.createElement(Ca,{label:o.name,value:i,loading:E})),c.a.createElement(ua.a,null,c.a.createElement(Ca,{label:s.name,value:u,invalid:_,valid:m,loading:E})),c.a.createElement(ua.a,null,c.a.createElement(Fa,{e:i,r:u})))),c.a.createElement(On.a,null,c.a.createElement(Qt,{tasks:n}))))},Sn=function(){var e=Object(r.useContext)(Ye).state.user;return c.a.createElement(Ve.a,null,e&&c.a.createElement(Ge.a,null,c.a.createElement(Bt,{src:e.photo,size:"xlarge"}),e.username," 's task"))},bn=function(){var e=Object(r.useContext)(Ye),t=e.state,a=t.user,o=t.user_tasks,s=t.url,l=e.dispatch,i=Object(Rt.e)().uid;return Object(r.useEffect)((function(){return i&&s&&l({type:n.FETCH_USER,payload:{uid:i}}),function(){l({type:n.RESET_USER})}}),[l,i,s]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Nt.a,{color:"light",light:!0},c.a.createElement($e.a,{tag:Dt.b,to:"/",className:"mr-auto"},c.a.createElement(ee.a,{icon:te.a})," Go back"),c.a.createElement(Lt,null),c.a.createElement(Pt,null)),a?c.a.createElement(c.a.Fragment,null,c.a.createElement(Sn,null),c.a.createElement("br",null),c.a.createElement(Tn,null),c.a.createElement("br",null),c.a.createElement(an,{tasks:o})):c.a.createElement(fn.a,{color:"danger"},"This user does not exist."))},vn=a(240),yn=a(153),kn=a(535),hn=a(57),gn=a.n(hn),jn=a(236),Cn=a.n(jn),An=a(237),Dn=a.n(An),Rn=a(238),Mn=a.n(Rn),In=function(){var e=Object(r.useContext)(Ye).state.pomodoro_daily_totals,t=Object(r.useMemo)((function(){return e.map((function(e){return{date:e.dateKey,value:e.value,pureValue:e.pureValue}}))}),[e]),a=(m.a.maxBy(t,"value")||{value:1}).value,n=Object(r.useCallback)((function(e){return e?"style-pomodoro color-pomodoro-".concat(Math.ceil(8*(e.value||0)/a)):"style-pomodoro empty-pomodoro"}),[a]),o=Object(r.useCallback)((function(e){return e&&e.date?{"data-tip":"".concat(e.value," Pomodoros on ").concat(e.date)}:null}),[]),s=Object(r.useMemo)((function(){return T()().subtract(12,"month").toDate()}),[]);return 0===e.length?c.a.createElement(fn.a,{color:"warning"},"No pomodoro history!"):c.a.createElement(c.a.Fragment,null,c.a.createElement(Mn.a,{startDate:s,showWeekdayLabels:!0,values:t,classForValue:n,tooltipDataAttrs:o}),c.a.createElement(Dn.a,null))},Nn=new(a(498))({type:"rectangle"}),Pn=function(e){return Math.ceil(e/60)},xn=function(e){switch(e.mode){case v.SHORT:return c.a.createElement(ee.a,{className:d()("fa-fw",gn.a.short_break_icon),icon:te.h});case v.LONG:return c.a.createElement(ee.a,{className:d()("fa-fw",gn.a.long_break_icon),icon:te.i});default:return c.a.createElement(ka,{state:Oa.FRESH})}},Un=function(e){var t=e.mode,a=e.onSelect,n=Object(r.useCallback)((function(){a(t)}),[t,a]);return c.a.createElement(ta.a,{onClick:n},c.a.createElement(xn,{mode:t}),t)},wn=function(e){P.start(),e()},Ln=function(e){P.start(),e(2)},Kn=function(e){P.changeMode(v.FOCUS),P.start(),e()},Fn=function(){var e=Object(r.useContext)(Ye),t=e.state,a=t.loaded,o=t.pomodoro_date,s=t.pomodoro_number,l=t.pomodoro_used_number,u=t.task_id,_=t.task,E=t.auth_token,p=t.pomodoro_live_counts,f=e.dispatch,O=Object(r.useState)(!1),S=Object(i.a)(O,2),y=S[0],k=S[1],h=Object(r.useState)(!1),g=Object(i.a)(h,2),j=g[0],C=g[1],A=Object(r.useState)(M[v.FOCUS]),D=Object(i.a)(A,2),R=D[0],I=D[1],N=Object(r.useState)(b.STOPPED),x=Object(i.a)(N,2),U=x[0],w=x[1],L=Object(r.useState)(v.FOCUS),K=Object(i.a)(L,2),F=K[0],H=K[1],B=Object(r.useState)(0),Y=Object(i.a)(B,2),z=Y[0],V=Y[1],G=Object(r.useState)("min"),J=Object(i.a)(G,2),Z=J[0],W=J[1],q=Object(r.useCallback)((function(){C((function(e){return!e}))}),[]),Q=Object(r.useCallback)((function(e){P.changeMode(e)}),[]),X=Object(r.useCallback)((function(){switch(U){case b.RUNNING:P.pause();break;case b.PAUSED:P.resume();break;case b.STOPPED:P.start()}}),[U]),$=Object(r.useCallback)((function(e){var t=function(e){return e>=60?[Pn(e),"min"]:[Math.ceil(e),"sec"]}(e),a=Object(i.a)(t,2),n=a[0],r=a[1];I(n),W(r)}),[]),ae=Object(r.useCallback)((function(e){w(e.state),$(e.remaining)}),[$]),ne=Object(r.useCallback)((function(e){H(e.mode),$(e.duration)}),[$]),re=Object(r.useCallback)((function(e){$(e.remaining)}),[$]),ce=Object(r.useCallback)((function(e,t){var a=s;ae(e),e.mode===v.FOCUS?(f({type:n.ADD_POMODORO,meta:{completedAt:t||new Date,duration:e.duration,pure:0===e.checkpointElapsed}}),++a%4===0?P.changeMode(v.LONG):P.changeMode(v.SHORT)):P.changeMode(v.FOCUS);var r,c="",o=void 0,l=wn,i=void 0;switch(r="".concat(a," Pomodoros today!"),P.mode){case v.FOCUS:c="Start Focusing.";break;case v.SHORT:c="Take a Short Break.",o="Retry focusing if double click.",l=Ln,i=Kn;break;case v.LONG:c="Take a Long Break.",o="Retry focusing if double click.",l=Ln,i=Kn}!function(e){var t=e.title,a=e.body,n=e.option,r=void 0===n?"":n,c=e.icon,o=e.onClick,s=e.onDblclick,l=0,i=null;if("granted"===Notification.permission){var u=new Notification(t,{body:"".concat(a," ").concat(r),icon:c}),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?i=setTimeout((function(){u.close(),i=null}),1e3*e):u.close()};u.onclick=function(){0===l?(l++,o(m)):(i&&clearTimeout(i),s&&s(m))}}else oe({title:t,body:a,icon:c})}({title:c,body:r,option:o,icon:Cn.a,onClick:l,onDblclick:i})}),[f,ae,s]),se=Object(r.useCallback)((function(){P.changeMode(v.FOCUS,!0)}),[]),le=Object(r.useCallback)((function(){f({type:n.RESET_TASK_ID})}),[f]),ie=Object(r.useCallback)((function(e){var t=" from firebase!",a=s,r=e.remaining;t=e.mode===v.FOCUS?++a%4===0?"Take a Long Break ".concat(t):"Take a Short Break ".concat(t):"Start Focusing ".concat(t);var c="".concat(a," Pomodoros today!");f({type:n.ADD_FB_TIMER,payload:{title:t,body:c,remaining:r}})}),[f,s]),ue=Object(r.useCallback)((function(e){f({type:n.DEL_FB_TIMER})}),[f]);Object(r.useEffect)((function(){return P.on("tick",re),P.on("start",ae),P.on("start",ie),P.on("stop",ae),P.on("stop",ue),P.on("pause",ae),P.on("pause",ue),P.on("resume",ae),P.on("resume",ie),P.on("expire",ce),P.on("change_mode",ne),function(){P.removeAllListeners()}}),[ce,ne,ae,re,ie,ue]),Object(r.useEffect)((function(){H(P.mode),w(P.state),$(P.remaining),P.restoreExpired&&E&&(m.a.defer((function(){ce(P.status)})),P.restoreExpired=!1)}),[E,ce,$]),Object(r.useEffect)((function(){var e=T()().format("YYYY-MM-DD");a&&o!==e&&(f({type:n.RESET_POMODORO,payload:{pomodoro_date:e}}),P.changeMode(v.FOCUS))}),[f,a,o]),Object(r.useEffect)((function(){"denied"!==Notification.permission&&Notification.requestPermission()}),[f]),Object(r.useEffect)((function(){var e=F===v.FOCUS?"#f00":"#0f0",t=F===v.FOCUS?"#fff":"#000",a="fade";if("sec"===Z){var n=[t,e];e=n[0],t=n[1],a="none"}switch(U){case b.RUNNING:Nn.badge(R,{bgColor:e,textColor:t,animation:a});break;case b.PAUSED:Nn.badge("-",{bgColor:e,textColor:t,animation:a});break;default:Nn.reset()}}),[F,R,U,Z]),Object(r.useEffect)((function(){var e=60*M[F];V(.01+99*(e-("min"===Z?60*R:R))/e/100)}),[F,R,Z]),Object(r.useEffect)((function(){f({type:n.SET_POMODORO_STATE,payload:{pomodoro_state:U}})}),[f,U]),Object(r.useEffect)((function(){f({type:n.SET_POMODORO_MODE,payload:{pomodoro_mode:F}})}),[f,F]);var me=Object(r.useCallback)((function(){k((function(e){return!e}))}),[]),_e=U===b.RUNNING?z:1;if(!E)return null;var de=_?"#".concat(_.ref," ").concat(m.a.get(_,"user_story_extra_info.subject","Unassigned tasks")," / ").concat(_.subject):"",Ee=_?m.a.truncate("#".concat(_.ref," ").concat(_.subject),{length:10}):"",pe=Object.values(p).some((function(e){return e>0}));return c.a.createElement(Ve.a,{className:d()(gn.a.top,"sticky-top")},c.a.createElement(vn.a,{options:{primary:F===v.FOCUS?"red":"green"}},c.a.createElement(at.a,{buffer:_e,progress:z,closed:U===b.STOPPED})),c.a.createElement(Ge.a,{onClick:me},c.a.createElement("div",{className:"d-flex"},c.a.createElement(Ct,{isOpen:y}),c.a.createElement(qe.a,{className:d()(gn.a.button_group,"ml-1")},c.a.createElement(kn.a,{onClick:tt,isOpen:j,toggle:q,addonType:"prepend"},c.a.createElement(na.a,{color:"light",size:"sm",caret:!0},c.a.createElement(xn,{mode:F})),c.a.createElement(ra.a,null,c.a.createElement(Un,{mode:v.FOCUS,onSelect:Q}),c.a.createElement(Un,{mode:v.SHORT,onSelect:Q}),c.a.createElement(Un,{mode:v.LONG,onSelect:Q}))),c.a.createElement(Qe.a,{addonType:"prepend",onClick:tt},c.a.createElement(yt.a,{className:d()(gn.a.fix_w,{"font-weight-bold":U===b.RUNNING})},R)),c.a.createElement(Qe.a,{onClick:tt,addonType:"prepend"},Z),c.a.createElement(Qe.a,{addonType:"append",onClick:tt},U===b.RUNNING?c.a.createElement($e.a,{color:"danger",onClick:X},c.a.createElement(ee.a,{icon:te.A})):c.a.createElement($e.a,{color:"primary",onClick:X},c.a.createElement(ee.a,{icon:te.B}))),F!==v.FOCUS&&c.a.createElement(Qe.a,{addonType:"append",onClick:tt},c.a.createElement($e.a,{color:"light",onClick:se,title:"Retry focusing"},c.a.createElement(ee.a,{icon:te.D,className:"text-muted"}),c.a.createElement(ka,{state:Oa.STALE}))),u&&c.a.createElement(yn.b,{onClick:tt,className:d()(gn.a.chip_set)},c.a.createElement(yn.a,{icon:c.a.createElement(ee.a,{icon:te.I}),onRemove:le,title:de,trailingIcon:c.a.createElement(ee.a,{icon:te.J})},Ee||c.a.createElement(wt.a,{type:"grow"}))),pe&&c.a.createElement("div",{className:"ml-1"},c.a.createElement("div",{className:d()("w-100","text-light","bg-danger","text-center","rounded","shadow","font-weight-bold",gn.a.live)},c.a.createElement(ee.a,{className:"ml-1",icon:te.L}),c.a.createElement("span",{className:"mx-1"},"LIVE")),c.a.createElement("div",null,Object.entries(p).filter((function(e){var t=Object(i.a)(e,2);t[0];return t[1]>0})).map((function(e){var t=Object(i.a)(e,2),a=t[0],n=t[1];return c.a.createElement(Je.a,{key:a,color:"light",className:"border"},c.a.createElement(xn,{mode:a}),":",n)}))))),s>0&&c.a.createElement(Je.a,{color:"danger",className:"mr-2"},c.a.createElement(ka,null)," ",c.a.createElement(ee.a,{icon:te.J})," ",s),m.a.times(s).map((function(e){return c.a.createElement(ka,{key:e,state:e<l?Oa.STALE:Oa.FRESH,br:e%2!==s%2&&e<s-1})})))),c.a.createElement(Ze.a,{isOpen:y},c.a.createElement(St.a,{className:"bg-grass"},c.a.createElement(In,null))))},Hn=function(){return c.a.createElement("div",{className:"container"},c.a.createElement(l.a,{className:"toast-top"}),c.a.createElement(Dt.a,null,c.a.createElement(ze,null,c.a.createElement(Fn,null),c.a.createElement(At,null),c.a.createElement(Rt.a,{exact:!0,path:"/",component:pn}),c.a.createElement(Rt.a,{exact:!0,path:"/:uid",component:bn}))))};s.a.render(c.a.createElement(Hn,null),document.getElementById("root"))},57:function(e,t,a){e.exports={top:"Pomodoro_top__2KPBC",button_group:"Pomodoro_button_group__25QhE",chip_set:"Pomodoro_chip_set__UcFix",fix_w:"Pomodoro_fix_w__26hsb",short_break_icon:"Pomodoro_short_break_icon__3e20m",long_break_icon:"Pomodoro_long_break_icon__1CgqS",live:"Pomodoro_live__293Tt"}},83:function(e,t,a){e.exports={fresh:"Tomato_fresh__2s5Ye",stale:"Tomato_stale__3bjHh",bl:"Tomato_bl__2-LRw",br:"Tomato_br__2_ZQQ"}},84:function(e,t,a){e.exports={header:"UserStory_header__3lGFX",display_medal:"UserStory_display_medal__3t53K",medal:"UserStory_medal__2Zi1f",is_closed:"UserStory_is_closed__2ABQp"}}},[[265,1,2]]]);
//# sourceMappingURL=main.6d0ff70b.chunk.js.map